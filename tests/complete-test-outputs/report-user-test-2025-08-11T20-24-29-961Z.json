{
  "testName": "User Test",
  "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
  "sessionId": "complete_e2e_user_test_1754943708795",
  "timestamp": "2025-08-11T20:21:48.795Z",
  "duration": 161166,
  "success": true,
  "phases": {
    "discovery": {
      "name": "Discovery",
      "success": true,
      "metrics": {
        "startTime": 1754943709182,
        "endTime": 1754943734805,
        "duration": 25623,
        "memoryUsage": {
          "heapUsed": -5994216,
          "heapTotal": 31129600,
          "external": 6444899
        }
      },
      "logs": [
        {
          "timestamp": "2025-08-11T20:21:49.182Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Starting discovery phase"
        },
        {
          "timestamp": "2025-08-11T20:21:49.182Z",
          "level": "DEBUG",
          "source": "Claude",
          "message": "Sending request for discovery phase"
        },
        {
          "timestamp": "2025-08-11T20:22:06.985Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_for_task"
        },
        {
          "timestamp": "2025-08-11T20:22:06.985Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"task\":\"receive_webhook\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:06.985Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_for_task"
        },
        {
          "timestamp": "2025-08-11T20:22:06.985Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"task\":\"process_webhook_data\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:06.985Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_for_task"
        },
        {
          "timestamp": "2025-08-11T20:22:06.985Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"task\":\"call_api_with_auth\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:06.985Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_for_task"
        },
        {
          "timestamp": "2025-08-11T20:22:06.985Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"task\":\"send_email\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:06.986Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_for_task"
        },
        {
          "timestamp": "2025-08-11T20:22:06.986Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"task\":\"transform_data\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:06.986Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_for_task"
        },
        {
          "timestamp": "2025-08-11T20:22:06.986Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"task\":\"send_slack_message\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:07.153Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_for_task completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:07.156Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_for_task completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:07.182Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_for_task completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:07.183Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_for_task completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:07.187Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_for_task completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:07.198Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_for_task completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:07.199Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: search_nodes"
        },
        {
          "timestamp": "2025-08-11T20:22:07.199Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"query\":\"calendar\",\"limit\":20}"
        },
        {
          "timestamp": "2025-08-11T20:22:07.199Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: search_nodes"
        },
        {
          "timestamp": "2025-08-11T20:22:07.199Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"query\":\"tracking\",\"limit\":20}"
        },
        {
          "timestamp": "2025-08-11T20:22:07.199Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: search_nodes"
        },
        {
          "timestamp": "2025-08-11T20:22:07.199Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"query\":\"crm\",\"limit\":20}"
        },
        {
          "timestamp": "2025-08-11T20:22:07.320Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool search_nodes completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:07.341Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool search_nodes completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:07.404Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool search_nodes completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:14.709Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.webhook (Set up a webhook to receive data from external services)"
        },
        {
          "timestamp": "2025-08-11T20:22:14.709Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.code (Transform data structure using JavaScript)"
        },
        {
          "timestamp": "2025-08-11T20:22:14.709Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.emailSend (Send an email notification)"
        },
        {
          "timestamp": "2025-08-11T20:22:14.709Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.code (Process incoming webhook data with Code node (shows correct data access))"
        },
        {
          "timestamp": "2025-08-11T20:22:14.709Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.slack (Send a message to Slack channel)"
        },
        {
          "timestamp": "2025-08-11T20:22:14.709Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.httpRequest (Make an authenticated API request)"
        },
        {
          "timestamp": "2025-08-11T20:22:14.709Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.zohoCrm (Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects)"
        },
        {
          "timestamp": "2025-08-11T20:22:14.709Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.googleCalendar (Schedule demo calls and meetings with prospects based on their profile and engagement level)"
        },
        {
          "timestamp": "2025-08-11T20:22:14.709Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.segment (Track customer engagement across multiple channels and collect behavioral data for lead scoring)"
        },
        {
          "timestamp": "2025-08-11T20:22:14.804Z",
          "level": "DEBUG",
          "source": "Orchestrator",
          "message": "Session state updated"
        },
        {
          "timestamp": "2025-08-11T20:22:14.805Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Data flow captured: 3 transformations"
        }
      ],
      "nodes": [
        {
          "id": "task_node_1",
          "type": "nodes-base.webhook",
          "purpose": "Set up a webhook to receive data from external services"
        },
        {
          "id": "task_node_5",
          "type": "nodes-base.code",
          "purpose": "Transform data structure using JavaScript"
        },
        {
          "id": "task_node_4",
          "type": "nodes-base.emailSend",
          "purpose": "Send an email notification"
        },
        {
          "id": "task_node_2",
          "type": "nodes-base.code",
          "purpose": "Process incoming webhook data with Code node (shows correct data access)"
        },
        {
          "id": "task_node_6",
          "type": "nodes-base.slack",
          "purpose": "Send a message to Slack channel"
        },
        {
          "id": "task_node_3",
          "type": "nodes-base.httpRequest",
          "purpose": "Make an authenticated API request"
        },
        {
          "id": "search_node_1",
          "type": "nodes-base.zohoCrm",
          "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
        },
        {
          "id": "search_node_2",
          "type": "nodes-base.googleCalendar",
          "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
        },
        {
          "id": "search_node_3",
          "type": "nodes-base.segment",
          "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
        }
      ],
      "sessionState": {
        "sessionId": "complete_e2e_user_test_1754943708795",
        "createdAt": "2025-08-11T20:21:49.129Z",
        "state": {
          "phase": "configuration",
          "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
          "discovered": [
            {
              "id": "task_node_1",
              "type": "nodes-base.webhook",
              "config": {
                "path": "webhook",
                "onError": "continueRegularOutput",
                "httpMethod": "POST",
                "responseData": "allEntries",
                "responseMode": "lastNode",
                "alwaysOutputData": true
              },
              "purpose": "Set up a webhook to receive data from external services",
              "displayName": "receive webhook",
              "isPreConfigured": true
            },
            {
              "id": "task_node_5",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                "language": "javaScript"
              },
              "purpose": "Transform data structure using JavaScript",
              "displayName": "transform data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_4",
              "type": "nodes-base.emailSend",
              "config": {
                "text": "",
                "onError": "continueRegularOutput",
                "subject": "",
                "toEmail": "",
                "maxTries": 3,
                "fromEmail": "",
                "retryOnFail": true,
                "alwaysOutputData": true,
                "waitBetweenTries": 3000
              },
              "purpose": "Send an email notification",
              "displayName": "send email",
              "isPreConfigured": true
            },
            {
              "id": "task_node_2",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                "onError": "continueRegularOutput",
                "language": "javaScript"
              },
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "displayName": "process webhook data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_6",
              "type": "nodes-base.slack",
              "config": {
                "text": "",
                "channel": "",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "resource": "message",
                "operation": "post",
                "parameters": {},
                "retryOnFail": true,
                "waitBetweenTries": 2000
              },
              "purpose": "Send a message to Slack channel",
              "displayName": "send slack message",
              "isPreConfigured": true
            },
            {
              "id": "task_node_3",
              "type": "nodes-base.httpRequest",
              "config": {
                "url": "",
                "method": "GET",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "retryOnFail": true,
                "sendHeaders": true,
                "authentication": "genericCredentialType",
                "genericAuthType": "headerAuth",
                "alwaysOutputData": true,
                "headerParameters": {
                  "parameters": [
                    {
                      "name": "",
                      "value": ""
                    }
                  ]
                },
                "waitBetweenTries": 2000
              },
              "purpose": "Make an authenticated API request",
              "displayName": "call api with auth",
              "isPreConfigured": true
            },
            {
              "id": "search_node_1",
              "type": "nodes-base.zohoCrm",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
            },
            {
              "id": "search_node_2",
              "type": "nodes-base.googleCalendar",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
            },
            {
              "id": "search_node_3",
              "type": "nodes-base.segment",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
            }
          ],
          "selected": [
            "task_node_1",
            "task_node_5",
            "task_node_4",
            "task_node_2",
            "task_node_6",
            "task_node_3",
            "search_node_1",
            "search_node_2",
            "search_node_3"
          ],
          "configured": {},
          "validated": {},
          "workflow": {
            "nodes": [],
            "settings": {},
            "connections": {}
          },
          "buildPhases": [],
          "operationHistory": [
            {
              "node": {
                "id": "task_node_1",
                "type": "nodes-base.webhook",
                "config": {
                  "path": "webhook",
                  "onError": "continueRegularOutput",
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode",
                  "alwaysOutputData": true
                },
                "purpose": "Set up a webhook to receive data from external services",
                "displayName": "receive webhook",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_1",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_5",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                },
                "purpose": "Transform data structure using JavaScript",
                "displayName": "transform data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_5",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_4",
                "type": "nodes-base.emailSend",
                "config": {
                  "text": "",
                  "onError": "continueRegularOutput",
                  "subject": "",
                  "toEmail": "",
                  "maxTries": 3,
                  "fromEmail": "",
                  "retryOnFail": true,
                  "alwaysOutputData": true,
                  "waitBetweenTries": 3000
                },
                "purpose": "Send an email notification",
                "displayName": "send email",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_4",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_2",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                  "onError": "continueRegularOutput",
                  "language": "javaScript"
                },
                "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                "displayName": "process webhook data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_2",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_6",
                "type": "nodes-base.slack",
                "config": {
                  "text": "",
                  "channel": "",
                  "onError": "continueRegularOutput",
                  "maxTries": 2,
                  "resource": "message",
                  "operation": "post",
                  "parameters": {},
                  "retryOnFail": true,
                  "waitBetweenTries": 2000
                },
                "purpose": "Send a message to Slack channel",
                "displayName": "send slack message",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_6",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_3",
                "type": "nodes-base.httpRequest",
                "config": {
                  "url": "",
                  "method": "GET",
                  "onError": "continueErrorOutput",
                  "maxTries": 3,
                  "retryOnFail": true,
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "alwaysOutputData": true,
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "",
                        "value": ""
                      }
                    ]
                  },
                  "waitBetweenTries": 2000
                },
                "purpose": "Make an authenticated API request",
                "displayName": "call api with auth",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_1",
                "type": "nodes-base.zohoCrm",
                "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_1",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_2",
                "type": "nodes-base.googleCalendar",
                "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_2",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_3",
                "type": "nodes-base.segment",
                "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "completePhase",
              "phase": "discovery",
              "timestamp": "2025-08-11T20:22:14.164Z"
            }
          ],
          "pendingClarifications": [],
          "clarificationHistory": []
        }
      },
      "stateChanges": {},
      "dataFlow": {
        "input": {
          "prompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context."
        },
        "output": {
          "nodes": [
            {
              "id": "task_node_1",
              "type": "nodes-base.webhook",
              "displayName": "receive webhook",
              "purpose": "Set up a webhook to receive data from external services",
              "isPreConfigured": true,
              "config": {
                "httpMethod": "POST",
                "path": "webhook",
                "responseMode": "lastNode",
                "responseData": "allEntries",
                "onError": "continueRegularOutput",
                "alwaysOutputData": true
              }
            },
            {
              "id": "task_node_5",
              "type": "nodes-base.code",
              "displayName": "transform data",
              "purpose": "Transform data structure using JavaScript",
              "isPreConfigured": true,
              "config": {
                "language": "javaScript",
                "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;"
              }
            },
            {
              "id": "task_node_4",
              "type": "nodes-base.emailSend",
              "displayName": "send email",
              "purpose": "Send an email notification",
              "isPreConfigured": true,
              "config": {
                "fromEmail": "",
                "toEmail": "",
                "subject": "",
                "text": "",
                "onError": "continueRegularOutput",
                "retryOnFail": true,
                "maxTries": 3,
                "waitBetweenTries": 3000,
                "alwaysOutputData": true
              }
            },
            {
              "id": "task_node_2",
              "type": "nodes-base.code",
              "displayName": "process webhook data",
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "isPreConfigured": true,
              "config": {
                "language": "javaScript",
                "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                "onError": "continueRegularOutput"
              }
            },
            {
              "id": "task_node_6",
              "type": "nodes-base.slack",
              "displayName": "send slack message",
              "purpose": "Send a message to Slack channel",
              "isPreConfigured": true,
              "config": {
                "resource": "message",
                "operation": "post",
                "channel": "",
                "text": "",
                "onError": "continueRegularOutput",
                "retryOnFail": true,
                "maxTries": 2,
                "waitBetweenTries": 2000,
                "parameters": {}
              }
            },
            {
              "id": "task_node_3",
              "type": "nodes-base.httpRequest",
              "displayName": "call api with auth",
              "purpose": "Make an authenticated API request",
              "isPreConfigured": true,
              "config": {
                "method": "GET",
                "url": "",
                "authentication": "genericCredentialType",
                "genericAuthType": "headerAuth",
                "sendHeaders": true,
                "onError": "continueErrorOutput",
                "retryOnFail": true,
                "maxTries": 3,
                "waitBetweenTries": 2000,
                "alwaysOutputData": true,
                "headerParameters": {
                  "parameters": [
                    {
                      "name": "",
                      "value": ""
                    }
                  ]
                }
              }
            },
            {
              "id": "search_node_1",
              "type": "nodes-base.zohoCrm",
              "displayName": "nodes-base.zohoCrm",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
              "needsConfiguration": true
            },
            {
              "id": "search_node_2",
              "type": "nodes-base.googleCalendar",
              "displayName": "nodes-base.googleCalendar",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
              "needsConfiguration": true
            },
            {
              "id": "search_node_3",
              "type": "nodes-base.segment",
              "displayName": "nodes-base.segment",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
              "needsConfiguration": true
            }
          ]
        },
        "transformations": [
          "Intent Analysis",
          "Node Discovery",
          "Selection"
        ]
      }
    },
    "configuration": {
      "name": "Configuration",
      "success": true,
      "metrics": {
        "startTime": 1754943734805,
        "endTime": 1754943777794,
        "duration": 42989,
        "memoryUsage": {
          "heapUsed": 5651832,
          "heapTotal": 39075840,
          "external": 8061608
        }
      },
      "logs": [
        {
          "timestamp": "2025-08-11T20:22:14.805Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Starting configuration phase"
        },
        {
          "timestamp": "2025-08-11T20:22:14.805Z",
          "level": "DEBUG",
          "source": "Claude",
          "message": "Sending request for configuration phase"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_essentials"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.webhook\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_essentials"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.code\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_essentials"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.emailSend\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_essentials"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.code\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_essentials"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.slack\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_essentials"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.httpRequest\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_essentials"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.zohoCrm\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_essentials"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.googleCalendar\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: get_node_essentials"
        },
        {
          "timestamp": "2025-08-11T20:22:14.865Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.segment\"}"
        },
        {
          "timestamp": "2025-08-11T20:22:15.048Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_essentials completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:15.049Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_essentials completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:15.051Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_essentials completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:15.069Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_essentials completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:15.071Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_essentials completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:15.159Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_essentials completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:15.226Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_essentials completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:15.233Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_essentials completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:15.311Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool get_node_essentials completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:22.443Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_node_minimal"
        },
        {
          "timestamp": "2025-08-11T20:22:22.443Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.webhook\",\"config\":{\"path\":\"customer-signup\",\"httpMethod\":\"POST\",\"responseData\":\"allEntries\",\"responseMode\":\"lastNode\",\"options\":{\"noResponseBody\":false,\"rawBody\":false}}}"
        },
        {
          "timestamp": "2025-08-11T20:22:22.603Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_node_minimal completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:26.874Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_node_minimal"
        },
        {
          "timestamp": "2025-08-11T20:22:26.874Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.emailSend\",\"config\":{\"text\":\"Hi {{ $json.firstName || $json.name }},\\n\\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\\n\\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\\n\\nNext steps:\\n- Complete your profile setup\\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\\n- Schedule a personalized demo\\n\\nBest regards,\\nThe Onboarding Team\",\"subject\":\"Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready\",\"toEmail\":\"{{ $json.email }}\",\"fromEmail\":\"onboarding@company.com\"}}"
        },
        {
          "timestamp": "2025-08-11T20:22:27.028Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_node_minimal completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:36.973Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_node_minimal"
        },
        {
          "timestamp": "2025-08-11T20:22:36.973Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.code\",\"config\":{\"jsCode\":\"// Analyze customer signup data and enrich with company profile\\nconst results = [];\\n\\nfor (const item of items) {\\n  const customerData = item.json;\\n  \\n  // Extract company information\\n  const companyName = customerData.company || customerData.companyName || '';\\n  const email = customerData.email || '';\\n  const domain = email.split('@')[1] || '';\\n  \\n  // Determine company size based on available data\\n  let companySize = 'unknown';\\n  if (customerData.employees) {\\n    const empCount = parseInt(customerData.employees);\\n    if (empCount < 10) companySize = 'startup';\\n    else if (empCount < 50) companySize = 'small';\\n    else if (empCount < 500) companySize = 'medium';\\n    else companySize = 'enterprise';\\n  }\\n  \\n  // Industry classification based on domain or provided data\\n  let industry = customerData.industry || 'general';\\n  if (!customerData.industry && domain) {\\n    // Basic industry detection from common domain patterns\\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\\n    else if (domain.includes('edu')) industry = 'education';\\n  }\\n  \\n  // Determine lead score and priority\\n  let leadScore = 50; // Base score\\n  let priority = 'medium';\\n  \\n  // Scoring logic\\n  if (companySize === 'enterprise') leadScore += 30;\\n  else if (companySize === 'medium') leadScore += 20;\\n  else if (companySize === 'small') leadScore += 10;\\n  \\n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\\n  \\n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\\n    leadScore += 25;\\n  }\\n  \\n  // Set priority based on score\\n  if (leadScore >= 80) priority = 'high';\\n  else if (leadScore >= 60) priority = 'medium';\\n  else priority = 'low';\\n  \\n  // Determine appropriate demo type and timeline\\n  let demoType = 'standard';\\n  let demoTimeline = '7-days';\\n  \\n  if (companySize === 'enterprise' || priority === 'high') {\\n    demoType = 'executive';\\n    demoTimeline = '2-days';\\n  } else if (companySize === 'medium') {\\n    demoType = 'business';\\n    demoTimeline = '3-days';\\n  }\\n  \\n  // Email sequence selection\\n  const emailSequence = `${industry}_${companySize}`;\\n  \\n  results.push({\\n    json: {\\n      // Original customer data\\n      ...customerData,\\n      \\n      // Enriched profile data\\n      companyProfile: {\\n        name: companyName,\\n        domain: domain,\\n        size: companySize,\\n        industry: industry,\\n        estimatedEmployees: customerData.employees || 'unknown'\\n      },\\n      \\n      // Lead qualification\\n      leadScore: leadScore,\\n      priority: priority,\\n      \\n      // Personalization parameters\\n      personalization: {\\n        emailSequence: emailSequence,\\n        demoType: demoType,\\n        demoTimeline: demoTimeline,\\n        industryFocus: industry,\\n        sizeSegment: companySize\\n      },\\n      \\n      // Workflow routing flags\\n      routing: {\\n        requiresHighTouchSales: priority === 'high',\\n        autoScheduleDemo: companySize !== 'startup',\\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\\n        escalateToSales: leadScore >= 75\\n      },\\n      \\n      // Processing metadata\\n      processedAt: new Date().toISOString(),\\n      workflowStage: 'profile_analysis_complete'\\n    }\\n  });\\n}\\n\\nreturn results;\",\"language\":\"javaScript\"}}"
        },
        {
          "timestamp": "2025-08-11T20:22:37.144Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_node_minimal completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:39.034Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_node_minimal"
        },
        {
          "timestamp": "2025-08-11T20:22:39.034Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.slack\",\"config\":{\"text\":\"🚨 *High-Value Prospect Escalation* 🚨\\n\\n*Company:* {{ $json.company_name || 'Unknown' }}\\n*Industry:* {{ $json.industry || 'Not specified' }}\\n*Company Size:* {{ $json.company_size || 'Unknown' }}\\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\\n\\n*Contact Details:*\\n• Name: {{ $json.contact_name || 'Unknown' }}\\n• Email: {{ $json.email || 'Not provided' }}\\n• Phone: {{ $json.phone || 'Not provided' }}\\n• Title: {{ $json.job_title || 'Unknown' }}\\n\\n*Engagement Summary:*\\n• Email Opens: {{ $json.email_opens || 0 }}\\n• Link Clicks: {{ $json.link_clicks || 0 }}\\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\\n\\n*Next Steps:* Immediate sales follow-up recommended\\n*CRM Link:* {{ $json.crm_link || 'To be created' }}\",\"resource\":\"message\",\"operation\":\"post\",\"parameters\":{},\"channelId\":\"#sales-escalations\",\"select\":\"channel\"}}"
        },
        {
          "timestamp": "2025-08-11T20:22:39.165Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_node_minimal completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:44.053Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_node_minimal"
        },
        {
          "timestamp": "2025-08-11T20:22:44.054Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.code\",\"config\":{\"jsCode\":\"// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\\n// Connect this Code node after a Webhook node for customer signup processing\\n\\n// Access webhook payload data - it's under .body, not directly under .json\\nconst webhookData = items[0].json.body;  // ✅ CORRECT\\nconst headers = items[0].json.headers;   // HTTP headers\\nconst query = items[0].json.query;       // Query parameters\\n\\n// Process customer signup data for intelligent onboarding\\ntry {\\n  // Validate required signup fields\\n  if (!webhookData.email) {\\n    throw new Error('Missing required field: email');\\n  }\\n  if (!webhookData.company) {\\n    throw new Error('Missing required field: company');\\n  }\\n  \\n  // Extract and normalize customer data\\n  const customerData = {\\n    email: webhookData.email.toLowerCase().trim(),\\n    firstName: webhookData.firstName || webhookData.first_name || '',\\n    lastName: webhookData.lastName || webhookData.last_name || '',\\n    company: webhookData.company.trim(),\\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\\n    phone: webhookData.phone || '',\\n    website: webhookData.website || webhookData.company_website || '',\\n    employees: webhookData.employees || webhookData.company_size || null,\\n    industry: webhookData.industry || '',\\n    source: webhookData.source || query.source || 'direct_signup'\\n  };\\n  \\n  // Determine company size category for personalization\\n  let companySizeCategory = 'unknown';\\n  if (customerData.employees) {\\n    const empCount = parseInt(customerData.employees);\\n    if (empCount <= 10) companySizeCategory = 'startup';\\n    else if (empCount <= 50) companySizeCategory = 'small';\\n    else if (empCount <= 500) companySizeCategory = 'medium';\\n    else companySizeCategory = 'enterprise';\\n  }\\n  \\n  // Extract domain for company analysis\\n  const emailDomain = customerData.email.split('@')[1];\\n  const websiteDomain = customerData.website ? \\n    customerData.website.replace(/^https?:\\\\/\\\\/(www\\\\.)?/, '').split('/')[0] : \\n    emailDomain;\\n  \\n  // Determine lead priority based on company size and industry\\n  let leadPriority = 'medium';\\n  if (companySizeCategory === 'enterprise' || \\n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\\n    leadPriority = 'high';\\n  } else if (companySizeCategory === 'startup') {\\n    leadPriority = 'low';\\n  }\\n  \\n  // Prepare data for next workflow steps\\n  const processedData = {\\n    customer: customerData,\\n    analysis: {\\n      companySizeCategory,\\n      emailDomain,\\n      websiteDomain,\\n      leadPriority,\\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\\n    },\\n    workflow: {\\n      signupId: crypto.randomUUID(),\\n      processedAt: DateTime.now().toISO(),\\n      nextSteps: [\\n        'enrich_company_data',\\n        'send_welcome_email',\\n        'schedule_demo_followup'\\n      ],\\n      escalateToSales: leadPriority === 'high'\\n    },\\n    metadata: {\\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\\n      httpMethod: items[0].json.httpMethod,\\n      webhookPath: items[0].json.webhookPath,\\n      userAgent: headers['user-agent'] || '',\\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\\n      timestamp: DateTime.now().toISO()\\n    }\\n  };\\n  \\n  // Return processed signup data for onboarding workflow\\n  return [{\\n    json: processedData\\n  }];\\n  \\n} catch (error) {\\n  // Return error response for failed signup processing\\n  return [{\\n    json: {\\n      status: 'error',\\n      error: error.message,\\n      originalData: webhookData,\\n      timestamp: DateTime.now().toISO(),\\n      requiresManualReview: true\\n    }\\n  }];\\n}\",\"language\":\"javaScript\"}}"
        },
        {
          "timestamp": "2025-08-11T20:22:44.237Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_node_minimal completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:45.435Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_node_minimal"
        },
        {
          "timestamp": "2025-08-11T20:22:45.435Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.httpRequest\",\"config\":{\"url\":\"https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}\",\"method\":\"GET\",\"sendHeaders\":true,\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"headerAuth\",\"headerParameters\":{\"parameters\":[{\"name\":\"Authorization\",\"value\":\"Bearer {{ $credentials.clearbit.apiKey }}\"}]}}}"
        },
        {
          "timestamp": "2025-08-11T20:22:45.562Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_node_minimal completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:48.298Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_node_minimal"
        },
        {
          "timestamp": "2025-08-11T20:22:48.298Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.zohoCrm\",\"config\":{\"resource\":\"lead\",\"operation\":\"create\",\"lastName\":\"={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}\",\"Company\":\"={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}\",\"firstName\":\"={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}\",\"email\":\"={{ $json.email }}\",\"phone\":\"={{ $json.phone || $json.phoneNumber || '' }}\",\"leadSource\":\"Website Signup\",\"leadStatus\":\"New Lead\",\"industry\":\"={{ $json.industry || $json.companyIndustry || '' }}\",\"annualRevenue\":\"={{ $json.companySize || $json.revenue || '' }}\",\"description\":\"Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}\"}}"
        },
        {
          "timestamp": "2025-08-11T20:22:48.454Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_node_minimal completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:54.623Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_node_minimal"
        },
        {
          "timestamp": "2025-08-11T20:22:54.623Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.googleCalendar\",\"config\":{\"resource\":\"event\",\"operation\":\"create\",\"calendar\":\"={{ $('previous_node').item.json.salesCalendarId || 'primary' }}\",\"start\":\"={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}\",\"end\":\"={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}\",\"summary\":\"Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}\",\"description\":\"Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\\n\\nCompany Size: {{ $('previous_node').item.json.companySize }}\\nIndustry: {{ $('previous_node').item.json.industry }}\\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\\nLead Source: {{ $('previous_node').item.json.leadSource }}\\n\\nContact: {{ $('previous_node').item.json.email }}\\nPhone: {{ $('previous_node').item.json.phone }}\"}}"
        },
        {
          "timestamp": "2025-08-11T20:22:54.723Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_node_minimal"
        },
        {
          "timestamp": "2025-08-11T20:22:54.723Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"nodeType\":\"nodes-base.segment\",\"config\":{\"resource\":\"track\",\"operation\":\"event\",\"event\":\"{{ $json.eventName || 'engagement_event' }}\",\"userId\":\"{{ $json.userId || $json.email }}\",\"properties\":{\"channel\":\"{{ $json.channel }}\",\"action\":\"{{ $json.action }}\",\"value\":\"{{ $json.value }}\",\"timestamp\":\"{{ $now }}\",\"source\":\"onboarding_workflow\",\"lead_score_impact\":\"{{ $json.scoreImpact || 1 }}\",\"company_size\":\"{{ $json.companySize }}\",\"industry\":\"{{ $json.industry }}\",\"engagement_level\":\"{{ $json.engagementLevel }}\"},\"traits\":{\"company\":\"{{ $json.company }}\",\"title\":\"{{ $json.title }}\",\"phone\":\"{{ $json.phone }}\",\"industry\":\"{{ $json.industry }}\",\"company_size\":\"{{ $json.companySize }}\",\"lead_status\":\"{{ $json.leadStatus }}\",\"last_engagement\":\"{{ $now }}\"}}}"
        },
        {
          "timestamp": "2025-08-11T20:22:54.966Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_node_minimal completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:55.177Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_node_minimal completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:22:57.694Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.webhook (Set up a webhook to receive data from external services)"
        },
        {
          "timestamp": "2025-08-11T20:22:57.694Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.code (Transform data structure using JavaScript)"
        },
        {
          "timestamp": "2025-08-11T20:22:57.694Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.emailSend (Send an email notification)"
        },
        {
          "timestamp": "2025-08-11T20:22:57.694Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.code (Process incoming webhook data with Code node (shows correct data access))"
        },
        {
          "timestamp": "2025-08-11T20:22:57.694Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.slack (Send a message to Slack channel)"
        },
        {
          "timestamp": "2025-08-11T20:22:57.694Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.httpRequest (Make an authenticated API request)"
        },
        {
          "timestamp": "2025-08-11T20:22:57.694Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.zohoCrm (Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects)"
        },
        {
          "timestamp": "2025-08-11T20:22:57.694Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.googleCalendar (Schedule demo calls and meetings with prospects based on their profile and engagement level)"
        },
        {
          "timestamp": "2025-08-11T20:22:57.694Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: nodes-base.segment (Track customer engagement across multiple channels and collect behavioral data for lead scoring)"
        },
        {
          "timestamp": "2025-08-11T20:22:57.793Z",
          "level": "DEBUG",
          "source": "Orchestrator",
          "message": "Session state updated"
        },
        {
          "timestamp": "2025-08-11T20:22:57.794Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Data flow captured: 3 transformations"
        }
      ],
      "nodes": [
        {
          "id": "task_node_1",
          "type": "nodes-base.webhook",
          "purpose": "Set up a webhook to receive data from external services",
          "configuration": {
            "onError": "continueRegularOutput",
            "alwaysOutputData": true,
            "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
            "typeVersion": "1",
            "parameters": {
              "path": "customer-signup",
              "httpMethod": "POST",
              "responseData": "allEntries",
              "responseMode": "lastNode",
              "options": {
                "noResponseBody": false,
                "rawBody": false
              }
            }
          },
          "validationStatus": "valid"
        },
        {
          "id": "task_node_5",
          "type": "nodes-base.code",
          "purpose": "Transform data structure using JavaScript",
          "configuration": {
            "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
            "parameters": {
              "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
              "language": "javaScript"
            }
          },
          "validationStatus": "valid"
        },
        {
          "id": "task_node_4",
          "type": "nodes-base.emailSend",
          "purpose": "Send an email notification",
          "configuration": {
            "onError": "continueRegularOutput",
            "maxTries": 3,
            "retryOnFail": true,
            "alwaysOutputData": true,
            "waitBetweenTries": 3000,
            "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
            "typeVersion": "1",
            "parameters": {
              "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
              "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
              "toEmail": "{{ $json.email }}",
              "fromEmail": "onboarding@company.com"
            }
          },
          "validationStatus": "valid"
        },
        {
          "id": "task_node_2",
          "type": "nodes-base.code",
          "purpose": "Process incoming webhook data with Code node (shows correct data access)",
          "configuration": {
            "onError": "continueRegularOutput",
            "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
            "typeVersion": "1",
            "parameters": {
              "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
              "language": "javaScript"
            }
          },
          "validationStatus": "valid"
        },
        {
          "id": "task_node_6",
          "type": "nodes-base.slack",
          "purpose": "Send a message to Slack channel",
          "configuration": {
            "onError": "continueRegularOutput",
            "maxTries": 2,
            "retryOnFail": true,
            "waitBetweenTries": 2000,
            "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
            "typeVersion": "1",
            "parameters": {
              "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
              "resource": "message",
              "operation": "post",
              "parameters": {},
              "channelId": "#sales-escalations",
              "select": "channel"
            }
          },
          "validationStatus": "valid"
        },
        {
          "id": "task_node_3",
          "type": "nodes-base.httpRequest",
          "purpose": "Make an authenticated API request",
          "configuration": {
            "onError": "continueErrorOutput",
            "maxTries": 3,
            "retryOnFail": true,
            "alwaysOutputData": true,
            "waitBetweenTries": 2000,
            "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
            "typeVersion": "1",
            "parameters": {
              "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
              "method": "GET",
              "sendHeaders": true,
              "authentication": "genericCredentialType",
              "genericAuthType": "headerAuth",
              "headerParameters": {
                "parameters": [
                  {
                    "name": "Authorization",
                    "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                  }
                ]
              }
            }
          },
          "validationStatus": "valid"
        },
        {
          "id": "search_node_1",
          "type": "nodes-base.zohoCrm",
          "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
          "configuration": {
            "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
            "typeVersion": "1",
            "parameters": {
              "resource": "lead",
              "operation": "create",
              "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
              "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
              "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
              "email": "={{ $json.email }}",
              "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
              "leadSource": "Website Signup",
              "leadStatus": "New Lead",
              "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
              "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}",
              "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}"
            }
          },
          "validationStatus": "valid"
        },
        {
          "id": "search_node_2",
          "type": "nodes-base.googleCalendar",
          "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
          "configuration": {
            "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
            "typeVersion": "1.3",
            "parameters": {
              "resource": "event",
              "operation": "create",
              "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
              "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
              "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
              "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
              "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
            }
          },
          "validationStatus": "valid"
        },
        {
          "id": "search_node_3",
          "type": "nodes-base.segment",
          "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
          "configuration": {
            "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
            "typeVersion": "1",
            "parameters": {
              "resource": "track",
              "operation": "event",
              "event": "{{ $json.eventName || 'engagement_event' }}",
              "userId": "{{ $json.userId || $json.email }}",
              "properties": {
                "channel": "{{ $json.channel }}",
                "action": "{{ $json.action }}",
                "value": "{{ $json.value }}",
                "timestamp": "{{ $now }}",
                "source": "onboarding_workflow",
                "lead_score_impact": "{{ $json.scoreImpact || 1 }}",
                "company_size": "{{ $json.companySize }}",
                "industry": "{{ $json.industry }}",
                "engagement_level": "{{ $json.engagementLevel }}"
              },
              "traits": {
                "company": "{{ $json.company }}",
                "title": "{{ $json.title }}",
                "phone": "{{ $json.phone }}",
                "industry": "{{ $json.industry }}",
                "company_size": "{{ $json.companySize }}",
                "lead_status": "{{ $json.leadStatus }}",
                "last_engagement": "{{ $now }}"
              }
            }
          },
          "validationStatus": "valid"
        }
      ],
      "sessionState": {
        "sessionId": "complete_e2e_user_test_1754943708795",
        "createdAt": "2025-08-11T20:21:49.129Z",
        "state": {
          "phase": "building",
          "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
          "discovered": [
            {
              "id": "task_node_1",
              "type": "nodes-base.webhook",
              "config": {
                "path": "webhook",
                "onError": "continueRegularOutput",
                "httpMethod": "POST",
                "responseData": "allEntries",
                "responseMode": "lastNode",
                "alwaysOutputData": true
              },
              "purpose": "Set up a webhook to receive data from external services",
              "displayName": "receive webhook",
              "isPreConfigured": true
            },
            {
              "id": "task_node_5",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                "language": "javaScript"
              },
              "purpose": "Transform data structure using JavaScript",
              "displayName": "transform data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_4",
              "type": "nodes-base.emailSend",
              "config": {
                "text": "",
                "onError": "continueRegularOutput",
                "subject": "",
                "toEmail": "",
                "maxTries": 3,
                "fromEmail": "",
                "retryOnFail": true,
                "alwaysOutputData": true,
                "waitBetweenTries": 3000
              },
              "purpose": "Send an email notification",
              "displayName": "send email",
              "isPreConfigured": true
            },
            {
              "id": "task_node_2",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                "onError": "continueRegularOutput",
                "language": "javaScript"
              },
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "displayName": "process webhook data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_6",
              "type": "nodes-base.slack",
              "config": {
                "text": "",
                "channel": "",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "resource": "message",
                "operation": "post",
                "parameters": {},
                "retryOnFail": true,
                "waitBetweenTries": 2000
              },
              "purpose": "Send a message to Slack channel",
              "displayName": "send slack message",
              "isPreConfigured": true
            },
            {
              "id": "task_node_3",
              "type": "nodes-base.httpRequest",
              "config": {
                "url": "",
                "method": "GET",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "retryOnFail": true,
                "sendHeaders": true,
                "authentication": "genericCredentialType",
                "genericAuthType": "headerAuth",
                "alwaysOutputData": true,
                "headerParameters": {
                  "parameters": [
                    {
                      "name": "",
                      "value": ""
                    }
                  ]
                },
                "waitBetweenTries": 2000
              },
              "purpose": "Make an authenticated API request",
              "displayName": "call api with auth",
              "isPreConfigured": true
            },
            {
              "id": "search_node_1",
              "type": "nodes-base.zohoCrm",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
            },
            {
              "id": "search_node_2",
              "type": "nodes-base.googleCalendar",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
            },
            {
              "id": "search_node_3",
              "type": "nodes-base.segment",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
            }
          ],
          "selected": [
            "task_node_1",
            "task_node_5",
            "task_node_4",
            "task_node_2",
            "task_node_6",
            "task_node_3",
            "search_node_1",
            "search_node_2",
            "search_node_3"
          ],
          "configured": {},
          "validated": {},
          "workflow": {
            "nodes": [],
            "settings": {},
            "connections": {}
          },
          "buildPhases": [],
          "operationHistory": [
            {
              "node": {
                "id": "task_node_1",
                "type": "nodes-base.webhook",
                "config": {
                  "path": "webhook",
                  "onError": "continueRegularOutput",
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode",
                  "alwaysOutputData": true
                },
                "purpose": "Set up a webhook to receive data from external services",
                "displayName": "receive webhook",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_1",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_5",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                },
                "purpose": "Transform data structure using JavaScript",
                "displayName": "transform data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_5",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_4",
                "type": "nodes-base.emailSend",
                "config": {
                  "text": "",
                  "onError": "continueRegularOutput",
                  "subject": "",
                  "toEmail": "",
                  "maxTries": 3,
                  "fromEmail": "",
                  "retryOnFail": true,
                  "alwaysOutputData": true,
                  "waitBetweenTries": 3000
                },
                "purpose": "Send an email notification",
                "displayName": "send email",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_4",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_2",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                  "onError": "continueRegularOutput",
                  "language": "javaScript"
                },
                "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                "displayName": "process webhook data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_2",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_6",
                "type": "nodes-base.slack",
                "config": {
                  "text": "",
                  "channel": "",
                  "onError": "continueRegularOutput",
                  "maxTries": 2,
                  "resource": "message",
                  "operation": "post",
                  "parameters": {},
                  "retryOnFail": true,
                  "waitBetweenTries": 2000
                },
                "purpose": "Send a message to Slack channel",
                "displayName": "send slack message",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_6",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_3",
                "type": "nodes-base.httpRequest",
                "config": {
                  "url": "",
                  "method": "GET",
                  "onError": "continueErrorOutput",
                  "maxTries": 3,
                  "retryOnFail": true,
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "alwaysOutputData": true,
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "",
                        "value": ""
                      }
                    ]
                  },
                  "waitBetweenTries": 2000
                },
                "purpose": "Make an authenticated API request",
                "displayName": "call api with auth",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_1",
                "type": "nodes-base.zohoCrm",
                "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_1",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_2",
                "type": "nodes-base.googleCalendar",
                "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_2",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_3",
                "type": "nodes-base.segment",
                "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "completePhase",
              "phase": "discovery",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "setPhase",
              "phase": "configuration",
              "timestamp": "2025-08-11T20:22:55.179Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                "onError": "continueRegularOutput",
                "parameters": {
                  "path": "customer-signup",
                  "options": {
                    "rawBody": false,
                    "noResponseBody": false
                  },
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode"
                },
                "typeVersion": "1",
                "alwaysOutputData": true
              },
              "nodeId": "task_node_1",
              "purpose": "Set up a webhook to receive data from external services",
              "nodeType": "nodes-base.webhook",
              "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
              "timestamp": "2025-08-11T20:22:55.457Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:55.694Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                "parameters": {
                  "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                }
              },
              "nodeId": "task_node_5",
              "purpose": "Transform data structure using JavaScript",
              "nodeType": "nodes-base.code",
              "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
              "timestamp": "2025-08-11T20:22:55.694Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_5",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:55.939Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                "onError": "continueRegularOutput",
                "maxTries": 3,
                "parameters": {
                  "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                  "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                  "toEmail": "{{ $json.email }}",
                  "fromEmail": "onboarding@company.com"
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "alwaysOutputData": true,
                "waitBetweenTries": 3000
              },
              "nodeId": "task_node_4",
              "purpose": "Send an email notification",
              "nodeType": "nodes-base.emailSend",
              "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
              "timestamp": "2025-08-11T20:22:55.939Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_4",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.169Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                "onError": "continueRegularOutput",
                "parameters": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                  "language": "javaScript"
                },
                "typeVersion": "1"
              },
              "nodeId": "task_node_2",
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "nodeType": "nodes-base.code",
              "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
              "timestamp": "2025-08-11T20:22:56.169Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.384Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "parameters": {
                  "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                  "select": "channel",
                  "resource": "message",
                  "channelId": "#sales-escalations",
                  "operation": "post",
                  "parameters": {}
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "waitBetweenTries": 2000
              },
              "nodeId": "task_node_6",
              "purpose": "Send a message to Slack channel",
              "nodeType": "nodes-base.slack",
              "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
              "timestamp": "2025-08-11T20:22:56.384Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_6",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.635Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                  "method": "GET",
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "Authorization",
                        "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                      }
                    ]
                  }
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "alwaysOutputData": true,
                "waitBetweenTries": 2000
              },
              "nodeId": "task_node_3",
              "purpose": "Make an authenticated API request",
              "nodeType": "nodes-base.httpRequest",
              "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
              "timestamp": "2025-08-11T20:22:56.635Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_3",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.793Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                "parameters": {
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                  "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                  "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                  "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                  "resource": "lead",
                  "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                  "operation": "create",
                  "leadSource": "Website Signup",
                  "leadStatus": "New Lead",
                  "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                  "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                },
                "typeVersion": "1"
              },
              "nodeId": "search_node_1",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
              "nodeType": "nodes-base.zohoCrm",
              "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
              "timestamp": "2025-08-11T20:22:56.793Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.034Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                "parameters": {
                  "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                  "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                  "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                  "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                  "resource": "event",
                  "operation": "create",
                  "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                },
                "typeVersion": "1.3"
              },
              "nodeId": "search_node_2",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
              "nodeType": "nodes-base.googleCalendar",
              "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
              "timestamp": "2025-08-11T20:22:57.034Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.270Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                "parameters": {
                  "event": "{{ $json.eventName || 'engagement_event' }}",
                  "traits": {
                    "phone": "{{ $json.phone }}",
                    "title": "{{ $json.title }}",
                    "company": "{{ $json.company }}",
                    "industry": "{{ $json.industry }}",
                    "lead_status": "{{ $json.leadStatus }}",
                    "company_size": "{{ $json.companySize }}",
                    "last_engagement": "{{ $now }}"
                  },
                  "userId": "{{ $json.userId || $json.email }}",
                  "resource": "track",
                  "operation": "event",
                  "properties": {
                    "value": "{{ $json.value }}",
                    "action": "{{ $json.action }}",
                    "source": "onboarding_workflow",
                    "channel": "{{ $json.channel }}",
                    "industry": "{{ $json.industry }}",
                    "timestamp": "{{ $now }}",
                    "company_size": "{{ $json.companySize }}",
                    "engagement_level": "{{ $json.engagementLevel }}",
                    "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                  }
                },
                "typeVersion": "1"
              },
              "nodeId": "search_node_3",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
              "nodeType": "nodes-base.segment",
              "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
              "timestamp": "2025-08-11T20:22:57.270Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_3",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.511Z"
            },
            {
              "type": "completePhase",
              "phase": "configuration",
              "timestamp": "2025-08-11T20:22:57.511Z"
            }
          ],
          "pendingClarifications": [],
          "clarificationHistory": []
        }
      },
      "stateChanges": {},
      "dataFlow": {
        "input": {
          "discoveredNodes": [
            {
              "id": "task_node_1",
              "type": "nodes-base.webhook",
              "displayName": "receive webhook",
              "purpose": "Set up a webhook to receive data from external services",
              "isPreConfigured": true,
              "config": {
                "httpMethod": "POST",
                "path": "webhook",
                "responseMode": "lastNode",
                "responseData": "allEntries",
                "onError": "continueRegularOutput",
                "alwaysOutputData": true
              }
            },
            {
              "id": "task_node_5",
              "type": "nodes-base.code",
              "displayName": "transform data",
              "purpose": "Transform data structure using JavaScript",
              "isPreConfigured": true,
              "config": {
                "language": "javaScript",
                "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;"
              }
            },
            {
              "id": "task_node_4",
              "type": "nodes-base.emailSend",
              "displayName": "send email",
              "purpose": "Send an email notification",
              "isPreConfigured": true,
              "config": {
                "fromEmail": "",
                "toEmail": "",
                "subject": "",
                "text": "",
                "onError": "continueRegularOutput",
                "retryOnFail": true,
                "maxTries": 3,
                "waitBetweenTries": 3000,
                "alwaysOutputData": true
              }
            },
            {
              "id": "task_node_2",
              "type": "nodes-base.code",
              "displayName": "process webhook data",
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "isPreConfigured": true,
              "config": {
                "language": "javaScript",
                "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                "onError": "continueRegularOutput"
              }
            },
            {
              "id": "task_node_6",
              "type": "nodes-base.slack",
              "displayName": "send slack message",
              "purpose": "Send a message to Slack channel",
              "isPreConfigured": true,
              "config": {
                "resource": "message",
                "operation": "post",
                "channel": "",
                "text": "",
                "onError": "continueRegularOutput",
                "retryOnFail": true,
                "maxTries": 2,
                "waitBetweenTries": 2000,
                "parameters": {}
              }
            },
            {
              "id": "task_node_3",
              "type": "nodes-base.httpRequest",
              "displayName": "call api with auth",
              "purpose": "Make an authenticated API request",
              "isPreConfigured": true,
              "config": {
                "method": "GET",
                "url": "",
                "authentication": "genericCredentialType",
                "genericAuthType": "headerAuth",
                "sendHeaders": true,
                "onError": "continueErrorOutput",
                "retryOnFail": true,
                "maxTries": 3,
                "waitBetweenTries": 2000,
                "alwaysOutputData": true,
                "headerParameters": {
                  "parameters": [
                    {
                      "name": "",
                      "value": ""
                    }
                  ]
                }
              }
            },
            {
              "id": "search_node_1",
              "type": "nodes-base.zohoCrm",
              "displayName": "nodes-base.zohoCrm",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
              "needsConfiguration": true
            },
            {
              "id": "search_node_2",
              "type": "nodes-base.googleCalendar",
              "displayName": "nodes-base.googleCalendar",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
              "needsConfiguration": true
            },
            {
              "id": "search_node_3",
              "type": "nodes-base.segment",
              "displayName": "nodes-base.segment",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
              "needsConfiguration": true
            }
          ]
        },
        "output": {
          "configuredNodes": [
            {
              "id": "task_node_1",
              "type": "nodes-base.webhook",
              "purpose": "Set up a webhook to receive data from external services",
              "config": {
                "onError": "continueRegularOutput",
                "alwaysOutputData": true,
                "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                "typeVersion": "1",
                "parameters": {
                  "path": "customer-signup",
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode",
                  "options": {
                    "noResponseBody": false,
                    "rawBody": false
                  }
                }
              },
              "validated": true
            },
            {
              "id": "task_node_5",
              "type": "nodes-base.code",
              "purpose": "Transform data structure using JavaScript",
              "config": {
                "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                "parameters": {
                  "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                }
              },
              "validated": true
            },
            {
              "id": "task_node_4",
              "type": "nodes-base.emailSend",
              "purpose": "Send an email notification",
              "config": {
                "onError": "continueRegularOutput",
                "maxTries": 3,
                "retryOnFail": true,
                "alwaysOutputData": true,
                "waitBetweenTries": 3000,
                "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                "typeVersion": "1",
                "parameters": {
                  "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                  "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                  "toEmail": "{{ $json.email }}",
                  "fromEmail": "onboarding@company.com"
                }
              },
              "validated": true
            },
            {
              "id": "task_node_2",
              "type": "nodes-base.code",
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "config": {
                "onError": "continueRegularOutput",
                "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                "typeVersion": "1",
                "parameters": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                  "language": "javaScript"
                }
              },
              "validated": true
            },
            {
              "id": "task_node_6",
              "type": "nodes-base.slack",
              "purpose": "Send a message to Slack channel",
              "config": {
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "retryOnFail": true,
                "waitBetweenTries": 2000,
                "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                "typeVersion": "1",
                "parameters": {
                  "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                  "resource": "message",
                  "operation": "post",
                  "parameters": {},
                  "channelId": "#sales-escalations",
                  "select": "channel"
                }
              },
              "validated": true
            },
            {
              "id": "task_node_3",
              "type": "nodes-base.httpRequest",
              "purpose": "Make an authenticated API request",
              "config": {
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "retryOnFail": true,
                "alwaysOutputData": true,
                "waitBetweenTries": 2000,
                "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                "typeVersion": "1",
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                  "method": "GET",
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "Authorization",
                        "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                      }
                    ]
                  }
                }
              },
              "validated": true
            },
            {
              "id": "search_node_1",
              "type": "nodes-base.zohoCrm",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
              "config": {
                "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                "typeVersion": "1",
                "parameters": {
                  "resource": "lead",
                  "operation": "create",
                  "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                  "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                  "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                  "leadSource": "Website Signup",
                  "leadStatus": "New Lead",
                  "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                  "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}",
                  "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}"
                }
              },
              "validated": true
            },
            {
              "id": "search_node_2",
              "type": "nodes-base.googleCalendar",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
              "config": {
                "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                "typeVersion": "1.3",
                "parameters": {
                  "resource": "event",
                  "operation": "create",
                  "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                  "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                  "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                  "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                  "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                }
              },
              "validated": true
            },
            {
              "id": "search_node_3",
              "type": "nodes-base.segment",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
              "config": {
                "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                "typeVersion": "1",
                "parameters": {
                  "resource": "track",
                  "operation": "event",
                  "event": "{{ $json.eventName || 'engagement_event' }}",
                  "userId": "{{ $json.userId || $json.email }}",
                  "properties": {
                    "channel": "{{ $json.channel }}",
                    "action": "{{ $json.action }}",
                    "value": "{{ $json.value }}",
                    "timestamp": "{{ $now }}",
                    "source": "onboarding_workflow",
                    "lead_score_impact": "{{ $json.scoreImpact || 1 }}",
                    "company_size": "{{ $json.companySize }}",
                    "industry": "{{ $json.industry }}",
                    "engagement_level": "{{ $json.engagementLevel }}"
                  },
                  "traits": {
                    "company": "{{ $json.company }}",
                    "title": "{{ $json.title }}",
                    "phone": "{{ $json.phone }}",
                    "industry": "{{ $json.industry }}",
                    "company_size": "{{ $json.companySize }}",
                    "lead_status": "{{ $json.leadStatus }}",
                    "last_engagement": "{{ $now }}"
                  }
                }
              },
              "validated": true
            }
          ]
        },
        "transformations": [
          "Parameter Configuration",
          "Validation",
          "Type Checking"
        ]
      },
      "stateDelta": {
        "added": {},
        "modified": {
          "state": {
            "old": {
              "phase": "configuration",
              "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
              "discovered": [
                {
                  "id": "task_node_1",
                  "type": "nodes-base.webhook",
                  "config": {
                    "path": "webhook",
                    "onError": "continueRegularOutput",
                    "httpMethod": "POST",
                    "responseData": "allEntries",
                    "responseMode": "lastNode",
                    "alwaysOutputData": true
                  },
                  "purpose": "Set up a webhook to receive data from external services",
                  "displayName": "receive webhook",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_5",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                    "language": "javaScript"
                  },
                  "purpose": "Transform data structure using JavaScript",
                  "displayName": "transform data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_4",
                  "type": "nodes-base.emailSend",
                  "config": {
                    "text": "",
                    "onError": "continueRegularOutput",
                    "subject": "",
                    "toEmail": "",
                    "maxTries": 3,
                    "fromEmail": "",
                    "retryOnFail": true,
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "purpose": "Send an email notification",
                  "displayName": "send email",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_2",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                    "onError": "continueRegularOutput",
                    "language": "javaScript"
                  },
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "displayName": "process webhook data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_6",
                  "type": "nodes-base.slack",
                  "config": {
                    "text": "",
                    "channel": "",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "resource": "message",
                    "operation": "post",
                    "parameters": {},
                    "retryOnFail": true,
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Send a message to Slack channel",
                  "displayName": "send slack message",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_3",
                  "type": "nodes-base.httpRequest",
                  "config": {
                    "url": "",
                    "method": "GET",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "retryOnFail": true,
                    "sendHeaders": true,
                    "authentication": "genericCredentialType",
                    "genericAuthType": "headerAuth",
                    "alwaysOutputData": true,
                    "headerParameters": {
                      "parameters": [
                        {
                          "name": "",
                          "value": ""
                        }
                      ]
                    },
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Make an authenticated API request",
                  "displayName": "call api with auth",
                  "isPreConfigured": true
                },
                {
                  "id": "search_node_1",
                  "type": "nodes-base.zohoCrm",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                },
                {
                  "id": "search_node_2",
                  "type": "nodes-base.googleCalendar",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                },
                {
                  "id": "search_node_3",
                  "type": "nodes-base.segment",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                }
              ],
              "selected": [
                "task_node_1",
                "task_node_5",
                "task_node_4",
                "task_node_2",
                "task_node_6",
                "task_node_3",
                "search_node_1",
                "search_node_2",
                "search_node_3"
              ],
              "configured": {},
              "validated": {},
              "workflow": {
                "nodes": [],
                "settings": {},
                "connections": {}
              },
              "buildPhases": [],
              "operationHistory": [
                {
                  "node": {
                    "id": "task_node_1",
                    "type": "nodes-base.webhook",
                    "config": {
                      "path": "webhook",
                      "onError": "continueRegularOutput",
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode",
                      "alwaysOutputData": true
                    },
                    "purpose": "Set up a webhook to receive data from external services",
                    "displayName": "receive webhook",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_1",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_5",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    },
                    "purpose": "Transform data structure using JavaScript",
                    "displayName": "transform data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_5",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_4",
                    "type": "nodes-base.emailSend",
                    "config": {
                      "text": "",
                      "onError": "continueRegularOutput",
                      "subject": "",
                      "toEmail": "",
                      "maxTries": 3,
                      "fromEmail": "",
                      "retryOnFail": true,
                      "alwaysOutputData": true,
                      "waitBetweenTries": 3000
                    },
                    "purpose": "Send an email notification",
                    "displayName": "send email",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_4",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_2",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                      "onError": "continueRegularOutput",
                      "language": "javaScript"
                    },
                    "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                    "displayName": "process webhook data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_2",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_6",
                    "type": "nodes-base.slack",
                    "config": {
                      "text": "",
                      "channel": "",
                      "onError": "continueRegularOutput",
                      "maxTries": 2,
                      "resource": "message",
                      "operation": "post",
                      "parameters": {},
                      "retryOnFail": true,
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Send a message to Slack channel",
                    "displayName": "send slack message",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_6",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_3",
                    "type": "nodes-base.httpRequest",
                    "config": {
                      "url": "",
                      "method": "GET",
                      "onError": "continueErrorOutput",
                      "maxTries": 3,
                      "retryOnFail": true,
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "alwaysOutputData": true,
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ]
                      },
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Make an authenticated API request",
                    "displayName": "call api with auth",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_1",
                    "type": "nodes-base.zohoCrm",
                    "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_1",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_2",
                    "type": "nodes-base.googleCalendar",
                    "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_2",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_3",
                    "type": "nodes-base.segment",
                    "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "completePhase",
                  "phase": "discovery",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                }
              ],
              "pendingClarifications": [],
              "clarificationHistory": []
            },
            "new": {
              "phase": "building",
              "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
              "discovered": [
                {
                  "id": "task_node_1",
                  "type": "nodes-base.webhook",
                  "config": {
                    "path": "webhook",
                    "onError": "continueRegularOutput",
                    "httpMethod": "POST",
                    "responseData": "allEntries",
                    "responseMode": "lastNode",
                    "alwaysOutputData": true
                  },
                  "purpose": "Set up a webhook to receive data from external services",
                  "displayName": "receive webhook",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_5",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                    "language": "javaScript"
                  },
                  "purpose": "Transform data structure using JavaScript",
                  "displayName": "transform data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_4",
                  "type": "nodes-base.emailSend",
                  "config": {
                    "text": "",
                    "onError": "continueRegularOutput",
                    "subject": "",
                    "toEmail": "",
                    "maxTries": 3,
                    "fromEmail": "",
                    "retryOnFail": true,
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "purpose": "Send an email notification",
                  "displayName": "send email",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_2",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                    "onError": "continueRegularOutput",
                    "language": "javaScript"
                  },
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "displayName": "process webhook data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_6",
                  "type": "nodes-base.slack",
                  "config": {
                    "text": "",
                    "channel": "",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "resource": "message",
                    "operation": "post",
                    "parameters": {},
                    "retryOnFail": true,
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Send a message to Slack channel",
                  "displayName": "send slack message",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_3",
                  "type": "nodes-base.httpRequest",
                  "config": {
                    "url": "",
                    "method": "GET",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "retryOnFail": true,
                    "sendHeaders": true,
                    "authentication": "genericCredentialType",
                    "genericAuthType": "headerAuth",
                    "alwaysOutputData": true,
                    "headerParameters": {
                      "parameters": [
                        {
                          "name": "",
                          "value": ""
                        }
                      ]
                    },
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Make an authenticated API request",
                  "displayName": "call api with auth",
                  "isPreConfigured": true
                },
                {
                  "id": "search_node_1",
                  "type": "nodes-base.zohoCrm",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                },
                {
                  "id": "search_node_2",
                  "type": "nodes-base.googleCalendar",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                },
                {
                  "id": "search_node_3",
                  "type": "nodes-base.segment",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                }
              ],
              "selected": [
                "task_node_1",
                "task_node_5",
                "task_node_4",
                "task_node_2",
                "task_node_6",
                "task_node_3",
                "search_node_1",
                "search_node_2",
                "search_node_3"
              ],
              "configured": {},
              "validated": {},
              "workflow": {
                "nodes": [],
                "settings": {},
                "connections": {}
              },
              "buildPhases": [],
              "operationHistory": [
                {
                  "node": {
                    "id": "task_node_1",
                    "type": "nodes-base.webhook",
                    "config": {
                      "path": "webhook",
                      "onError": "continueRegularOutput",
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode",
                      "alwaysOutputData": true
                    },
                    "purpose": "Set up a webhook to receive data from external services",
                    "displayName": "receive webhook",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_1",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_5",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    },
                    "purpose": "Transform data structure using JavaScript",
                    "displayName": "transform data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_5",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_4",
                    "type": "nodes-base.emailSend",
                    "config": {
                      "text": "",
                      "onError": "continueRegularOutput",
                      "subject": "",
                      "toEmail": "",
                      "maxTries": 3,
                      "fromEmail": "",
                      "retryOnFail": true,
                      "alwaysOutputData": true,
                      "waitBetweenTries": 3000
                    },
                    "purpose": "Send an email notification",
                    "displayName": "send email",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_4",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_2",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                      "onError": "continueRegularOutput",
                      "language": "javaScript"
                    },
                    "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                    "displayName": "process webhook data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_2",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_6",
                    "type": "nodes-base.slack",
                    "config": {
                      "text": "",
                      "channel": "",
                      "onError": "continueRegularOutput",
                      "maxTries": 2,
                      "resource": "message",
                      "operation": "post",
                      "parameters": {},
                      "retryOnFail": true,
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Send a message to Slack channel",
                    "displayName": "send slack message",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_6",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_3",
                    "type": "nodes-base.httpRequest",
                    "config": {
                      "url": "",
                      "method": "GET",
                      "onError": "continueErrorOutput",
                      "maxTries": 3,
                      "retryOnFail": true,
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "alwaysOutputData": true,
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ]
                      },
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Make an authenticated API request",
                    "displayName": "call api with auth",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_1",
                    "type": "nodes-base.zohoCrm",
                    "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_1",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_2",
                    "type": "nodes-base.googleCalendar",
                    "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_2",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_3",
                    "type": "nodes-base.segment",
                    "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "completePhase",
                  "phase": "discovery",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "setPhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:55.179Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "path": "customer-signup",
                      "options": {
                        "rawBody": false,
                        "noResponseBody": false
                      },
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode"
                    },
                    "typeVersion": "1",
                    "alwaysOutputData": true
                  },
                  "nodeId": "task_node_1",
                  "purpose": "Set up a webhook to receive data from external services",
                  "nodeType": "nodes-base.webhook",
                  "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
                  "timestamp": "2025-08-11T20:22:55.457Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.694Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                    "parameters": {
                      "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    }
                  },
                  "nodeId": "task_node_5",
                  "purpose": "Transform data structure using JavaScript",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
                  "timestamp": "2025-08-11T20:22:55.694Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_5",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.939Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "parameters": {
                      "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                      "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                      "toEmail": "{{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "nodeId": "task_node_4",
                  "purpose": "Send an email notification",
                  "nodeType": "nodes-base.emailSend",
                  "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
                  "timestamp": "2025-08-11T20:22:55.939Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_4",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.169Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                      "language": "javaScript"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "task_node_2",
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
                  "timestamp": "2025-08-11T20:22:56.169Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.384Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "parameters": {
                      "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                      "select": "channel",
                      "resource": "message",
                      "channelId": "#sales-escalations",
                      "operation": "post",
                      "parameters": {}
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_6",
                  "purpose": "Send a message to Slack channel",
                  "nodeType": "nodes-base.slack",
                  "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
                  "timestamp": "2025-08-11T20:22:56.384Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_6",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.635Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                      "method": "GET",
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "Authorization",
                            "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                          }
                        ]
                      }
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_3",
                  "purpose": "Make an authenticated API request",
                  "nodeType": "nodes-base.httpRequest",
                  "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
                  "timestamp": "2025-08-11T20:22:56.635Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.793Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                      "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                      "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                      "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                      "resource": "lead",
                      "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                      "operation": "create",
                      "leadSource": "Website Signup",
                      "leadStatus": "New Lead",
                      "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                      "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_1",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
                  "nodeType": "nodes-base.zohoCrm",
                  "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:56.793Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.034Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                    "parameters": {
                      "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                      "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                      "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                      "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                      "resource": "event",
                      "operation": "create",
                      "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                    },
                    "typeVersion": "1.3"
                  },
                  "nodeId": "search_node_2",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
                  "nodeType": "nodes-base.googleCalendar",
                  "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.034Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.270Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                    "parameters": {
                      "event": "{{ $json.eventName || 'engagement_event' }}",
                      "traits": {
                        "phone": "{{ $json.phone }}",
                        "title": "{{ $json.title }}",
                        "company": "{{ $json.company }}",
                        "industry": "{{ $json.industry }}",
                        "lead_status": "{{ $json.leadStatus }}",
                        "company_size": "{{ $json.companySize }}",
                        "last_engagement": "{{ $now }}"
                      },
                      "userId": "{{ $json.userId || $json.email }}",
                      "resource": "track",
                      "operation": "event",
                      "properties": {
                        "value": "{{ $json.value }}",
                        "action": "{{ $json.action }}",
                        "source": "onboarding_workflow",
                        "channel": "{{ $json.channel }}",
                        "industry": "{{ $json.industry }}",
                        "timestamp": "{{ $now }}",
                        "company_size": "{{ $json.companySize }}",
                        "engagement_level": "{{ $json.engagementLevel }}",
                        "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                      }
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_3",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
                  "nodeType": "nodes-base.segment",
                  "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.270Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "completePhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:57.511Z"
                }
              ],
              "pendingClarifications": [],
              "clarificationHistory": []
            }
          }
        },
        "removed": [],
        "unchanged": [
          "sessionId",
          "createdAt"
        ]
      }
    },
    "building": {
      "name": "Building",
      "success": true,
      "metrics": {
        "startTime": 1754943777794,
        "endTime": 1754943833906,
        "duration": 56112,
        "memoryUsage": {
          "heapUsed": -624600,
          "heapTotal": 42287104,
          "external": 7853314
        }
      },
      "logs": [
        {
          "timestamp": "2025-08-11T20:22:57.794Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Starting building phase"
        },
        {
          "timestamp": "2025-08-11T20:22:57.794Z",
          "level": "DEBUG",
          "source": "Claude",
          "message": "Sending request for building phase"
        },
        {
          "timestamp": "2025-08-11T20:23:53.755Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: n8n-nodes-base.webhook (Customer Signup Webhook)"
        },
        {
          "timestamp": "2025-08-11T20:23:53.755Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: n8n-nodes-base.code (Process Signup Data)"
        },
        {
          "timestamp": "2025-08-11T20:23:53.756Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: n8n-nodes-base.httpRequest (Fetch Company Data)"
        },
        {
          "timestamp": "2025-08-11T20:23:53.756Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: n8n-nodes-base.code (Analyze Company Profile)"
        },
        {
          "timestamp": "2025-08-11T20:23:53.756Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: n8n-nodes-base.emailSend (Send Personalized Welcome Email)"
        },
        {
          "timestamp": "2025-08-11T20:23:53.756Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: n8n-nodes-base.segment (Track Signup Event)"
        },
        {
          "timestamp": "2025-08-11T20:23:53.756Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: n8n-nodes-base.zohoCrm (Create CRM Lead)"
        },
        {
          "timestamp": "2025-08-11T20:23:53.756Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: n8n-nodes-base.googleCalendar (Schedule Demo Call)"
        },
        {
          "timestamp": "2025-08-11T20:23:53.756Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Added node: n8n-nodes-base.slack (Notify Sales Team)"
        },
        {
          "timestamp": "2025-08-11T20:23:53.756Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Created 9 nodes"
        },
        {
          "timestamp": "2025-08-11T20:23:53.756Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Created 5 connection groups"
        },
        {
          "timestamp": "2025-08-11T20:23:53.905Z",
          "level": "DEBUG",
          "source": "Orchestrator",
          "message": "Session state updated"
        },
        {
          "timestamp": "2025-08-11T20:23:53.906Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Data flow captured: 3 transformations"
        }
      ],
      "nodes": [
        {
          "id": "webhook_1",
          "type": "n8n-nodes-base.webhook",
          "purpose": "Customer Signup Webhook"
        },
        {
          "id": "code_1",
          "type": "n8n-nodes-base.code",
          "purpose": "Process Signup Data"
        },
        {
          "id": "httpRequest_1",
          "type": "n8n-nodes-base.httpRequest",
          "purpose": "Fetch Company Data"
        },
        {
          "id": "code_2",
          "type": "n8n-nodes-base.code",
          "purpose": "Analyze Company Profile"
        },
        {
          "id": "emailSend_1",
          "type": "n8n-nodes-base.emailSend",
          "purpose": "Send Personalized Welcome Email"
        },
        {
          "id": "segment_1",
          "type": "n8n-nodes-base.segment",
          "purpose": "Track Signup Event"
        },
        {
          "id": "zohoCrm_1",
          "type": "n8n-nodes-base.zohoCrm",
          "purpose": "Create CRM Lead"
        },
        {
          "id": "googleCalendar_1",
          "type": "n8n-nodes-base.googleCalendar",
          "purpose": "Schedule Demo Call"
        },
        {
          "id": "slack_1",
          "type": "n8n-nodes-base.slack",
          "purpose": "Notify Sales Team"
        }
      ],
      "sessionState": {
        "sessionId": "complete_e2e_user_test_1754943708795",
        "createdAt": "2025-08-11T20:21:49.129Z",
        "state": {
          "phase": "validation",
          "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
          "discovered": [
            {
              "id": "task_node_1",
              "type": "nodes-base.webhook",
              "config": {
                "path": "webhook",
                "onError": "continueRegularOutput",
                "httpMethod": "POST",
                "responseData": "allEntries",
                "responseMode": "lastNode",
                "alwaysOutputData": true
              },
              "purpose": "Set up a webhook to receive data from external services",
              "displayName": "receive webhook",
              "isPreConfigured": true
            },
            {
              "id": "task_node_5",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                "language": "javaScript"
              },
              "purpose": "Transform data structure using JavaScript",
              "displayName": "transform data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_4",
              "type": "nodes-base.emailSend",
              "config": {
                "text": "",
                "onError": "continueRegularOutput",
                "subject": "",
                "toEmail": "",
                "maxTries": 3,
                "fromEmail": "",
                "retryOnFail": true,
                "alwaysOutputData": true,
                "waitBetweenTries": 3000
              },
              "purpose": "Send an email notification",
              "displayName": "send email",
              "isPreConfigured": true
            },
            {
              "id": "task_node_2",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                "onError": "continueRegularOutput",
                "language": "javaScript"
              },
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "displayName": "process webhook data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_6",
              "type": "nodes-base.slack",
              "config": {
                "text": "",
                "channel": "",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "resource": "message",
                "operation": "post",
                "parameters": {},
                "retryOnFail": true,
                "waitBetweenTries": 2000
              },
              "purpose": "Send a message to Slack channel",
              "displayName": "send slack message",
              "isPreConfigured": true
            },
            {
              "id": "task_node_3",
              "type": "nodes-base.httpRequest",
              "config": {
                "url": "",
                "method": "GET",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "retryOnFail": true,
                "sendHeaders": true,
                "authentication": "genericCredentialType",
                "genericAuthType": "headerAuth",
                "alwaysOutputData": true,
                "headerParameters": {
                  "parameters": [
                    {
                      "name": "",
                      "value": ""
                    }
                  ]
                },
                "waitBetweenTries": 2000
              },
              "purpose": "Make an authenticated API request",
              "displayName": "call api with auth",
              "isPreConfigured": true
            },
            {
              "id": "search_node_1",
              "type": "nodes-base.zohoCrm",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
            },
            {
              "id": "search_node_2",
              "type": "nodes-base.googleCalendar",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
            },
            {
              "id": "search_node_3",
              "type": "nodes-base.segment",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
            }
          ],
          "selected": [
            "task_node_1",
            "task_node_5",
            "task_node_4",
            "task_node_2",
            "task_node_6",
            "task_node_3",
            "search_node_1",
            "search_node_2",
            "search_node_3"
          ],
          "configured": {},
          "validated": {},
          "workflow": {
            "name": "Intelligent Customer Onboarding Workflow",
            "nodes": [
              {
                "id": "webhook_1",
                "name": "Customer Signup Webhook",
                "type": "n8n-nodes-base.webhook",
                "onError": "stopWorkflow",
                "position": [
                  250,
                  300
                ],
                "parameters": {
                  "path": "customer-signup",
                  "options": {},
                  "httpMethod": "POST",
                  "responseMode": "responseNode"
                },
                "typeVersion": 1
              },
              {
                "id": "code_1",
                "name": "Process Signup Data",
                "type": "n8n-nodes-base.code",
                "onError": "continueRegularOutput",
                "position": [
                  550,
                  300
                ],
                "parameters": {
                  "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                },
                "typeVersion": 2
              },
              {
                "id": "httpRequest_1",
                "name": "Fetch Company Data",
                "type": "n8n-nodes-base.httpRequest",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "position": [
                  850,
                  300
                ],
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find",
                  "options": {
                    "retry": {
                      "enabled": true,
                      "maxTries": 3
                    },
                    "timeout": 10000
                  },
                  "sendQuery": true,
                  "authentication": "predefinedCredentialType",
                  "queryParameters": {
                    "parameters": [
                      {
                        "name": "domain",
                        "value": "={{ $json.enrichmentQuery.domain }}"
                      }
                    ]
                  },
                  "nodeCredentialType": "clearbitApi"
                },
                "retryOnFail": true,
                "typeVersion": 4.1
              },
              {
                "id": "code_2",
                "name": "Analyze Company Profile",
                "type": "n8n-nodes-base.code",
                "onError": "continueRegularOutput",
                "position": [
                  1150,
                  300
                ],
                "parameters": {
                  "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                },
                "typeVersion": 2
              },
              {
                "id": "emailSend_1",
                "name": "Send Personalized Welcome Email",
                "type": "n8n-nodes-base.emailSend",
                "onError": "continueRegularOutput",
                "maxTries": 3,
                "position": [
                  1450,
                  200
                ],
                "parameters": {
                  "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                  "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                  "options": {},
                  "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                  "toEmail": "={{ $json.email }}",
                  "fromEmail": "onboarding@company.com"
                },
                "typeVersion": 2
              },
              {
                "id": "segment_1",
                "name": "Track Signup Event",
                "type": "n8n-nodes-base.segment",
                "onError": "continueRegularOutput",
                "position": [
                  1450,
                  400
                ],
                "parameters": {
                  "event": "Customer Signed Up",
                  "traits": {
                    "tier": "={{ $json.companyProfile.tier }}",
                    "email": "={{ $json.email }}",
                    "company": "={{ $json.company }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "lastName": "={{ $json.lastName }}",
                    "firstName": "={{ $json.firstName }}",
                    "leadScore": "={{ $json.leadScore }}",
                    "companySize": "={{ $json.companyProfile.size }}"
                  },
                  "userId": "={{ $json.email }}",
                  "properties": {
                    "source": "={{ $json.source }}",
                    "demoType": "={{ $json.companyProfile.demoType }}",
                    "signupDate": "={{ $json.signupDate }}",
                    "isHighValue": "={{ $json.isHighValue }}"
                  }
                },
                "typeVersion": 1
              },
              {
                "id": "zohoCrm_1",
                "name": "Create CRM Lead",
                "type": "n8n-nodes-base.zohoCrm",
                "onError": "continueRegularOutput",
                "position": [
                  1750,
                  300
                ],
                "parameters": {
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone }}",
                  "module": "lead",
                  "company": "={{ $json.company }}",
                  "lastName": "={{ $json.lastName }}",
                  "firstName": "={{ $json.firstName }}",
                  "operation": "create",
                  "additionalFields": {
                    "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "leadSource": "Website Signup",
                    "leadStatus": "New",
                    "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                  }
                },
                "typeVersion": 1
              },
              {
                "id": "googleCalendar_1",
                "name": "Schedule Demo Call",
                "type": "n8n-nodes-base.googleCalendar",
                "onError": "continueRegularOutput",
                "position": [
                  2050,
                  200
                ],
                "parameters": {
                  "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                  "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                  "options": {
                    "sendNotifications": true
                  },
                  "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                  "attendees": "={{ $json.email }}",
                  "operation": "create",
                  "calendarId": "primary",
                  "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                },
                "typeVersion": 1
              },
              {
                "id": "slack_1",
                "name": "Notify Sales Team",
                "type": "n8n-nodes-base.slack",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "position": [
                  2050,
                  400
                ],
                "parameters": {
                  "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                  "channel": "#sales-alerts",
                  "otherOptions": {
                    "includeLinkToWorkflow": true
                  }
                },
                "executeOnce": true,
                "typeVersion": 1
              }
            ],
            "settings": {
              "executionOrder": "v1",
              "saveManualExecutions": true,
              "saveDataErrorExecution": "all",
              "saveDataSuccessExecution": "all"
            },
            "connections": {
              "Create CRM Lead": {
                "main": [
                  [
                    {
                      "node": "Schedule Demo Call",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Notify Sales Team",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Fetch Company Data": {
                "main": [
                  [
                    {
                      "node": "Analyze Company Profile",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Process Signup Data": {
                "main": [
                  [
                    {
                      "node": "Fetch Company Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Analyze Company Profile": {
                "main": [
                  [
                    {
                      "node": "Send Personalized Welcome Email",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Track Signup Event",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Create CRM Lead",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Customer Signup Webhook": {
                "main": [
                  [
                    {
                      "node": "Process Signup Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              }
            }
          },
          "buildPhases": [
            {
              "type": "trigger",
              "nodeIds": [
                "webhook_1"
              ],
              "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
            },
            {
              "type": "data_processing",
              "nodeIds": [
                "code_1"
              ],
              "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
            },
            {
              "type": "data_collection",
              "nodeIds": [
                "httpRequest_1"
              ],
              "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
            },
            {
              "type": "data_processing",
              "nodeIds": [
                "code_2"
              ],
              "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
            },
            {
              "type": "notification",
              "nodeIds": [
                "emailSend_1",
                "segment_1"
              ],
              "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
            },
            {
              "type": "storage",
              "nodeIds": [
                "zohoCrm_1"
              ],
              "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
            },
            {
              "type": "integration",
              "nodeIds": [
                "googleCalendar_1",
                "slack_1"
              ],
              "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
            }
          ],
          "operationHistory": [
            {
              "node": {
                "id": "task_node_1",
                "type": "nodes-base.webhook",
                "config": {
                  "path": "webhook",
                  "onError": "continueRegularOutput",
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode",
                  "alwaysOutputData": true
                },
                "purpose": "Set up a webhook to receive data from external services",
                "displayName": "receive webhook",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_1",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_5",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                },
                "purpose": "Transform data structure using JavaScript",
                "displayName": "transform data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_5",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_4",
                "type": "nodes-base.emailSend",
                "config": {
                  "text": "",
                  "onError": "continueRegularOutput",
                  "subject": "",
                  "toEmail": "",
                  "maxTries": 3,
                  "fromEmail": "",
                  "retryOnFail": true,
                  "alwaysOutputData": true,
                  "waitBetweenTries": 3000
                },
                "purpose": "Send an email notification",
                "displayName": "send email",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_4",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_2",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                  "onError": "continueRegularOutput",
                  "language": "javaScript"
                },
                "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                "displayName": "process webhook data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_2",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_6",
                "type": "nodes-base.slack",
                "config": {
                  "text": "",
                  "channel": "",
                  "onError": "continueRegularOutput",
                  "maxTries": 2,
                  "resource": "message",
                  "operation": "post",
                  "parameters": {},
                  "retryOnFail": true,
                  "waitBetweenTries": 2000
                },
                "purpose": "Send a message to Slack channel",
                "displayName": "send slack message",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_6",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_3",
                "type": "nodes-base.httpRequest",
                "config": {
                  "url": "",
                  "method": "GET",
                  "onError": "continueErrorOutput",
                  "maxTries": 3,
                  "retryOnFail": true,
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "alwaysOutputData": true,
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "",
                        "value": ""
                      }
                    ]
                  },
                  "waitBetweenTries": 2000
                },
                "purpose": "Make an authenticated API request",
                "displayName": "call api with auth",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_1",
                "type": "nodes-base.zohoCrm",
                "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_1",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_2",
                "type": "nodes-base.googleCalendar",
                "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_2",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_3",
                "type": "nodes-base.segment",
                "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "completePhase",
              "phase": "discovery",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "setPhase",
              "phase": "configuration",
              "timestamp": "2025-08-11T20:22:55.179Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                "onError": "continueRegularOutput",
                "parameters": {
                  "path": "customer-signup",
                  "options": {
                    "rawBody": false,
                    "noResponseBody": false
                  },
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode"
                },
                "typeVersion": "1",
                "alwaysOutputData": true
              },
              "nodeId": "task_node_1",
              "purpose": "Set up a webhook to receive data from external services",
              "nodeType": "nodes-base.webhook",
              "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
              "timestamp": "2025-08-11T20:22:55.457Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:55.694Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                "parameters": {
                  "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                }
              },
              "nodeId": "task_node_5",
              "purpose": "Transform data structure using JavaScript",
              "nodeType": "nodes-base.code",
              "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
              "timestamp": "2025-08-11T20:22:55.694Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_5",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:55.939Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                "onError": "continueRegularOutput",
                "maxTries": 3,
                "parameters": {
                  "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                  "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                  "toEmail": "{{ $json.email }}",
                  "fromEmail": "onboarding@company.com"
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "alwaysOutputData": true,
                "waitBetweenTries": 3000
              },
              "nodeId": "task_node_4",
              "purpose": "Send an email notification",
              "nodeType": "nodes-base.emailSend",
              "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
              "timestamp": "2025-08-11T20:22:55.939Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_4",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.169Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                "onError": "continueRegularOutput",
                "parameters": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                  "language": "javaScript"
                },
                "typeVersion": "1"
              },
              "nodeId": "task_node_2",
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "nodeType": "nodes-base.code",
              "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
              "timestamp": "2025-08-11T20:22:56.169Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.384Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "parameters": {
                  "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                  "select": "channel",
                  "resource": "message",
                  "channelId": "#sales-escalations",
                  "operation": "post",
                  "parameters": {}
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "waitBetweenTries": 2000
              },
              "nodeId": "task_node_6",
              "purpose": "Send a message to Slack channel",
              "nodeType": "nodes-base.slack",
              "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
              "timestamp": "2025-08-11T20:22:56.384Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_6",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.635Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                  "method": "GET",
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "Authorization",
                        "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                      }
                    ]
                  }
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "alwaysOutputData": true,
                "waitBetweenTries": 2000
              },
              "nodeId": "task_node_3",
              "purpose": "Make an authenticated API request",
              "nodeType": "nodes-base.httpRequest",
              "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
              "timestamp": "2025-08-11T20:22:56.635Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_3",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.793Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                "parameters": {
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                  "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                  "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                  "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                  "resource": "lead",
                  "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                  "operation": "create",
                  "leadSource": "Website Signup",
                  "leadStatus": "New Lead",
                  "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                  "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                },
                "typeVersion": "1"
              },
              "nodeId": "search_node_1",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
              "nodeType": "nodes-base.zohoCrm",
              "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
              "timestamp": "2025-08-11T20:22:56.793Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.034Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                "parameters": {
                  "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                  "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                  "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                  "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                  "resource": "event",
                  "operation": "create",
                  "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                },
                "typeVersion": "1.3"
              },
              "nodeId": "search_node_2",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
              "nodeType": "nodes-base.googleCalendar",
              "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
              "timestamp": "2025-08-11T20:22:57.034Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.270Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                "parameters": {
                  "event": "{{ $json.eventName || 'engagement_event' }}",
                  "traits": {
                    "phone": "{{ $json.phone }}",
                    "title": "{{ $json.title }}",
                    "company": "{{ $json.company }}",
                    "industry": "{{ $json.industry }}",
                    "lead_status": "{{ $json.leadStatus }}",
                    "company_size": "{{ $json.companySize }}",
                    "last_engagement": "{{ $now }}"
                  },
                  "userId": "{{ $json.userId || $json.email }}",
                  "resource": "track",
                  "operation": "event",
                  "properties": {
                    "value": "{{ $json.value }}",
                    "action": "{{ $json.action }}",
                    "source": "onboarding_workflow",
                    "channel": "{{ $json.channel }}",
                    "industry": "{{ $json.industry }}",
                    "timestamp": "{{ $now }}",
                    "company_size": "{{ $json.companySize }}",
                    "engagement_level": "{{ $json.engagementLevel }}",
                    "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                  }
                },
                "typeVersion": "1"
              },
              "nodeId": "search_node_3",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
              "nodeType": "nodes-base.segment",
              "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
              "timestamp": "2025-08-11T20:22:57.270Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_3",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.511Z"
            },
            {
              "type": "completePhase",
              "phase": "configuration",
              "timestamp": "2025-08-11T20:22:57.511Z"
            },
            {
              "type": "setPhase",
              "phase": "building",
              "timestamp": "2025-08-11T20:23:53.196Z"
            },
            {
              "type": "setWorkflow",
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.1
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                      "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                      "options": {},
                      "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 1
                  }
                ],
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "timestamp": "2025-08-11T20:23:53.469Z"
            },
            {
              "type": "setBuildPhases",
              "phases": [
                {
                  "type": "trigger",
                  "nodeIds": [
                    "webhook_1"
                  ],
                  "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_1"
                  ],
                  "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                },
                {
                  "type": "data_collection",
                  "nodeIds": [
                    "httpRequest_1"
                  ],
                  "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_2"
                  ],
                  "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                },
                {
                  "type": "notification",
                  "nodeIds": [
                    "emailSend_1",
                    "segment_1"
                  ],
                  "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                },
                {
                  "type": "storage",
                  "nodeIds": [
                    "zohoCrm_1"
                  ],
                  "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                },
                {
                  "type": "integration",
                  "nodeIds": [
                    "googleCalendar_1",
                    "slack_1"
                  ],
                  "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                }
              ],
              "timestamp": "2025-08-11T20:23:53.469Z"
            },
            {
              "type": "completePhase",
              "phase": "building",
              "timestamp": "2025-08-11T20:23:53.469Z"
            }
          ],
          "pendingClarifications": [],
          "clarificationHistory": []
        }
      },
      "stateChanges": {},
      "dataFlow": {
        "input": {
          "configuredNodes": [
            {
              "id": "task_node_1",
              "type": "nodes-base.webhook",
              "purpose": "Set up a webhook to receive data from external services",
              "config": {
                "onError": "continueRegularOutput",
                "alwaysOutputData": true,
                "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                "typeVersion": "1",
                "parameters": {
                  "path": "customer-signup",
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode",
                  "options": {
                    "noResponseBody": false,
                    "rawBody": false
                  }
                }
              },
              "validated": true
            },
            {
              "id": "task_node_5",
              "type": "nodes-base.code",
              "purpose": "Transform data structure using JavaScript",
              "config": {
                "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                "parameters": {
                  "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                }
              },
              "validated": true
            },
            {
              "id": "task_node_4",
              "type": "nodes-base.emailSend",
              "purpose": "Send an email notification",
              "config": {
                "onError": "continueRegularOutput",
                "maxTries": 3,
                "retryOnFail": true,
                "alwaysOutputData": true,
                "waitBetweenTries": 3000,
                "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                "typeVersion": "1",
                "parameters": {
                  "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                  "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                  "toEmail": "{{ $json.email }}",
                  "fromEmail": "onboarding@company.com"
                }
              },
              "validated": true
            },
            {
              "id": "task_node_2",
              "type": "nodes-base.code",
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "config": {
                "onError": "continueRegularOutput",
                "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                "typeVersion": "1",
                "parameters": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                  "language": "javaScript"
                }
              },
              "validated": true
            },
            {
              "id": "task_node_6",
              "type": "nodes-base.slack",
              "purpose": "Send a message to Slack channel",
              "config": {
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "retryOnFail": true,
                "waitBetweenTries": 2000,
                "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                "typeVersion": "1",
                "parameters": {
                  "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                  "resource": "message",
                  "operation": "post",
                  "parameters": {},
                  "channelId": "#sales-escalations",
                  "select": "channel"
                }
              },
              "validated": true
            },
            {
              "id": "task_node_3",
              "type": "nodes-base.httpRequest",
              "purpose": "Make an authenticated API request",
              "config": {
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "retryOnFail": true,
                "alwaysOutputData": true,
                "waitBetweenTries": 2000,
                "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                "typeVersion": "1",
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                  "method": "GET",
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "Authorization",
                        "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                      }
                    ]
                  }
                }
              },
              "validated": true
            },
            {
              "id": "search_node_1",
              "type": "nodes-base.zohoCrm",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
              "config": {
                "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                "typeVersion": "1",
                "parameters": {
                  "resource": "lead",
                  "operation": "create",
                  "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                  "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                  "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                  "leadSource": "Website Signup",
                  "leadStatus": "New Lead",
                  "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                  "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}",
                  "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}"
                }
              },
              "validated": true
            },
            {
              "id": "search_node_2",
              "type": "nodes-base.googleCalendar",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
              "config": {
                "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                "typeVersion": "1.3",
                "parameters": {
                  "resource": "event",
                  "operation": "create",
                  "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                  "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                  "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                  "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                  "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                }
              },
              "validated": true
            },
            {
              "id": "search_node_3",
              "type": "nodes-base.segment",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
              "config": {
                "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                "typeVersion": "1",
                "parameters": {
                  "resource": "track",
                  "operation": "event",
                  "event": "{{ $json.eventName || 'engagement_event' }}",
                  "userId": "{{ $json.userId || $json.email }}",
                  "properties": {
                    "channel": "{{ $json.channel }}",
                    "action": "{{ $json.action }}",
                    "value": "{{ $json.value }}",
                    "timestamp": "{{ $now }}",
                    "source": "onboarding_workflow",
                    "lead_score_impact": "{{ $json.scoreImpact || 1 }}",
                    "company_size": "{{ $json.companySize }}",
                    "industry": "{{ $json.industry }}",
                    "engagement_level": "{{ $json.engagementLevel }}"
                  },
                  "traits": {
                    "company": "{{ $json.company }}",
                    "title": "{{ $json.title }}",
                    "phone": "{{ $json.phone }}",
                    "industry": "{{ $json.industry }}",
                    "company_size": "{{ $json.companySize }}",
                    "lead_status": "{{ $json.leadStatus }}",
                    "last_engagement": "{{ $now }}"
                  }
                }
              },
              "validated": true
            }
          ]
        },
        "output": {
          "workflow": {
            "name": "Intelligent Customer Onboarding Workflow",
            "nodes": [
              {
                "id": "webhook_1",
                "type": "n8n-nodes-base.webhook",
                "position": [
                  250,
                  300
                ],
                "parameters": {
                  "httpMethod": "POST",
                  "path": "customer-signup",
                  "responseMode": "responseNode",
                  "options": {}
                },
                "name": "Customer Signup Webhook",
                "typeVersion": 1,
                "onError": "stopWorkflow"
              },
              {
                "id": "code_1",
                "type": "n8n-nodes-base.code",
                "position": [
                  550,
                  300
                ],
                "parameters": {
                  "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                },
                "name": "Process Signup Data",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "httpRequest_1",
                "type": "n8n-nodes-base.httpRequest",
                "position": [
                  850,
                  300
                ],
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find",
                  "authentication": "predefinedCredentialType",
                  "nodeCredentialType": "clearbitApi",
                  "sendQuery": true,
                  "queryParameters": {
                    "parameters": [
                      {
                        "name": "domain",
                        "value": "={{ $json.enrichmentQuery.domain }}"
                      }
                    ]
                  },
                  "options": {
                    "timeout": 10000,
                    "retry": {
                      "enabled": true,
                      "maxTries": 3
                    }
                  }
                },
                "name": "Fetch Company Data",
                "typeVersion": 4.1,
                "onError": "continueErrorOutput",
                "retryOnFail": true,
                "maxTries": 3
              },
              {
                "id": "code_2",
                "type": "n8n-nodes-base.code",
                "position": [
                  1150,
                  300
                ],
                "parameters": {
                  "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                },
                "name": "Analyze Company Profile",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "emailSend_1",
                "type": "n8n-nodes-base.emailSend",
                "position": [
                  1450,
                  200
                ],
                "parameters": {
                  "fromEmail": "onboarding@company.com",
                  "toEmail": "={{ $json.email }}",
                  "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                  "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                  "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                  "options": {}
                },
                "name": "Send Personalized Welcome Email",
                "typeVersion": 2,
                "onError": "continueRegularOutput",
                "maxTries": 3
              },
              {
                "id": "segment_1",
                "type": "n8n-nodes-base.segment",
                "position": [
                  1450,
                  400
                ],
                "parameters": {
                  "userId": "={{ $json.email }}",
                  "event": "Customer Signed Up",
                  "traits": {
                    "email": "={{ $json.email }}",
                    "firstName": "={{ $json.firstName }}",
                    "lastName": "={{ $json.lastName }}",
                    "company": "={{ $json.company }}",
                    "companySize": "={{ $json.companyProfile.size }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "tier": "={{ $json.companyProfile.tier }}",
                    "leadScore": "={{ $json.leadScore }}"
                  },
                  "properties": {
                    "source": "={{ $json.source }}",
                    "signupDate": "={{ $json.signupDate }}",
                    "isHighValue": "={{ $json.isHighValue }}",
                    "demoType": "={{ $json.companyProfile.demoType }}"
                  }
                },
                "name": "Track Signup Event",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "zohoCrm_1",
                "type": "n8n-nodes-base.zohoCrm",
                "position": [
                  1750,
                  300
                ],
                "parameters": {
                  "operation": "create",
                  "module": "lead",
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone }}",
                  "firstName": "={{ $json.firstName }}",
                  "lastName": "={{ $json.lastName }}",
                  "company": "={{ $json.company }}",
                  "additionalFields": {
                    "leadSource": "Website Signup",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "leadStatus": "New",
                    "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                    "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                  }
                },
                "name": "Create CRM Lead",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "googleCalendar_1",
                "type": "n8n-nodes-base.googleCalendar",
                "position": [
                  2050,
                  200
                ],
                "parameters": {
                  "operation": "create",
                  "calendarId": "primary",
                  "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                  "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                  "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                  "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}",
                  "attendees": "={{ $json.email }}",
                  "options": {
                    "sendNotifications": true
                  }
                },
                "name": "Schedule Demo Call",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "slack_1",
                "type": "n8n-nodes-base.slack",
                "position": [
                  2050,
                  400
                ],
                "parameters": {
                  "channel": "#sales-alerts",
                  "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                  "otherOptions": {
                    "includeLinkToWorkflow": true
                  }
                },
                "name": "Notify Sales Team",
                "typeVersion": 1,
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "executeOnce": true
              }
            ],
            "connections": {
              "Customer Signup Webhook": {
                "main": [
                  [
                    {
                      "node": "Process Signup Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Process Signup Data": {
                "main": [
                  [
                    {
                      "node": "Fetch Company Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Fetch Company Data": {
                "main": [
                  [
                    {
                      "node": "Analyze Company Profile",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Analyze Company Profile": {
                "main": [
                  [
                    {
                      "node": "Send Personalized Welcome Email",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Track Signup Event",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Create CRM Lead",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Create CRM Lead": {
                "main": [
                  [
                    {
                      "node": "Schedule Demo Call",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Notify Sales Team",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              }
            },
            "settings": {
              "executionOrder": "v1",
              "saveDataSuccessExecution": "all",
              "saveDataErrorExecution": "all",
              "saveManualExecutions": true
            }
          }
        },
        "transformations": [
          "Workflow Generation",
          "Connection Building",
          "Settings Configuration"
        ]
      },
      "stateDelta": {
        "added": {
          "state": {
            "workflow": {
              "name": "Intelligent Customer Onboarding Workflow",
              "settings": {
                "executionOrder": "v1",
                "saveManualExecutions": true,
                "saveDataErrorExecution": "all",
                "saveDataSuccessExecution": "all"
              },
              "connections": {
                "Create CRM Lead": {
                  "main": [
                    [
                      {
                        "node": "Schedule Demo Call",
                        "type": "main",
                        "index": 0
                      },
                      {
                        "node": "Notify Sales Team",
                        "type": "main",
                        "index": 0
                      }
                    ]
                  ]
                },
                "Fetch Company Data": {
                  "main": [
                    [
                      {
                        "node": "Analyze Company Profile",
                        "type": "main",
                        "index": 0
                      }
                    ]
                  ]
                },
                "Process Signup Data": {
                  "main": [
                    [
                      {
                        "node": "Fetch Company Data",
                        "type": "main",
                        "index": 0
                      }
                    ]
                  ]
                },
                "Analyze Company Profile": {
                  "main": [
                    [
                      {
                        "node": "Send Personalized Welcome Email",
                        "type": "main",
                        "index": 0
                      },
                      {
                        "node": "Track Signup Event",
                        "type": "main",
                        "index": 0
                      },
                      {
                        "node": "Create CRM Lead",
                        "type": "main",
                        "index": 0
                      }
                    ]
                  ]
                },
                "Customer Signup Webhook": {
                  "main": [
                    [
                      {
                        "node": "Process Signup Data",
                        "type": "main",
                        "index": 0
                      }
                    ]
                  ]
                }
              }
            }
          }
        },
        "modified": {
          "state": {
            "old": {
              "phase": "building",
              "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
              "discovered": [
                {
                  "id": "task_node_1",
                  "type": "nodes-base.webhook",
                  "config": {
                    "path": "webhook",
                    "onError": "continueRegularOutput",
                    "httpMethod": "POST",
                    "responseData": "allEntries",
                    "responseMode": "lastNode",
                    "alwaysOutputData": true
                  },
                  "purpose": "Set up a webhook to receive data from external services",
                  "displayName": "receive webhook",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_5",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                    "language": "javaScript"
                  },
                  "purpose": "Transform data structure using JavaScript",
                  "displayName": "transform data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_4",
                  "type": "nodes-base.emailSend",
                  "config": {
                    "text": "",
                    "onError": "continueRegularOutput",
                    "subject": "",
                    "toEmail": "",
                    "maxTries": 3,
                    "fromEmail": "",
                    "retryOnFail": true,
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "purpose": "Send an email notification",
                  "displayName": "send email",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_2",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                    "onError": "continueRegularOutput",
                    "language": "javaScript"
                  },
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "displayName": "process webhook data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_6",
                  "type": "nodes-base.slack",
                  "config": {
                    "text": "",
                    "channel": "",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "resource": "message",
                    "operation": "post",
                    "parameters": {},
                    "retryOnFail": true,
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Send a message to Slack channel",
                  "displayName": "send slack message",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_3",
                  "type": "nodes-base.httpRequest",
                  "config": {
                    "url": "",
                    "method": "GET",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "retryOnFail": true,
                    "sendHeaders": true,
                    "authentication": "genericCredentialType",
                    "genericAuthType": "headerAuth",
                    "alwaysOutputData": true,
                    "headerParameters": {
                      "parameters": [
                        {
                          "name": "",
                          "value": ""
                        }
                      ]
                    },
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Make an authenticated API request",
                  "displayName": "call api with auth",
                  "isPreConfigured": true
                },
                {
                  "id": "search_node_1",
                  "type": "nodes-base.zohoCrm",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                },
                {
                  "id": "search_node_2",
                  "type": "nodes-base.googleCalendar",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                },
                {
                  "id": "search_node_3",
                  "type": "nodes-base.segment",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                }
              ],
              "selected": [
                "task_node_1",
                "task_node_5",
                "task_node_4",
                "task_node_2",
                "task_node_6",
                "task_node_3",
                "search_node_1",
                "search_node_2",
                "search_node_3"
              ],
              "configured": {},
              "validated": {},
              "workflow": {
                "nodes": [],
                "settings": {},
                "connections": {}
              },
              "buildPhases": [],
              "operationHistory": [
                {
                  "node": {
                    "id": "task_node_1",
                    "type": "nodes-base.webhook",
                    "config": {
                      "path": "webhook",
                      "onError": "continueRegularOutput",
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode",
                      "alwaysOutputData": true
                    },
                    "purpose": "Set up a webhook to receive data from external services",
                    "displayName": "receive webhook",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_1",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_5",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    },
                    "purpose": "Transform data structure using JavaScript",
                    "displayName": "transform data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_5",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_4",
                    "type": "nodes-base.emailSend",
                    "config": {
                      "text": "",
                      "onError": "continueRegularOutput",
                      "subject": "",
                      "toEmail": "",
                      "maxTries": 3,
                      "fromEmail": "",
                      "retryOnFail": true,
                      "alwaysOutputData": true,
                      "waitBetweenTries": 3000
                    },
                    "purpose": "Send an email notification",
                    "displayName": "send email",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_4",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_2",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                      "onError": "continueRegularOutput",
                      "language": "javaScript"
                    },
                    "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                    "displayName": "process webhook data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_2",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_6",
                    "type": "nodes-base.slack",
                    "config": {
                      "text": "",
                      "channel": "",
                      "onError": "continueRegularOutput",
                      "maxTries": 2,
                      "resource": "message",
                      "operation": "post",
                      "parameters": {},
                      "retryOnFail": true,
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Send a message to Slack channel",
                    "displayName": "send slack message",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_6",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_3",
                    "type": "nodes-base.httpRequest",
                    "config": {
                      "url": "",
                      "method": "GET",
                      "onError": "continueErrorOutput",
                      "maxTries": 3,
                      "retryOnFail": true,
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "alwaysOutputData": true,
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ]
                      },
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Make an authenticated API request",
                    "displayName": "call api with auth",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_1",
                    "type": "nodes-base.zohoCrm",
                    "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_1",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_2",
                    "type": "nodes-base.googleCalendar",
                    "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_2",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_3",
                    "type": "nodes-base.segment",
                    "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "completePhase",
                  "phase": "discovery",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "setPhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:55.179Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "path": "customer-signup",
                      "options": {
                        "rawBody": false,
                        "noResponseBody": false
                      },
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode"
                    },
                    "typeVersion": "1",
                    "alwaysOutputData": true
                  },
                  "nodeId": "task_node_1",
                  "purpose": "Set up a webhook to receive data from external services",
                  "nodeType": "nodes-base.webhook",
                  "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
                  "timestamp": "2025-08-11T20:22:55.457Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.694Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                    "parameters": {
                      "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    }
                  },
                  "nodeId": "task_node_5",
                  "purpose": "Transform data structure using JavaScript",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
                  "timestamp": "2025-08-11T20:22:55.694Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_5",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.939Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "parameters": {
                      "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                      "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                      "toEmail": "{{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "nodeId": "task_node_4",
                  "purpose": "Send an email notification",
                  "nodeType": "nodes-base.emailSend",
                  "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
                  "timestamp": "2025-08-11T20:22:55.939Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_4",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.169Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                      "language": "javaScript"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "task_node_2",
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
                  "timestamp": "2025-08-11T20:22:56.169Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.384Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "parameters": {
                      "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                      "select": "channel",
                      "resource": "message",
                      "channelId": "#sales-escalations",
                      "operation": "post",
                      "parameters": {}
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_6",
                  "purpose": "Send a message to Slack channel",
                  "nodeType": "nodes-base.slack",
                  "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
                  "timestamp": "2025-08-11T20:22:56.384Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_6",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.635Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                      "method": "GET",
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "Authorization",
                            "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                          }
                        ]
                      }
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_3",
                  "purpose": "Make an authenticated API request",
                  "nodeType": "nodes-base.httpRequest",
                  "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
                  "timestamp": "2025-08-11T20:22:56.635Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.793Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                      "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                      "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                      "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                      "resource": "lead",
                      "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                      "operation": "create",
                      "leadSource": "Website Signup",
                      "leadStatus": "New Lead",
                      "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                      "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_1",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
                  "nodeType": "nodes-base.zohoCrm",
                  "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:56.793Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.034Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                    "parameters": {
                      "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                      "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                      "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                      "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                      "resource": "event",
                      "operation": "create",
                      "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                    },
                    "typeVersion": "1.3"
                  },
                  "nodeId": "search_node_2",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
                  "nodeType": "nodes-base.googleCalendar",
                  "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.034Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.270Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                    "parameters": {
                      "event": "{{ $json.eventName || 'engagement_event' }}",
                      "traits": {
                        "phone": "{{ $json.phone }}",
                        "title": "{{ $json.title }}",
                        "company": "{{ $json.company }}",
                        "industry": "{{ $json.industry }}",
                        "lead_status": "{{ $json.leadStatus }}",
                        "company_size": "{{ $json.companySize }}",
                        "last_engagement": "{{ $now }}"
                      },
                      "userId": "{{ $json.userId || $json.email }}",
                      "resource": "track",
                      "operation": "event",
                      "properties": {
                        "value": "{{ $json.value }}",
                        "action": "{{ $json.action }}",
                        "source": "onboarding_workflow",
                        "channel": "{{ $json.channel }}",
                        "industry": "{{ $json.industry }}",
                        "timestamp": "{{ $now }}",
                        "company_size": "{{ $json.companySize }}",
                        "engagement_level": "{{ $json.engagementLevel }}",
                        "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                      }
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_3",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
                  "nodeType": "nodes-base.segment",
                  "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.270Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "completePhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:57.511Z"
                }
              ],
              "pendingClarifications": [],
              "clarificationHistory": []
            },
            "new": {
              "phase": "validation",
              "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
              "discovered": [
                {
                  "id": "task_node_1",
                  "type": "nodes-base.webhook",
                  "config": {
                    "path": "webhook",
                    "onError": "continueRegularOutput",
                    "httpMethod": "POST",
                    "responseData": "allEntries",
                    "responseMode": "lastNode",
                    "alwaysOutputData": true
                  },
                  "purpose": "Set up a webhook to receive data from external services",
                  "displayName": "receive webhook",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_5",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                    "language": "javaScript"
                  },
                  "purpose": "Transform data structure using JavaScript",
                  "displayName": "transform data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_4",
                  "type": "nodes-base.emailSend",
                  "config": {
                    "text": "",
                    "onError": "continueRegularOutput",
                    "subject": "",
                    "toEmail": "",
                    "maxTries": 3,
                    "fromEmail": "",
                    "retryOnFail": true,
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "purpose": "Send an email notification",
                  "displayName": "send email",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_2",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                    "onError": "continueRegularOutput",
                    "language": "javaScript"
                  },
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "displayName": "process webhook data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_6",
                  "type": "nodes-base.slack",
                  "config": {
                    "text": "",
                    "channel": "",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "resource": "message",
                    "operation": "post",
                    "parameters": {},
                    "retryOnFail": true,
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Send a message to Slack channel",
                  "displayName": "send slack message",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_3",
                  "type": "nodes-base.httpRequest",
                  "config": {
                    "url": "",
                    "method": "GET",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "retryOnFail": true,
                    "sendHeaders": true,
                    "authentication": "genericCredentialType",
                    "genericAuthType": "headerAuth",
                    "alwaysOutputData": true,
                    "headerParameters": {
                      "parameters": [
                        {
                          "name": "",
                          "value": ""
                        }
                      ]
                    },
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Make an authenticated API request",
                  "displayName": "call api with auth",
                  "isPreConfigured": true
                },
                {
                  "id": "search_node_1",
                  "type": "nodes-base.zohoCrm",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                },
                {
                  "id": "search_node_2",
                  "type": "nodes-base.googleCalendar",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                },
                {
                  "id": "search_node_3",
                  "type": "nodes-base.segment",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                }
              ],
              "selected": [
                "task_node_1",
                "task_node_5",
                "task_node_4",
                "task_node_2",
                "task_node_6",
                "task_node_3",
                "search_node_1",
                "search_node_2",
                "search_node_3"
              ],
              "configured": {},
              "validated": {},
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.1
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                      "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                      "options": {},
                      "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 1
                  }
                ],
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "buildPhases": [
                {
                  "type": "trigger",
                  "nodeIds": [
                    "webhook_1"
                  ],
                  "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_1"
                  ],
                  "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                },
                {
                  "type": "data_collection",
                  "nodeIds": [
                    "httpRequest_1"
                  ],
                  "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_2"
                  ],
                  "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                },
                {
                  "type": "notification",
                  "nodeIds": [
                    "emailSend_1",
                    "segment_1"
                  ],
                  "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                },
                {
                  "type": "storage",
                  "nodeIds": [
                    "zohoCrm_1"
                  ],
                  "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                },
                {
                  "type": "integration",
                  "nodeIds": [
                    "googleCalendar_1",
                    "slack_1"
                  ],
                  "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                }
              ],
              "operationHistory": [
                {
                  "node": {
                    "id": "task_node_1",
                    "type": "nodes-base.webhook",
                    "config": {
                      "path": "webhook",
                      "onError": "continueRegularOutput",
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode",
                      "alwaysOutputData": true
                    },
                    "purpose": "Set up a webhook to receive data from external services",
                    "displayName": "receive webhook",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_1",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_5",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    },
                    "purpose": "Transform data structure using JavaScript",
                    "displayName": "transform data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_5",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_4",
                    "type": "nodes-base.emailSend",
                    "config": {
                      "text": "",
                      "onError": "continueRegularOutput",
                      "subject": "",
                      "toEmail": "",
                      "maxTries": 3,
                      "fromEmail": "",
                      "retryOnFail": true,
                      "alwaysOutputData": true,
                      "waitBetweenTries": 3000
                    },
                    "purpose": "Send an email notification",
                    "displayName": "send email",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_4",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_2",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                      "onError": "continueRegularOutput",
                      "language": "javaScript"
                    },
                    "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                    "displayName": "process webhook data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_2",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_6",
                    "type": "nodes-base.slack",
                    "config": {
                      "text": "",
                      "channel": "",
                      "onError": "continueRegularOutput",
                      "maxTries": 2,
                      "resource": "message",
                      "operation": "post",
                      "parameters": {},
                      "retryOnFail": true,
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Send a message to Slack channel",
                    "displayName": "send slack message",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_6",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_3",
                    "type": "nodes-base.httpRequest",
                    "config": {
                      "url": "",
                      "method": "GET",
                      "onError": "continueErrorOutput",
                      "maxTries": 3,
                      "retryOnFail": true,
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "alwaysOutputData": true,
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ]
                      },
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Make an authenticated API request",
                    "displayName": "call api with auth",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_1",
                    "type": "nodes-base.zohoCrm",
                    "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_1",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_2",
                    "type": "nodes-base.googleCalendar",
                    "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_2",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_3",
                    "type": "nodes-base.segment",
                    "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "completePhase",
                  "phase": "discovery",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "setPhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:55.179Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "path": "customer-signup",
                      "options": {
                        "rawBody": false,
                        "noResponseBody": false
                      },
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode"
                    },
                    "typeVersion": "1",
                    "alwaysOutputData": true
                  },
                  "nodeId": "task_node_1",
                  "purpose": "Set up a webhook to receive data from external services",
                  "nodeType": "nodes-base.webhook",
                  "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
                  "timestamp": "2025-08-11T20:22:55.457Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.694Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                    "parameters": {
                      "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    }
                  },
                  "nodeId": "task_node_5",
                  "purpose": "Transform data structure using JavaScript",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
                  "timestamp": "2025-08-11T20:22:55.694Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_5",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.939Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "parameters": {
                      "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                      "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                      "toEmail": "{{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "nodeId": "task_node_4",
                  "purpose": "Send an email notification",
                  "nodeType": "nodes-base.emailSend",
                  "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
                  "timestamp": "2025-08-11T20:22:55.939Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_4",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.169Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                      "language": "javaScript"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "task_node_2",
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
                  "timestamp": "2025-08-11T20:22:56.169Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.384Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "parameters": {
                      "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                      "select": "channel",
                      "resource": "message",
                      "channelId": "#sales-escalations",
                      "operation": "post",
                      "parameters": {}
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_6",
                  "purpose": "Send a message to Slack channel",
                  "nodeType": "nodes-base.slack",
                  "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
                  "timestamp": "2025-08-11T20:22:56.384Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_6",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.635Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                      "method": "GET",
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "Authorization",
                            "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                          }
                        ]
                      }
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_3",
                  "purpose": "Make an authenticated API request",
                  "nodeType": "nodes-base.httpRequest",
                  "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
                  "timestamp": "2025-08-11T20:22:56.635Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.793Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                      "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                      "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                      "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                      "resource": "lead",
                      "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                      "operation": "create",
                      "leadSource": "Website Signup",
                      "leadStatus": "New Lead",
                      "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                      "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_1",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
                  "nodeType": "nodes-base.zohoCrm",
                  "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:56.793Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.034Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                    "parameters": {
                      "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                      "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                      "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                      "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                      "resource": "event",
                      "operation": "create",
                      "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                    },
                    "typeVersion": "1.3"
                  },
                  "nodeId": "search_node_2",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
                  "nodeType": "nodes-base.googleCalendar",
                  "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.034Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.270Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                    "parameters": {
                      "event": "{{ $json.eventName || 'engagement_event' }}",
                      "traits": {
                        "phone": "{{ $json.phone }}",
                        "title": "{{ $json.title }}",
                        "company": "{{ $json.company }}",
                        "industry": "{{ $json.industry }}",
                        "lead_status": "{{ $json.leadStatus }}",
                        "company_size": "{{ $json.companySize }}",
                        "last_engagement": "{{ $now }}"
                      },
                      "userId": "{{ $json.userId || $json.email }}",
                      "resource": "track",
                      "operation": "event",
                      "properties": {
                        "value": "{{ $json.value }}",
                        "action": "{{ $json.action }}",
                        "source": "onboarding_workflow",
                        "channel": "{{ $json.channel }}",
                        "industry": "{{ $json.industry }}",
                        "timestamp": "{{ $now }}",
                        "company_size": "{{ $json.companySize }}",
                        "engagement_level": "{{ $json.engagementLevel }}",
                        "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                      }
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_3",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
                  "nodeType": "nodes-base.segment",
                  "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.270Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "completePhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "setPhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.196Z"
                },
                {
                  "type": "setWorkflow",
                  "workflow": {
                    "name": "Intelligent Customer Onboarding Workflow",
                    "nodes": [
                      {
                        "id": "webhook_1",
                        "name": "Customer Signup Webhook",
                        "type": "n8n-nodes-base.webhook",
                        "onError": "stopWorkflow",
                        "position": [
                          250,
                          300
                        ],
                        "parameters": {
                          "path": "customer-signup",
                          "options": {},
                          "httpMethod": "POST",
                          "responseMode": "responseNode"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "code_1",
                        "name": "Process Signup Data",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          550,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "httpRequest_1",
                        "name": "Fetch Company Data",
                        "type": "n8n-nodes-base.httpRequest",
                        "onError": "continueErrorOutput",
                        "maxTries": 3,
                        "position": [
                          850,
                          300
                        ],
                        "parameters": {
                          "url": "https://api.clearbit.com/v2/companies/find",
                          "options": {
                            "retry": {
                              "enabled": true,
                              "maxTries": 3
                            },
                            "timeout": 10000
                          },
                          "sendQuery": true,
                          "authentication": "predefinedCredentialType",
                          "queryParameters": {
                            "parameters": [
                              {
                                "name": "domain",
                                "value": "={{ $json.enrichmentQuery.domain }}"
                              }
                            ]
                          },
                          "nodeCredentialType": "clearbitApi"
                        },
                        "retryOnFail": true,
                        "typeVersion": 4.1
                      },
                      {
                        "id": "code_2",
                        "name": "Analyze Company Profile",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          1150,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "emailSend_1",
                        "name": "Send Personalized Welcome Email",
                        "type": "n8n-nodes-base.emailSend",
                        "onError": "continueRegularOutput",
                        "maxTries": 3,
                        "position": [
                          1450,
                          200
                        ],
                        "parameters": {
                          "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                          "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                          "options": {},
                          "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                          "toEmail": "={{ $json.email }}",
                          "fromEmail": "onboarding@company.com"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "segment_1",
                        "name": "Track Signup Event",
                        "type": "n8n-nodes-base.segment",
                        "onError": "continueRegularOutput",
                        "position": [
                          1450,
                          400
                        ],
                        "parameters": {
                          "event": "Customer Signed Up",
                          "traits": {
                            "tier": "={{ $json.companyProfile.tier }}",
                            "email": "={{ $json.email }}",
                            "company": "={{ $json.company }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "lastName": "={{ $json.lastName }}",
                            "firstName": "={{ $json.firstName }}",
                            "leadScore": "={{ $json.leadScore }}",
                            "companySize": "={{ $json.companyProfile.size }}"
                          },
                          "userId": "={{ $json.email }}",
                          "properties": {
                            "source": "={{ $json.source }}",
                            "demoType": "={{ $json.companyProfile.demoType }}",
                            "signupDate": "={{ $json.signupDate }}",
                            "isHighValue": "={{ $json.isHighValue }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "zohoCrm_1",
                        "name": "Create CRM Lead",
                        "type": "n8n-nodes-base.zohoCrm",
                        "onError": "continueRegularOutput",
                        "position": [
                          1750,
                          300
                        ],
                        "parameters": {
                          "email": "={{ $json.email }}",
                          "phone": "={{ $json.phone }}",
                          "module": "lead",
                          "company": "={{ $json.company }}",
                          "lastName": "={{ $json.lastName }}",
                          "firstName": "={{ $json.firstName }}",
                          "operation": "create",
                          "additionalFields": {
                            "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "leadSource": "Website Signup",
                            "leadStatus": "New",
                            "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "googleCalendar_1",
                        "name": "Schedule Demo Call",
                        "type": "n8n-nodes-base.googleCalendar",
                        "onError": "continueRegularOutput",
                        "position": [
                          2050,
                          200
                        ],
                        "parameters": {
                          "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                          "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                          "options": {
                            "sendNotifications": true
                          },
                          "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                          "attendees": "={{ $json.email }}",
                          "operation": "create",
                          "calendarId": "primary",
                          "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "slack_1",
                        "name": "Notify Sales Team",
                        "type": "n8n-nodes-base.slack",
                        "onError": "continueRegularOutput",
                        "maxTries": 2,
                        "position": [
                          2050,
                          400
                        ],
                        "parameters": {
                          "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                          "channel": "#sales-alerts",
                          "otherOptions": {
                            "includeLinkToWorkflow": true
                          }
                        },
                        "executeOnce": true,
                        "typeVersion": 1
                      }
                    ],
                    "settings": {
                      "executionOrder": "v1",
                      "saveManualExecutions": true,
                      "saveDataErrorExecution": "all",
                      "saveDataSuccessExecution": "all"
                    },
                    "connections": {
                      "Create CRM Lead": {
                        "main": [
                          [
                            {
                              "node": "Schedule Demo Call",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Notify Sales Team",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Fetch Company Data": {
                        "main": [
                          [
                            {
                              "node": "Analyze Company Profile",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Process Signup Data": {
                        "main": [
                          [
                            {
                              "node": "Fetch Company Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Analyze Company Profile": {
                        "main": [
                          [
                            {
                              "node": "Send Personalized Welcome Email",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Track Signup Event",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Create CRM Lead",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Customer Signup Webhook": {
                        "main": [
                          [
                            {
                              "node": "Process Signup Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      }
                    }
                  },
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "setBuildPhases",
                  "phases": [
                    {
                      "type": "trigger",
                      "nodeIds": [
                        "webhook_1"
                      ],
                      "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_1"
                      ],
                      "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                    },
                    {
                      "type": "data_collection",
                      "nodeIds": [
                        "httpRequest_1"
                      ],
                      "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_2"
                      ],
                      "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                    },
                    {
                      "type": "notification",
                      "nodeIds": [
                        "emailSend_1",
                        "segment_1"
                      ],
                      "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                    },
                    {
                      "type": "storage",
                      "nodeIds": [
                        "zohoCrm_1"
                      ],
                      "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                    },
                    {
                      "type": "integration",
                      "nodeIds": [
                        "googleCalendar_1",
                        "slack_1"
                      ],
                      "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                    }
                  ],
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "completePhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.469Z"
                }
              ],
              "pendingClarifications": [],
              "clarificationHistory": []
            }
          }
        },
        "removed": [],
        "unchanged": [
          "sessionId",
          "createdAt"
        ]
      }
    },
    "validation": {
      "name": "Validation",
      "success": true,
      "metrics": {
        "startTime": 1754943833906,
        "endTime": 1754943869215,
        "duration": 35309,
        "memoryUsage": {
          "heapUsed": -429240,
          "heapTotal": 39026688,
          "external": 7762783
        }
      },
      "logs": [
        {
          "timestamp": "2025-08-11T20:23:53.906Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Starting validation phase"
        },
        {
          "timestamp": "2025-08-11T20:23:53.906Z",
          "level": "DEBUG",
          "source": "Claude",
          "message": "Sending request for validation phase"
        },
        {
          "timestamp": "2025-08-11T20:23:53.907Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_workflow"
        },
        {
          "timestamp": "2025-08-11T20:23:53.907Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"workflow\":{\"name\":\"Intelligent Customer Onboarding Workflow\",\"nodes\":[{\"id\":\"webhook_1\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[250,300],\"parameters\":{\"httpMethod\":\"POST\",\"path\":\"customer-signup\",\"responseMode\":\"responseNode\",\"options\":{}},\"name\":\"Customer Signup Webhook\",\"typeVersion\":1,\"onError\":\"stopWorkflow\"},{\"id\":\"code_1\",\"type\":\"n8n-nodes-base.code\",\"position\":[550,300],\"parameters\":{\"jsCode\":\"// Process customer signup webhook data and extract key information for intelligent onboarding workflow\\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\\n\\nconst signupData = $input.all()[0].json;\\n\\n// Extract and validate customer information\\nconst customer = {\\n  email: signupData.email,\\n  firstName: signupData.firstName || signupData.first_name,\\n  lastName: signupData.lastName || signupData.last_name,\\n  company: signupData.company || signupData.companyName,\\n  phone: signupData.phone,\\n  website: signupData.website,\\n  signupDate: new Date().toISOString(),\\n  source: signupData.source || 'website'\\n};\\n\\n// Prepare data for company enrichment API\\nconst enrichmentQuery = {\\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\\n  company: customer.company,\\n  email: customer.email\\n};\\n\\nreturn [{\\n  json: {\\n    ...customer,\\n    enrichmentQuery,\\n    workflowId: $workflow.id,\\n    executionId: $execution.id\\n  }\\n}];\"},\"name\":\"Process Signup Data\",\"typeVersion\":2,\"onError\":\"continueRegularOutput\"},{\"id\":\"httpRequest_1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[850,300],\"parameters\":{\"url\":\"https://api.clearbit.com/v2/companies/find\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"clearbitApi\",\"sendQuery\":true,\"queryParameters\":{\"parameters\":[{\"name\":\"domain\",\"value\":\"={{ $json.enrichmentQuery.domain }}\"}]},\"options\":{\"timeout\":10000,\"retry\":{\"enabled\":true,\"maxTries\":3}}},\"name\":\"Fetch Company Data\",\"typeVersion\":4.1,\"onError\":\"continueErrorOutput\",\"retryOnFail\":true,\"maxTries\":3},{\"id\":\"code_2\",\"type\":\"n8n-nodes-base.code\",\"position\":[1150,300],\"parameters\":{\"jsCode\":\"// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\\n\\nconst customerData = $('Process Signup Data').first().json;\\nconst companyData = $input.first().json;\\n\\n// Analyze company size and industry\\nlet companyProfile = {\\n  size: 'unknown',\\n  industry: 'unknown',\\n  tier: 'standard',\\n  priority: 'medium',\\n  demoType: 'standard'\\n};\\n\\nif (companyData && !companyData.error) {\\n  // Determine company size\\n  const employees = companyData.metrics?.employees || 0;\\n  if (employees > 1000) {\\n    companyProfile.size = 'enterprise';\\n    companyProfile.tier = 'enterprise';\\n    companyProfile.priority = 'high';\\n    companyProfile.demoType = 'executive';\\n  } else if (employees > 100) {\\n    companyProfile.size = 'medium';\\n    companyProfile.tier = 'business';\\n    companyProfile.priority = 'medium';\\n    companyProfile.demoType = 'business';\\n  } else if (employees > 10) {\\n    companyProfile.size = 'small';\\n    companyProfile.tier = 'professional';\\n    companyProfile.priority = 'medium';\\n    companyProfile.demoType = 'standard';\\n  } else {\\n    companyProfile.size = 'startup';\\n    companyProfile.tier = 'starter';\\n    companyProfile.priority = 'low';\\n    companyProfile.demoType = 'self-service';\\n  }\\n\\n  // Extract industry\\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\\n}\\n\\n// Determine if high-value prospect\\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\\n\\n// Calculate lead score\\nlet leadScore = 50; // Base score\\nif (companyProfile.size === 'enterprise') leadScore += 40;\\nelse if (companyProfile.size === 'medium') leadScore += 25;\\nelse if (companyProfile.size === 'small') leadScore += 10;\\n\\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\\n\\nreturn [{\\n  json: {\\n    ...customerData,\\n    companyProfile,\\n    companyData: companyData || {},\\n    isHighValue,\\n    leadScore,\\n    personalizedContent: {\\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\\n      followUpSequence: companyProfile.tier\\n    }\\n  }\\n}];\"},\"name\":\"Analyze Company Profile\",\"typeVersion\":2,\"onError\":\"continueRegularOutput\"},{\"id\":\"emailSend_1\",\"type\":\"n8n-nodes-base.emailSend\",\"position\":[1450,200],\"parameters\":{\"fromEmail\":\"onboarding@company.com\",\"toEmail\":\"={{ $json.email }}\",\"subject\":\"Welcome to [Product] - Let's get {{ $json.company }} started!\",\"text\":\"Hi {{ $json.firstName }},\\n\\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\\n\\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\\n\\nWhat's next:\\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\\n2. You'll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team\",\"html\":\"<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>\",\"options\":{}},\"name\":\"Send Personalized Welcome Email\",\"typeVersion\":2,\"onError\":\"continueRegularOutput\",\"maxTries\":3},{\"id\":\"segment_1\",\"type\":\"n8n-nodes-base.segment\",\"position\":[1450,400],\"parameters\":{\"userId\":\"={{ $json.email }}\",\"event\":\"Customer Signed Up\",\"traits\":{\"email\":\"={{ $json.email }}\",\"firstName\":\"={{ $json.firstName }}\",\"lastName\":\"={{ $json.lastName }}\",\"company\":\"={{ $json.company }}\",\"companySize\":\"={{ $json.companyProfile.size }}\",\"industry\":\"={{ $json.companyProfile.industry }}\",\"tier\":\"={{ $json.companyProfile.tier }}\",\"leadScore\":\"={{ $json.leadScore }}\"},\"properties\":{\"source\":\"={{ $json.source }}\",\"signupDate\":\"={{ $json.signupDate }}\",\"isHighValue\":\"={{ $json.isHighValue }}\",\"demoType\":\"={{ $json.companyProfile.demoType }}\"}},\"name\":\"Track Signup Event\",\"typeVersion\":1,\"onError\":\"continueRegularOutput\"},{\"id\":\"zohoCrm_1\",\"type\":\"n8n-nodes-base.zohoCrm\",\"position\":[1750,300],\"parameters\":{\"operation\":\"create\",\"module\":\"lead\",\"email\":\"={{ $json.email }}\",\"phone\":\"={{ $json.phone }}\",\"firstName\":\"={{ $json.firstName }}\",\"lastName\":\"={{ $json.lastName }}\",\"company\":\"={{ $json.company }}\",\"additionalFields\":{\"leadSource\":\"Website Signup\",\"industry\":\"={{ $json.companyProfile.industry }}\",\"leadStatus\":\"New\",\"rating\":\"={{ $json.isHighValue ? 'Hot' : 'Warm' }}\",\"description\":\"Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}\"}},\"name\":\"Create CRM Lead\",\"typeVersion\":1,\"onError\":\"continueRegularOutput\"},{\"id\":\"googleCalendar_1\",\"type\":\"n8n-nodes-base.googleCalendar\",\"position\":[2050,200],\"parameters\":{\"operation\":\"create\",\"calendarId\":\"primary\",\"start\":\"={{ DateTime.now().plus({ days: 2 }).toISO() }}\",\"end\":\"={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}\",\"summary\":\"Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})\",\"description\":\"Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\\n\\nCompany Profile:\\n- Size: {{ $json.companyProfile.size }}\\n- Industry: {{ $json.companyProfile.industry }}\\n- Lead Score: {{ $json.leadScore }}\\n- Demo Type: {{ $json.companyProfile.demoType }}\\n\\nContact: {{ $json.email }}\",\"attendees\":\"={{ $json.email }}\",\"options\":{\"sendNotifications\":true}},\"name\":\"Schedule Demo Call\",\"typeVersion\":1,\"onError\":\"continueRegularOutput\"},{\"id\":\"slack_1\",\"type\":\"n8n-nodes-base.slack\",\"position\":[2050,400],\"parameters\":{\"channel\":\"#sales-alerts\",\"text\":\"🚨 High-Value Prospect Alert!\\n\\n*{{ $json.company }}* just signed up!\\n\\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\\n📊 Lead Score: {{ $json.leadScore }}/100\\n🎯 Tier: {{ $json.companyProfile.tier }}\\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\\n\\n*Action Required:* Review lead in CRM and prepare for demo call.\",\"otherOptions\":{\"includeLinkToWorkflow\":true}},\"name\":\"Notify Sales Team\",\"typeVersion\":1,\"onError\":\"continueRegularOutput\",\"maxTries\":2,\"executeOnce\":true}],\"connections\":{\"Customer Signup Webhook\":{\"main\":[[{\"node\":\"Process Signup Data\",\"type\":\"main\",\"index\":0}]]},\"Process Signup Data\":{\"main\":[[{\"node\":\"Fetch Company Data\",\"type\":\"main\",\"index\":0}]]},\"Fetch Company Data\":{\"main\":[[{\"node\":\"Analyze Company Profile\",\"type\":\"main\",\"index\":0}]]},\"Analyze Company Profile\":{\"main\":[[{\"node\":\"Send Personalized Welcome Email\",\"type\":\"main\",\"index\":0},{\"node\":\"Track Signup Event\",\"type\":\"main\",\"index\":0},{\"node\":\"Create CRM Lead\",\"type\":\"main\",\"index\":0}]]},\"Create CRM Lead\":{\"main\":[[{\"node\":\"Schedule Demo Call\",\"type\":\"main\",\"index\":0},{\"node\":\"Notify Sales Team\",\"type\":\"main\",\"index\":0}]]}},\"settings\":{\"executionOrder\":\"v1\",\"saveDataSuccessExecution\":\"all\",\"saveDataErrorExecution\":\"all\",\"saveManualExecutions\":true}},\"options\":{\"validateNodes\":true,\"validateConnections\":true,\"validateExpressions\":true,\"profile\":\"runtime\"}}"
        },
        {
          "timestamp": "2025-08-11T20:23:54.260Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_workflow completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:24:16.097Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_workflow"
        },
        {
          "timestamp": "2025-08-11T20:24:16.097Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"workflow\":{\"name\":\"Intelligent Customer Onboarding Workflow\",\"nodes\":[{\"id\":\"webhook_1\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[250,300],\"parameters\":{\"httpMethod\":\"POST\",\"path\":\"customer-signup\",\"responseMode\":\"responseNode\",\"options\":{}},\"name\":\"Customer Signup Webhook\",\"typeVersion\":2,\"onError\":\"stopWorkflow\"},{\"id\":\"code_1\",\"type\":\"n8n-nodes-base.code\",\"position\":[550,300],\"parameters\":{\"jsCode\":\"// Process customer signup webhook data and extract key information for intelligent onboarding workflow\\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\\n\\nconst signupData = $input.all()[0].json;\\n\\n// Extract and validate customer information\\nconst customer = {\\n  email: signupData.email,\\n  firstName: signupData.firstName || signupData.first_name,\\n  lastName: signupData.lastName || signupData.last_name,\\n  company: signupData.company || signupData.companyName,\\n  phone: signupData.phone,\\n  website: signupData.website,\\n  signupDate: new Date().toISOString(),\\n  source: signupData.source || 'website'\\n};\\n\\n// Prepare data for company enrichment API\\nconst enrichmentQuery = {\\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\\n  company: customer.company,\\n  email: customer.email\\n};\\n\\nreturn [{\\n  json: {\\n    ...customer,\\n    enrichmentQuery,\\n    workflowId: $workflow.id,\\n    executionId: $execution.id\\n  }\\n}];\"},\"name\":\"Process Signup Data\",\"typeVersion\":2,\"onError\":\"continueRegularOutput\"},{\"id\":\"httpRequest_1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[850,300],\"parameters\":{\"url\":\"https://api.clearbit.com/v2/companies/find\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"clearbitApi\",\"sendQuery\":true,\"queryParameters\":{\"parameters\":[{\"name\":\"domain\",\"value\":\"={{ $json.enrichmentQuery.domain }}\"}]},\"options\":{\"timeout\":10000,\"retry\":{\"enabled\":true,\"maxTries\":3}}},\"name\":\"Fetch Company Data\",\"typeVersion\":4.2,\"onError\":\"continueErrorOutput\",\"retryOnFail\":true,\"maxTries\":3},{\"id\":\"code_2\",\"type\":\"n8n-nodes-base.code\",\"position\":[1150,300],\"parameters\":{\"jsCode\":\"// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\\n\\nconst customerData = $('Process Signup Data').first().json;\\nconst companyData = $input.first().json;\\n\\n// Analyze company size and industry\\nlet companyProfile = {\\n  size: 'unknown',\\n  industry: 'unknown',\\n  tier: 'standard',\\n  priority: 'medium',\\n  demoType: 'standard'\\n};\\n\\nif (companyData && !companyData.error) {\\n  // Determine company size\\n  const employees = companyData.metrics?.employees || 0;\\n  if (employees > 1000) {\\n    companyProfile.size = 'enterprise';\\n    companyProfile.tier = 'enterprise';\\n    companyProfile.priority = 'high';\\n    companyProfile.demoType = 'executive';\\n  } else if (employees > 100) {\\n    companyProfile.size = 'medium';\\n    companyProfile.tier = 'business';\\n    companyProfile.priority = 'medium';\\n    companyProfile.demoType = 'business';\\n  } else if (employees > 10) {\\n    companyProfile.size = 'small';\\n    companyProfile.tier = 'professional';\\n    companyProfile.priority = 'medium';\\n    companyProfile.demoType = 'standard';\\n  } else {\\n    companyProfile.size = 'startup';\\n    companyProfile.tier = 'starter';\\n    companyProfile.priority = 'low';\\n    companyProfile.demoType = 'self-service';\\n  }\\n\\n  // Extract industry\\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\\n}\\n\\n// Determine if high-value prospect\\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\\n\\n// Calculate lead score\\nlet leadScore = 50; // Base score\\nif (companyProfile.size === 'enterprise') leadScore += 40;\\nelse if (companyProfile.size === 'medium') leadScore += 25;\\nelse if (companyProfile.size === 'small') leadScore += 10;\\n\\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\\n\\nreturn [{\\n  json: {\\n    ...customerData,\\n    companyProfile,\\n    companyData: companyData || {},\\n    isHighValue,\\n    leadScore,\\n    personalizedContent: {\\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\\n      followUpSequence: companyProfile.tier\\n    }\\n  }\\n}];\"},\"name\":\"Analyze Company Profile\",\"typeVersion\":2,\"onError\":\"continueRegularOutput\"},{\"id\":\"emailSend_1\",\"type\":\"n8n-nodes-base.emailSend\",\"position\":[1450,200],\"parameters\":{\"fromEmail\":\"onboarding@company.com\",\"toEmail\":\"={{ $json.email }}\",\"subject\":\"{{ `Welcome to [Product] - Let's get ${$json.company} started!` }}\",\"text\":\"{{ `Hi ${$json.firstName},\\n\\nWelcome to [Product]! We're excited to help ${$json.company} achieve its goals.\\n\\nBased on your company profile (${$json.companyProfile.size} ${$json.companyProfile.industry} company), we've prepared a personalized onboarding experience for you.\\n\\nWhat's next:\\n1. We'll schedule a ${$json.personalizedContent.demoLength}-minute demo tailored to your needs\\n2. You'll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team` }}\",\"html\":\"{{ `<h2>Welcome to [Product]!</h2><p>Hi ${$json.firstName},</p><p>We're excited to help <strong>${$json.company}</strong> achieve its goals.</p><p>Based on your company profile (${$json.companyProfile.size} ${$json.companyProfile.industry} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>${$json.personalizedContent.demoLength}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>` }}\",\"options\":{}},\"name\":\"Send Personalized Welcome Email\",\"typeVersion\":2.1,\"onError\":\"continueRegularOutput\",\"maxTries\":3},{\"id\":\"segment_1\",\"type\":\"n8n-nodes-base.segment\",\"position\":[1450,400],\"parameters\":{\"userId\":\"={{ $json.email }}\",\"event\":\"Customer Signed Up\",\"traits\":{\"email\":\"={{ $json.email }}\",\"firstName\":\"={{ $json.firstName }}\",\"lastName\":\"={{ $json.lastName }}\",\"company\":\"={{ $json.company }}\",\"companySize\":\"={{ $json.companyProfile.size }}\",\"industry\":\"={{ $json.companyProfile.industry }}\",\"tier\":\"={{ $json.companyProfile.tier }}\",\"leadScore\":\"={{ $json.leadScore }}\"},\"properties\":{\"source\":\"={{ $json.source }}\",\"signupDate\":\"={{ $json.signupDate }}\",\"isHighValue\":\"={{ $json.isHighValue }}\",\"demoType\":\"={{ $json.companyProfile.demoType }}\"}},\"name\":\"Track Signup Event\",\"typeVersion\":1,\"onError\":\"continueRegularOutput\"},{\"id\":\"zohoCrm_1\",\"type\":\"n8n-nodes-base.zohoCrm\",\"position\":[1750,300],\"parameters\":{\"operation\":\"create\",\"module\":\"lead\",\"email\":\"={{ $json.email }}\",\"phone\":\"={{ $json.phone }}\",\"firstName\":\"={{ $json.firstName }}\",\"lastName\":\"={{ $json.lastName }}\",\"company\":\"={{ $json.company }}\",\"additionalFields\":{\"leadSource\":\"Website Signup\",\"industry\":\"={{ $json.companyProfile.industry }}\",\"leadStatus\":\"New\",\"rating\":\"={{ $json.isHighValue ? 'Hot' : 'Warm' }}\",\"description\":\"{{ `Lead Score: ${$json.leadScore}, Company Size: ${$json.companyProfile.size}, Tier: ${$json.companyProfile.tier}` }}\"}},\"name\":\"Create CRM Lead\",\"typeVersion\":1,\"onError\":\"continueRegularOutput\"},{\"id\":\"googleCalendar_1\",\"type\":\"n8n-nodes-base.googleCalendar\",\"position\":[2050,200],\"parameters\":{\"operation\":\"create\",\"calendarId\":\"primary\",\"start\":\"={{ DateTime.now().plus({ days: 2 }).toISO() }}\",\"end\":\"={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}\",\"summary\":\"{{ `Demo Call - ${$json.company} (${$json.companyProfile.size} ${$json.companyProfile.industry})` }}\",\"description\":\"{{ `Demo call with ${$json.firstName} ${$json.lastName} from ${$json.company}.\\n\\nCompany Profile:\\n- Size: ${$json.companyProfile.size}\\n- Industry: ${$json.companyProfile.industry}\\n- Lead Score: ${$json.leadScore}\\n- Demo Type: ${$json.companyProfile.demoType}\\n\\nContact: ${$json.email}` }}\",\"attendees\":\"={{ $json.email }}\",\"options\":{\"sendNotifications\":true}},\"name\":\"Schedule Demo Call\",\"typeVersion\":1.3,\"onError\":\"continueRegularOutput\"},{\"id\":\"slack_1\",\"type\":\"n8n-nodes-base.slack\",\"position\":[2050,400],\"parameters\":{\"channel\":\"#sales-alerts\",\"text\":\"{{ `🚨 High-Value Prospect Alert!\\n\\n*${$json.company}* just signed up!\\n\\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\\n📊 Lead Score: ${$json.leadScore}/100\\n🎯 Tier: ${$json.companyProfile.tier}\\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\\n\\n*Action Required:* Review lead in CRM and prepare for demo call.` }}\",\"otherOptions\":{\"includeLinkToWorkflow\":true}},\"name\":\"Notify Sales Team\",\"typeVersion\":2.3,\"onError\":\"continueRegularOutput\",\"maxTries\":2,\"executeOnce\":true}],\"connections\":{\"Customer Signup Webhook\":{\"main\":[[{\"node\":\"Process Signup Data\",\"type\":\"main\",\"index\":0}]]},\"Process Signup Data\":{\"main\":[[{\"node\":\"Fetch Company Data\",\"type\":\"main\",\"index\":0}]]},\"Fetch Company Data\":{\"main\":[[{\"node\":\"Analyze Company Profile\",\"type\":\"main\",\"index\":0}]]},\"Analyze Company Profile\":{\"main\":[[{\"node\":\"Send Personalized Welcome Email\",\"type\":\"main\",\"index\":0},{\"node\":\"Track Signup Event\",\"type\":\"main\",\"index\":0},{\"node\":\"Create CRM Lead\",\"type\":\"main\",\"index\":0}]]},\"Create CRM Lead\":{\"main\":[[{\"node\":\"Schedule Demo Call\",\"type\":\"main\",\"index\":0},{\"node\":\"Notify Sales Team\",\"type\":\"main\",\"index\":0}]]}},\"settings\":{\"executionOrder\":\"v1\",\"saveDataSuccessExecution\":\"all\",\"saveDataErrorExecution\":\"all\",\"saveManualExecutions\":true}},\"options\":{\"validateNodes\":true,\"validateConnections\":true,\"validateExpressions\":true,\"profile\":\"runtime\"}}"
        },
        {
          "timestamp": "2025-08-11T20:24:16.346Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_workflow completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:24:28.060Z",
          "level": "INFO",
          "source": "MCP",
          "message": "Calling tool: validate_workflow"
        },
        {
          "timestamp": "2025-08-11T20:24:28.060Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Parameters: {\"workflow\":{\"name\":\"Intelligent Customer Onboarding Workflow\",\"nodes\":[{\"id\":\"webhook_1\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[250,300],\"parameters\":{\"httpMethod\":\"POST\",\"path\":\"customer-signup\",\"responseMode\":\"responseNode\",\"options\":{}},\"name\":\"Customer Signup Webhook\",\"typeVersion\":2,\"onError\":\"stopWorkflow\"},{\"id\":\"code_1\",\"type\":\"n8n-nodes-base.code\",\"position\":[550,300],\"parameters\":{\"jsCode\":\"// Process customer signup webhook data and extract key information for intelligent onboarding workflow\\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\\n\\nconst signupData = $input.all()[0].json;\\n\\n// Extract and validate customer information\\nconst customer = {\\n  email: signupData.email,\\n  firstName: signupData.firstName || signupData.first_name,\\n  lastName: signupData.lastName || signupData.last_name,\\n  company: signupData.company || signupData.companyName,\\n  phone: signupData.phone,\\n  website: signupData.website,\\n  signupDate: new Date().toISOString(),\\n  source: signupData.source || 'website'\\n};\\n\\n// Prepare data for company enrichment API\\nconst enrichmentQuery = {\\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\\n  company: customer.company,\\n  email: customer.email\\n};\\n\\nreturn [{\\n  json: {\\n    ...customer,\\n    enrichmentQuery,\\n    workflowId: $workflow.id,\\n    executionId: $execution.id\\n  }\\n}];\"},\"name\":\"Process Signup Data\",\"typeVersion\":2,\"onError\":\"continueRegularOutput\"},{\"id\":\"httpRequest_1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[850,300],\"parameters\":{\"url\":\"https://api.clearbit.com/v2/companies/find\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"clearbitApi\",\"sendQuery\":true,\"queryParameters\":{\"parameters\":[{\"name\":\"domain\",\"value\":\"={{ $json.enrichmentQuery.domain }}\"}]},\"options\":{\"timeout\":10000,\"retry\":{\"enabled\":true,\"maxTries\":3}}},\"name\":\"Fetch Company Data\",\"typeVersion\":4.2,\"onError\":\"continueErrorOutput\",\"retryOnFail\":true,\"maxTries\":3},{\"id\":\"code_2\",\"type\":\"n8n-nodes-base.code\",\"position\":[1150,300],\"parameters\":{\"jsCode\":\"// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\\n\\nconst customerData = $('Process Signup Data').first().json;\\nconst companyData = $input.first().json;\\n\\n// Analyze company size and industry\\nlet companyProfile = {\\n  size: 'unknown',\\n  industry: 'unknown',\\n  tier: 'standard',\\n  priority: 'medium',\\n  demoType: 'standard'\\n};\\n\\nif (companyData && !companyData.error) {\\n  // Determine company size\\n  const employees = companyData.metrics?.employees || 0;\\n  if (employees > 1000) {\\n    companyProfile.size = 'enterprise';\\n    companyProfile.tier = 'enterprise';\\n    companyProfile.priority = 'high';\\n    companyProfile.demoType = 'executive';\\n  } else if (employees > 100) {\\n    companyProfile.size = 'medium';\\n    companyProfile.tier = 'business';\\n    companyProfile.priority = 'medium';\\n    companyProfile.demoType = 'business';\\n  } else if (employees > 10) {\\n    companyProfile.size = 'small';\\n    companyProfile.tier = 'professional';\\n    companyProfile.priority = 'medium';\\n    companyProfile.demoType = 'standard';\\n  } else {\\n    companyProfile.size = 'startup';\\n    companyProfile.tier = 'starter';\\n    companyProfile.priority = 'low';\\n    companyProfile.demoType = 'self-service';\\n  }\\n\\n  // Extract industry\\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\\n}\\n\\n// Determine if high-value prospect\\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\\n\\n// Calculate lead score\\nlet leadScore = 50; // Base score\\nif (companyProfile.size === 'enterprise') leadScore += 40;\\nelse if (companyProfile.size === 'medium') leadScore += 25;\\nelse if (companyProfile.size === 'small') leadScore += 10;\\n\\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\\n\\nreturn [{\\n  json: {\\n    ...customerData,\\n    companyProfile,\\n    companyData: companyData || {},\\n    isHighValue,\\n    leadScore,\\n    personalizedContent: {\\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\\n      followUpSequence: companyProfile.tier\\n    }\\n  }\\n}];\"},\"name\":\"Analyze Company Profile\",\"typeVersion\":2,\"onError\":\"continueRegularOutput\"},{\"id\":\"emailSend_1\",\"type\":\"n8n-nodes-base.emailSend\",\"position\":[1450,200],\"parameters\":{\"fromEmail\":\"onboarding@company.com\",\"toEmail\":\"={{ $json.email }}\",\"subject\":\"={{ 'Welcome to [Product] - Let\\\\'s get ' + $json.company + ' started!' }}\",\"text\":\"={{ 'Hi ' + $json.firstName + ',\\\\n\\\\nWelcome to [Product]! We\\\\'re excited to help ' + $json.company + ' achieve its goals.\\\\n\\\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\\\'ve prepared a personalized onboarding experience for you.\\\\n\\\\nWhat\\\\'s next:\\\\n1. We\\\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\\\n2. You\\\\'ll receive industry-specific resources\\\\n3. Our team will provide dedicated support\\\\n\\\\nBest regards,\\\\nThe Onboarding Team' }}\",\"html\":\"={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\\\'ve prepared a personalized onboarding experience.</p><h3>What\\\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}\",\"options\":{}},\"name\":\"Send Personalized Welcome Email\",\"typeVersion\":2.1,\"onError\":\"continueRegularOutput\",\"maxTries\":3},{\"id\":\"segment_1\",\"type\":\"n8n-nodes-base.segment\",\"position\":[1450,400],\"parameters\":{\"userId\":\"={{ $json.email }}\",\"event\":\"Customer Signed Up\",\"traits\":{\"email\":\"={{ $json.email }}\",\"firstName\":\"={{ $json.firstName }}\",\"lastName\":\"={{ $json.lastName }}\",\"company\":\"={{ $json.company }}\",\"companySize\":\"={{ $json.companyProfile.size }}\",\"industry\":\"={{ $json.companyProfile.industry }}\",\"tier\":\"={{ $json.companyProfile.tier }}\",\"leadScore\":\"={{ $json.leadScore }}\"},\"properties\":{\"source\":\"={{ $json.source }}\",\"signupDate\":\"={{ $json.signupDate }}\",\"isHighValue\":\"={{ $json.isHighValue }}\",\"demoType\":\"={{ $json.companyProfile.demoType }}\"}},\"name\":\"Track Signup Event\",\"typeVersion\":1,\"onError\":\"continueRegularOutput\"},{\"id\":\"zohoCrm_1\",\"type\":\"n8n-nodes-base.zohoCrm\",\"position\":[1750,300],\"parameters\":{\"operation\":\"create\",\"module\":\"lead\",\"email\":\"={{ $json.email }}\",\"phone\":\"={{ $json.phone }}\",\"firstName\":\"={{ $json.firstName }}\",\"lastName\":\"={{ $json.lastName }}\",\"company\":\"={{ $json.company }}\",\"additionalFields\":{\"leadSource\":\"Website Signup\",\"industry\":\"={{ $json.companyProfile.industry }}\",\"leadStatus\":\"New\",\"rating\":\"={{ $json.isHighValue ? 'Hot' : 'Warm' }}\",\"description\":\"={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}\"}},\"name\":\"Create CRM Lead\",\"typeVersion\":1,\"onError\":\"continueRegularOutput\"},{\"id\":\"googleCalendar_1\",\"type\":\"n8n-nodes-base.googleCalendar\",\"position\":[2050,200],\"parameters\":{\"operation\":\"create\",\"calendarId\":\"primary\",\"start\":\"={{ DateTime.now().plus({ days: 2 }).toISO() }}\",\"end\":\"={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}\",\"summary\":\"={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}\",\"description\":\"={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\\\n\\\\nCompany Profile:\\\\n- Size: ' + $json.companyProfile.size + '\\\\n- Industry: ' + $json.companyProfile.industry + '\\\\n- Lead Score: ' + $json.leadScore + '\\\\n- Demo Type: ' + $json.companyProfile.demoType + '\\\\n\\\\nContact: ' + $json.email }}\",\"attendees\":\"={{ $json.email }}\",\"options\":{\"sendNotifications\":true}},\"name\":\"Schedule Demo Call\",\"typeVersion\":1.3,\"onError\":\"continueRegularOutput\"},{\"id\":\"slack_1\",\"type\":\"n8n-nodes-base.slack\",\"position\":[2050,400],\"parameters\":{\"channel\":\"#sales-alerts\",\"text\":\"{{ `🚨 High-Value Prospect Alert!\\n\\n*${$json.company}* just signed up!\\n\\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\\n📊 Lead Score: ${$json.leadScore}/100\\n🎯 Tier: ${$json.companyProfile.tier}\\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\\n\\n*Action Required:* Review lead in CRM and prepare for demo call.` }}\",\"otherOptions\":{\"includeLinkToWorkflow\":true}},\"name\":\"Notify Sales Team\",\"typeVersion\":2.3,\"onError\":\"continueRegularOutput\",\"maxTries\":2,\"executeOnce\":true}],\"connections\":{\"Customer Signup Webhook\":{\"main\":[[{\"node\":\"Process Signup Data\",\"type\":\"main\",\"index\":0}]]},\"Process Signup Data\":{\"main\":[[{\"node\":\"Fetch Company Data\",\"type\":\"main\",\"index\":0}]]},\"Fetch Company Data\":{\"main\":[[{\"node\":\"Analyze Company Profile\",\"type\":\"main\",\"index\":0}]]},\"Analyze Company Profile\":{\"main\":[[{\"node\":\"Send Personalized Welcome Email\",\"type\":\"main\",\"index\":0},{\"node\":\"Track Signup Event\",\"type\":\"main\",\"index\":0},{\"node\":\"Create CRM Lead\",\"type\":\"main\",\"index\":0}]]},\"Create CRM Lead\":{\"main\":[[{\"node\":\"Schedule Demo Call\",\"type\":\"main\",\"index\":0},{\"node\":\"Notify Sales Team\",\"type\":\"main\",\"index\":0}]]}},\"settings\":{\"executionOrder\":\"v1\",\"saveDataSuccessExecution\":\"all\",\"saveDataErrorExecution\":\"all\",\"saveManualExecutions\":true}},\"options\":{\"validateNodes\":true,\"validateConnections\":true,\"validateExpressions\":true,\"profile\":\"runtime\"}}"
        },
        {
          "timestamp": "2025-08-11T20:24:28.261Z",
          "level": "DEBUG",
          "source": "MCP",
          "message": "Tool validate_workflow completed successfully"
        },
        {
          "timestamp": "2025-08-11T20:24:29.104Z",
          "level": "ERROR",
          "source": "Orchestrator",
          "message": "Error in validation: Error 1"
        },
        {
          "timestamp": "2025-08-11T20:24:29.104Z",
          "level": "ERROR",
          "source": "Orchestrator",
          "message": "Error in validation: Error 2"
        },
        {
          "timestamp": "2025-08-11T20:24:29.104Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Validation completed in 3 attempts"
        },
        {
          "timestamp": "2025-08-11T20:24:29.104Z",
          "level": "INFO",
          "source": "Tools",
          "message": "Applied 2 fixes"
        },
        {
          "timestamp": "2025-08-11T20:24:29.215Z",
          "level": "DEBUG",
          "source": "Orchestrator",
          "message": "Session state updated"
        },
        {
          "timestamp": "2025-08-11T20:24:29.215Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Data flow captured: 3 transformations"
        }
      ],
      "nodes": [],
      "sessionState": {
        "sessionId": "complete_e2e_user_test_1754943708795",
        "createdAt": "2025-08-11T20:21:49.129Z",
        "state": {
          "phase": "documentation",
          "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
          "discovered": [
            {
              "id": "task_node_1",
              "type": "nodes-base.webhook",
              "config": {
                "path": "webhook",
                "onError": "continueRegularOutput",
                "httpMethod": "POST",
                "responseData": "allEntries",
                "responseMode": "lastNode",
                "alwaysOutputData": true
              },
              "purpose": "Set up a webhook to receive data from external services",
              "displayName": "receive webhook",
              "isPreConfigured": true
            },
            {
              "id": "task_node_5",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                "language": "javaScript"
              },
              "purpose": "Transform data structure using JavaScript",
              "displayName": "transform data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_4",
              "type": "nodes-base.emailSend",
              "config": {
                "text": "",
                "onError": "continueRegularOutput",
                "subject": "",
                "toEmail": "",
                "maxTries": 3,
                "fromEmail": "",
                "retryOnFail": true,
                "alwaysOutputData": true,
                "waitBetweenTries": 3000
              },
              "purpose": "Send an email notification",
              "displayName": "send email",
              "isPreConfigured": true
            },
            {
              "id": "task_node_2",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                "onError": "continueRegularOutput",
                "language": "javaScript"
              },
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "displayName": "process webhook data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_6",
              "type": "nodes-base.slack",
              "config": {
                "text": "",
                "channel": "",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "resource": "message",
                "operation": "post",
                "parameters": {},
                "retryOnFail": true,
                "waitBetweenTries": 2000
              },
              "purpose": "Send a message to Slack channel",
              "displayName": "send slack message",
              "isPreConfigured": true
            },
            {
              "id": "task_node_3",
              "type": "nodes-base.httpRequest",
              "config": {
                "url": "",
                "method": "GET",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "retryOnFail": true,
                "sendHeaders": true,
                "authentication": "genericCredentialType",
                "genericAuthType": "headerAuth",
                "alwaysOutputData": true,
                "headerParameters": {
                  "parameters": [
                    {
                      "name": "",
                      "value": ""
                    }
                  ]
                },
                "waitBetweenTries": 2000
              },
              "purpose": "Make an authenticated API request",
              "displayName": "call api with auth",
              "isPreConfigured": true
            },
            {
              "id": "search_node_1",
              "type": "nodes-base.zohoCrm",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
            },
            {
              "id": "search_node_2",
              "type": "nodes-base.googleCalendar",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
            },
            {
              "id": "search_node_3",
              "type": "nodes-base.segment",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
            }
          ],
          "selected": [
            "task_node_1",
            "task_node_5",
            "task_node_4",
            "task_node_2",
            "task_node_6",
            "task_node_3",
            "search_node_1",
            "search_node_2",
            "search_node_3"
          ],
          "configured": {},
          "validated": {},
          "workflow": {
            "name": "Intelligent Customer Onboarding Workflow",
            "nodes": [
              {
                "id": "webhook_1",
                "name": "Customer Signup Webhook",
                "type": "n8n-nodes-base.webhook",
                "onError": "stopWorkflow",
                "position": [
                  250,
                  300
                ],
                "parameters": {
                  "path": "customer-signup",
                  "options": {},
                  "httpMethod": "POST",
                  "responseMode": "responseNode"
                },
                "typeVersion": 2
              },
              {
                "id": "code_1",
                "name": "Process Signup Data",
                "type": "n8n-nodes-base.code",
                "onError": "continueRegularOutput",
                "position": [
                  550,
                  300
                ],
                "parameters": {
                  "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                },
                "typeVersion": 2
              },
              {
                "id": "httpRequest_1",
                "name": "Fetch Company Data",
                "type": "n8n-nodes-base.httpRequest",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "position": [
                  850,
                  300
                ],
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find",
                  "options": {
                    "retry": {
                      "enabled": true,
                      "maxTries": 3
                    },
                    "timeout": 10000
                  },
                  "sendQuery": true,
                  "authentication": "predefinedCredentialType",
                  "queryParameters": {
                    "parameters": [
                      {
                        "name": "domain",
                        "value": "={{ $json.enrichmentQuery.domain }}"
                      }
                    ]
                  },
                  "nodeCredentialType": "clearbitApi"
                },
                "retryOnFail": true,
                "typeVersion": 4.2
              },
              {
                "id": "code_2",
                "name": "Analyze Company Profile",
                "type": "n8n-nodes-base.code",
                "onError": "continueRegularOutput",
                "position": [
                  1150,
                  300
                ],
                "parameters": {
                  "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                },
                "typeVersion": 2
              },
              {
                "id": "emailSend_1",
                "name": "Send Personalized Welcome Email",
                "type": "n8n-nodes-base.emailSend",
                "onError": "continueRegularOutput",
                "maxTries": 3,
                "position": [
                  1450,
                  200
                ],
                "parameters": {
                  "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                  "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                  "options": {},
                  "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                  "toEmail": "={{ $json.email }}",
                  "fromEmail": "onboarding@company.com"
                },
                "typeVersion": 2.1
              },
              {
                "id": "segment_1",
                "name": "Track Signup Event",
                "type": "n8n-nodes-base.segment",
                "onError": "continueRegularOutput",
                "position": [
                  1450,
                  400
                ],
                "parameters": {
                  "event": "Customer Signed Up",
                  "traits": {
                    "tier": "={{ $json.companyProfile.tier }}",
                    "email": "={{ $json.email }}",
                    "company": "={{ $json.company }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "lastName": "={{ $json.lastName }}",
                    "firstName": "={{ $json.firstName }}",
                    "leadScore": "={{ $json.leadScore }}",
                    "companySize": "={{ $json.companyProfile.size }}"
                  },
                  "userId": "={{ $json.email }}",
                  "properties": {
                    "source": "={{ $json.source }}",
                    "demoType": "={{ $json.companyProfile.demoType }}",
                    "signupDate": "={{ $json.signupDate }}",
                    "isHighValue": "={{ $json.isHighValue }}"
                  }
                },
                "typeVersion": 1
              },
              {
                "id": "zohoCrm_1",
                "name": "Create CRM Lead",
                "type": "n8n-nodes-base.zohoCrm",
                "onError": "continueRegularOutput",
                "position": [
                  1750,
                  300
                ],
                "parameters": {
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone }}",
                  "module": "lead",
                  "company": "={{ $json.company }}",
                  "lastName": "={{ $json.lastName }}",
                  "firstName": "={{ $json.firstName }}",
                  "operation": "create",
                  "additionalFields": {
                    "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "leadSource": "Website Signup",
                    "leadStatus": "New",
                    "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                  }
                },
                "typeVersion": 1
              },
              {
                "id": "googleCalendar_1",
                "name": "Schedule Demo Call",
                "type": "n8n-nodes-base.googleCalendar",
                "onError": "continueRegularOutput",
                "position": [
                  2050,
                  200
                ],
                "parameters": {
                  "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                  "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                  "options": {
                    "sendNotifications": true
                  },
                  "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                  "attendees": "={{ $json.email }}",
                  "operation": "create",
                  "calendarId": "primary",
                  "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                },
                "typeVersion": 1.3
              },
              {
                "id": "slack_1",
                "name": "Notify Sales Team",
                "type": "n8n-nodes-base.slack",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "position": [
                  2050,
                  400
                ],
                "parameters": {
                  "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                  "channel": "#sales-alerts",
                  "otherOptions": {
                    "includeLinkToWorkflow": true
                  }
                },
                "executeOnce": true,
                "typeVersion": 2.3
              }
            ],
            "valid": true,
            "settings": {
              "executionOrder": "v1",
              "saveManualExecutions": true,
              "saveDataErrorExecution": "all",
              "saveDataSuccessExecution": "all"
            },
            "connections": {
              "Create CRM Lead": {
                "main": [
                  [
                    {
                      "node": "Schedule Demo Call",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Notify Sales Team",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Fetch Company Data": {
                "main": [
                  [
                    {
                      "node": "Analyze Company Profile",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Process Signup Data": {
                "main": [
                  [
                    {
                      "node": "Fetch Company Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Analyze Company Profile": {
                "main": [
                  [
                    {
                      "node": "Send Personalized Welcome Email",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Track Signup Event",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Create CRM Lead",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Customer Signup Webhook": {
                "main": [
                  [
                    {
                      "node": "Process Signup Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              }
            }
          },
          "buildPhases": [
            {
              "type": "trigger",
              "nodeIds": [
                "webhook_1"
              ],
              "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
            },
            {
              "type": "data_processing",
              "nodeIds": [
                "code_1"
              ],
              "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
            },
            {
              "type": "data_collection",
              "nodeIds": [
                "httpRequest_1"
              ],
              "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
            },
            {
              "type": "data_processing",
              "nodeIds": [
                "code_2"
              ],
              "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
            },
            {
              "type": "notification",
              "nodeIds": [
                "emailSend_1",
                "segment_1"
              ],
              "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
            },
            {
              "type": "storage",
              "nodeIds": [
                "zohoCrm_1"
              ],
              "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
            },
            {
              "type": "integration",
              "nodeIds": [
                "googleCalendar_1",
                "slack_1"
              ],
              "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
            }
          ],
          "operationHistory": [
            {
              "node": {
                "id": "task_node_1",
                "type": "nodes-base.webhook",
                "config": {
                  "path": "webhook",
                  "onError": "continueRegularOutput",
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode",
                  "alwaysOutputData": true
                },
                "purpose": "Set up a webhook to receive data from external services",
                "displayName": "receive webhook",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_1",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_5",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                },
                "purpose": "Transform data structure using JavaScript",
                "displayName": "transform data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_5",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_4",
                "type": "nodes-base.emailSend",
                "config": {
                  "text": "",
                  "onError": "continueRegularOutput",
                  "subject": "",
                  "toEmail": "",
                  "maxTries": 3,
                  "fromEmail": "",
                  "retryOnFail": true,
                  "alwaysOutputData": true,
                  "waitBetweenTries": 3000
                },
                "purpose": "Send an email notification",
                "displayName": "send email",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_4",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_2",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                  "onError": "continueRegularOutput",
                  "language": "javaScript"
                },
                "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                "displayName": "process webhook data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_2",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_6",
                "type": "nodes-base.slack",
                "config": {
                  "text": "",
                  "channel": "",
                  "onError": "continueRegularOutput",
                  "maxTries": 2,
                  "resource": "message",
                  "operation": "post",
                  "parameters": {},
                  "retryOnFail": true,
                  "waitBetweenTries": 2000
                },
                "purpose": "Send a message to Slack channel",
                "displayName": "send slack message",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_6",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_3",
                "type": "nodes-base.httpRequest",
                "config": {
                  "url": "",
                  "method": "GET",
                  "onError": "continueErrorOutput",
                  "maxTries": 3,
                  "retryOnFail": true,
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "alwaysOutputData": true,
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "",
                        "value": ""
                      }
                    ]
                  },
                  "waitBetweenTries": 2000
                },
                "purpose": "Make an authenticated API request",
                "displayName": "call api with auth",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_1",
                "type": "nodes-base.zohoCrm",
                "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_1",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_2",
                "type": "nodes-base.googleCalendar",
                "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_2",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_3",
                "type": "nodes-base.segment",
                "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "completePhase",
              "phase": "discovery",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "setPhase",
              "phase": "configuration",
              "timestamp": "2025-08-11T20:22:55.179Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                "onError": "continueRegularOutput",
                "parameters": {
                  "path": "customer-signup",
                  "options": {
                    "rawBody": false,
                    "noResponseBody": false
                  },
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode"
                },
                "typeVersion": "1",
                "alwaysOutputData": true
              },
              "nodeId": "task_node_1",
              "purpose": "Set up a webhook to receive data from external services",
              "nodeType": "nodes-base.webhook",
              "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
              "timestamp": "2025-08-11T20:22:55.457Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:55.694Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                "parameters": {
                  "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                }
              },
              "nodeId": "task_node_5",
              "purpose": "Transform data structure using JavaScript",
              "nodeType": "nodes-base.code",
              "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
              "timestamp": "2025-08-11T20:22:55.694Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_5",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:55.939Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                "onError": "continueRegularOutput",
                "maxTries": 3,
                "parameters": {
                  "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                  "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                  "toEmail": "{{ $json.email }}",
                  "fromEmail": "onboarding@company.com"
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "alwaysOutputData": true,
                "waitBetweenTries": 3000
              },
              "nodeId": "task_node_4",
              "purpose": "Send an email notification",
              "nodeType": "nodes-base.emailSend",
              "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
              "timestamp": "2025-08-11T20:22:55.939Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_4",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.169Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                "onError": "continueRegularOutput",
                "parameters": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                  "language": "javaScript"
                },
                "typeVersion": "1"
              },
              "nodeId": "task_node_2",
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "nodeType": "nodes-base.code",
              "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
              "timestamp": "2025-08-11T20:22:56.169Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.384Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "parameters": {
                  "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                  "select": "channel",
                  "resource": "message",
                  "channelId": "#sales-escalations",
                  "operation": "post",
                  "parameters": {}
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "waitBetweenTries": 2000
              },
              "nodeId": "task_node_6",
              "purpose": "Send a message to Slack channel",
              "nodeType": "nodes-base.slack",
              "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
              "timestamp": "2025-08-11T20:22:56.384Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_6",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.635Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                  "method": "GET",
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "Authorization",
                        "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                      }
                    ]
                  }
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "alwaysOutputData": true,
                "waitBetweenTries": 2000
              },
              "nodeId": "task_node_3",
              "purpose": "Make an authenticated API request",
              "nodeType": "nodes-base.httpRequest",
              "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
              "timestamp": "2025-08-11T20:22:56.635Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_3",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.793Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                "parameters": {
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                  "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                  "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                  "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                  "resource": "lead",
                  "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                  "operation": "create",
                  "leadSource": "Website Signup",
                  "leadStatus": "New Lead",
                  "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                  "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                },
                "typeVersion": "1"
              },
              "nodeId": "search_node_1",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
              "nodeType": "nodes-base.zohoCrm",
              "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
              "timestamp": "2025-08-11T20:22:56.793Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.034Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                "parameters": {
                  "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                  "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                  "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                  "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                  "resource": "event",
                  "operation": "create",
                  "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                },
                "typeVersion": "1.3"
              },
              "nodeId": "search_node_2",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
              "nodeType": "nodes-base.googleCalendar",
              "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
              "timestamp": "2025-08-11T20:22:57.034Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.270Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                "parameters": {
                  "event": "{{ $json.eventName || 'engagement_event' }}",
                  "traits": {
                    "phone": "{{ $json.phone }}",
                    "title": "{{ $json.title }}",
                    "company": "{{ $json.company }}",
                    "industry": "{{ $json.industry }}",
                    "lead_status": "{{ $json.leadStatus }}",
                    "company_size": "{{ $json.companySize }}",
                    "last_engagement": "{{ $now }}"
                  },
                  "userId": "{{ $json.userId || $json.email }}",
                  "resource": "track",
                  "operation": "event",
                  "properties": {
                    "value": "{{ $json.value }}",
                    "action": "{{ $json.action }}",
                    "source": "onboarding_workflow",
                    "channel": "{{ $json.channel }}",
                    "industry": "{{ $json.industry }}",
                    "timestamp": "{{ $now }}",
                    "company_size": "{{ $json.companySize }}",
                    "engagement_level": "{{ $json.engagementLevel }}",
                    "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                  }
                },
                "typeVersion": "1"
              },
              "nodeId": "search_node_3",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
              "nodeType": "nodes-base.segment",
              "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
              "timestamp": "2025-08-11T20:22:57.270Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_3",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.511Z"
            },
            {
              "type": "completePhase",
              "phase": "configuration",
              "timestamp": "2025-08-11T20:22:57.511Z"
            },
            {
              "type": "setPhase",
              "phase": "building",
              "timestamp": "2025-08-11T20:23:53.196Z"
            },
            {
              "type": "setWorkflow",
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.1
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                      "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                      "options": {},
                      "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 1
                  }
                ],
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "timestamp": "2025-08-11T20:23:53.469Z"
            },
            {
              "type": "setBuildPhases",
              "phases": [
                {
                  "type": "trigger",
                  "nodeIds": [
                    "webhook_1"
                  ],
                  "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_1"
                  ],
                  "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                },
                {
                  "type": "data_collection",
                  "nodeIds": [
                    "httpRequest_1"
                  ],
                  "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_2"
                  ],
                  "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                },
                {
                  "type": "notification",
                  "nodeIds": [
                    "emailSend_1",
                    "segment_1"
                  ],
                  "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                },
                {
                  "type": "storage",
                  "nodeIds": [
                    "zohoCrm_1"
                  ],
                  "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                },
                {
                  "type": "integration",
                  "nodeIds": [
                    "googleCalendar_1",
                    "slack_1"
                  ],
                  "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                }
              ],
              "timestamp": "2025-08-11T20:23:53.469Z"
            },
            {
              "type": "completePhase",
              "phase": "building",
              "timestamp": "2025-08-11T20:23:53.469Z"
            },
            {
              "type": "setPhase",
              "phase": "validation",
              "timestamp": "2025-08-11T20:24:28.262Z"
            },
            {
              "type": "validateNode",
              "nodeId": "emailSend_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "zohoCrm_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "googleCalendar_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "slack_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "webhook_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "httpRequest_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "emailSend_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 2,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "zohoCrm_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 2,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "googleCalendar_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 2,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "webhook_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "code_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "httpRequest_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "code_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "emailSend_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "segment_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "zohoCrm_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "googleCalendar_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "slack_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "setWorkflow",
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.2
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                      "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                      "options": {},
                      "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2.1
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                    },
                    "typeVersion": 1.3
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 2.3
                  }
                ],
                "valid": true,
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "completePhase",
              "phase": "validation",
              "timestamp": "2025-08-11T20:24:28.888Z"
            }
          ],
          "pendingClarifications": [],
          "clarificationHistory": []
        }
      },
      "stateChanges": {},
      "dataFlow": {
        "input": {
          "workflow": {
            "name": "Intelligent Customer Onboarding Workflow",
            "nodes": [
              {
                "id": "webhook_1",
                "type": "n8n-nodes-base.webhook",
                "position": [
                  250,
                  300
                ],
                "parameters": {
                  "httpMethod": "POST",
                  "path": "customer-signup",
                  "responseMode": "responseNode",
                  "options": {}
                },
                "name": "Customer Signup Webhook",
                "typeVersion": 1,
                "onError": "stopWorkflow"
              },
              {
                "id": "code_1",
                "type": "n8n-nodes-base.code",
                "position": [
                  550,
                  300
                ],
                "parameters": {
                  "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                },
                "name": "Process Signup Data",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "httpRequest_1",
                "type": "n8n-nodes-base.httpRequest",
                "position": [
                  850,
                  300
                ],
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find",
                  "authentication": "predefinedCredentialType",
                  "nodeCredentialType": "clearbitApi",
                  "sendQuery": true,
                  "queryParameters": {
                    "parameters": [
                      {
                        "name": "domain",
                        "value": "={{ $json.enrichmentQuery.domain }}"
                      }
                    ]
                  },
                  "options": {
                    "timeout": 10000,
                    "retry": {
                      "enabled": true,
                      "maxTries": 3
                    }
                  }
                },
                "name": "Fetch Company Data",
                "typeVersion": 4.1,
                "onError": "continueErrorOutput",
                "retryOnFail": true,
                "maxTries": 3
              },
              {
                "id": "code_2",
                "type": "n8n-nodes-base.code",
                "position": [
                  1150,
                  300
                ],
                "parameters": {
                  "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                },
                "name": "Analyze Company Profile",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "emailSend_1",
                "type": "n8n-nodes-base.emailSend",
                "position": [
                  1450,
                  200
                ],
                "parameters": {
                  "fromEmail": "onboarding@company.com",
                  "toEmail": "={{ $json.email }}",
                  "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                  "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                  "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                  "options": {}
                },
                "name": "Send Personalized Welcome Email",
                "typeVersion": 2,
                "onError": "continueRegularOutput",
                "maxTries": 3
              },
              {
                "id": "segment_1",
                "type": "n8n-nodes-base.segment",
                "position": [
                  1450,
                  400
                ],
                "parameters": {
                  "userId": "={{ $json.email }}",
                  "event": "Customer Signed Up",
                  "traits": {
                    "email": "={{ $json.email }}",
                    "firstName": "={{ $json.firstName }}",
                    "lastName": "={{ $json.lastName }}",
                    "company": "={{ $json.company }}",
                    "companySize": "={{ $json.companyProfile.size }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "tier": "={{ $json.companyProfile.tier }}",
                    "leadScore": "={{ $json.leadScore }}"
                  },
                  "properties": {
                    "source": "={{ $json.source }}",
                    "signupDate": "={{ $json.signupDate }}",
                    "isHighValue": "={{ $json.isHighValue }}",
                    "demoType": "={{ $json.companyProfile.demoType }}"
                  }
                },
                "name": "Track Signup Event",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "zohoCrm_1",
                "type": "n8n-nodes-base.zohoCrm",
                "position": [
                  1750,
                  300
                ],
                "parameters": {
                  "operation": "create",
                  "module": "lead",
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone }}",
                  "firstName": "={{ $json.firstName }}",
                  "lastName": "={{ $json.lastName }}",
                  "company": "={{ $json.company }}",
                  "additionalFields": {
                    "leadSource": "Website Signup",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "leadStatus": "New",
                    "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                    "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                  }
                },
                "name": "Create CRM Lead",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "googleCalendar_1",
                "type": "n8n-nodes-base.googleCalendar",
                "position": [
                  2050,
                  200
                ],
                "parameters": {
                  "operation": "create",
                  "calendarId": "primary",
                  "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                  "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                  "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                  "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}",
                  "attendees": "={{ $json.email }}",
                  "options": {
                    "sendNotifications": true
                  }
                },
                "name": "Schedule Demo Call",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "slack_1",
                "type": "n8n-nodes-base.slack",
                "position": [
                  2050,
                  400
                ],
                "parameters": {
                  "channel": "#sales-alerts",
                  "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                  "otherOptions": {
                    "includeLinkToWorkflow": true
                  }
                },
                "name": "Notify Sales Team",
                "typeVersion": 1,
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "executeOnce": true
              }
            ],
            "connections": {
              "Customer Signup Webhook": {
                "main": [
                  [
                    {
                      "node": "Process Signup Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Process Signup Data": {
                "main": [
                  [
                    {
                      "node": "Fetch Company Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Fetch Company Data": {
                "main": [
                  [
                    {
                      "node": "Analyze Company Profile",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Analyze Company Profile": {
                "main": [
                  [
                    {
                      "node": "Send Personalized Welcome Email",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Track Signup Event",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Create CRM Lead",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Create CRM Lead": {
                "main": [
                  [
                    {
                      "node": "Schedule Demo Call",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Notify Sales Team",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              }
            },
            "settings": {
              "executionOrder": "v1",
              "saveDataSuccessExecution": "all",
              "saveDataErrorExecution": "all",
              "saveManualExecutions": true
            }
          }
        },
        "output": {
          "validatedWorkflow": {
            "name": "Intelligent Customer Onboarding Workflow",
            "nodes": [
              {
                "id": "webhook_1",
                "type": "n8n-nodes-base.webhook",
                "position": [
                  250,
                  300
                ],
                "parameters": {
                  "httpMethod": "POST",
                  "path": "customer-signup",
                  "responseMode": "responseNode",
                  "options": {}
                },
                "name": "Customer Signup Webhook",
                "typeVersion": 2,
                "onError": "stopWorkflow"
              },
              {
                "id": "code_1",
                "type": "n8n-nodes-base.code",
                "position": [
                  550,
                  300
                ],
                "parameters": {
                  "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                },
                "name": "Process Signup Data",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "httpRequest_1",
                "type": "n8n-nodes-base.httpRequest",
                "position": [
                  850,
                  300
                ],
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find",
                  "authentication": "predefinedCredentialType",
                  "nodeCredentialType": "clearbitApi",
                  "sendQuery": true,
                  "queryParameters": {
                    "parameters": [
                      {
                        "name": "domain",
                        "value": "={{ $json.enrichmentQuery.domain }}"
                      }
                    ]
                  },
                  "options": {
                    "timeout": 10000,
                    "retry": {
                      "enabled": true,
                      "maxTries": 3
                    }
                  }
                },
                "name": "Fetch Company Data",
                "typeVersion": 4.2,
                "onError": "continueErrorOutput",
                "retryOnFail": true,
                "maxTries": 3
              },
              {
                "id": "code_2",
                "type": "n8n-nodes-base.code",
                "position": [
                  1150,
                  300
                ],
                "parameters": {
                  "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                },
                "name": "Analyze Company Profile",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "emailSend_1",
                "type": "n8n-nodes-base.emailSend",
                "position": [
                  1450,
                  200
                ],
                "parameters": {
                  "fromEmail": "onboarding@company.com",
                  "toEmail": "={{ $json.email }}",
                  "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                  "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                  "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                  "options": {}
                },
                "name": "Send Personalized Welcome Email",
                "typeVersion": 2.1,
                "onError": "continueRegularOutput",
                "maxTries": 3
              },
              {
                "id": "segment_1",
                "type": "n8n-nodes-base.segment",
                "position": [
                  1450,
                  400
                ],
                "parameters": {
                  "userId": "={{ $json.email }}",
                  "event": "Customer Signed Up",
                  "traits": {
                    "email": "={{ $json.email }}",
                    "firstName": "={{ $json.firstName }}",
                    "lastName": "={{ $json.lastName }}",
                    "company": "={{ $json.company }}",
                    "companySize": "={{ $json.companyProfile.size }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "tier": "={{ $json.companyProfile.tier }}",
                    "leadScore": "={{ $json.leadScore }}"
                  },
                  "properties": {
                    "source": "={{ $json.source }}",
                    "signupDate": "={{ $json.signupDate }}",
                    "isHighValue": "={{ $json.isHighValue }}",
                    "demoType": "={{ $json.companyProfile.demoType }}"
                  }
                },
                "name": "Track Signup Event",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "zohoCrm_1",
                "type": "n8n-nodes-base.zohoCrm",
                "position": [
                  1750,
                  300
                ],
                "parameters": {
                  "operation": "create",
                  "module": "lead",
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone }}",
                  "firstName": "={{ $json.firstName }}",
                  "lastName": "={{ $json.lastName }}",
                  "company": "={{ $json.company }}",
                  "additionalFields": {
                    "leadSource": "Website Signup",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "leadStatus": "New",
                    "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                    "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                  }
                },
                "name": "Create CRM Lead",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "googleCalendar_1",
                "type": "n8n-nodes-base.googleCalendar",
                "position": [
                  2050,
                  200
                ],
                "parameters": {
                  "operation": "create",
                  "calendarId": "primary",
                  "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                  "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                  "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                  "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}",
                  "attendees": "={{ $json.email }}",
                  "options": {
                    "sendNotifications": true
                  }
                },
                "name": "Schedule Demo Call",
                "typeVersion": 1.3,
                "onError": "continueRegularOutput"
              },
              {
                "id": "slack_1",
                "type": "n8n-nodes-base.slack",
                "position": [
                  2050,
                  400
                ],
                "parameters": {
                  "channel": "#sales-alerts",
                  "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                  "otherOptions": {
                    "includeLinkToWorkflow": true
                  }
                },
                "name": "Notify Sales Team",
                "typeVersion": 2.3,
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "executeOnce": true
              }
            ],
            "connections": {
              "Customer Signup Webhook": {
                "main": [
                  [
                    {
                      "node": "Process Signup Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Process Signup Data": {
                "main": [
                  [
                    {
                      "node": "Fetch Company Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Fetch Company Data": {
                "main": [
                  [
                    {
                      "node": "Analyze Company Profile",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Analyze Company Profile": {
                "main": [
                  [
                    {
                      "node": "Send Personalized Welcome Email",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Track Signup Event",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Create CRM Lead",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Create CRM Lead": {
                "main": [
                  [
                    {
                      "node": "Schedule Demo Call",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Notify Sales Team",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              }
            },
            "settings": {
              "executionOrder": "v1",
              "saveDataSuccessExecution": "all",
              "saveDataErrorExecution": "all",
              "saveManualExecutions": true
            },
            "valid": true
          },
          "report": {
            "initial": {
              "workflow": {
                "errors": [
                  {
                    "node": "Send Personalized Welcome Email",
                    "message": "Expression error: text: Nested expressions are not supported"
                  },
                  {
                    "node": "Send Personalized Welcome Email",
                    "message": "Expression error: html: Nested expressions are not supported"
                  },
                  {
                    "node": "Create CRM Lead",
                    "message": "Expression error: additionalFields.description: Nested expressions are not supported"
                  },
                  {
                    "node": "Schedule Demo Call",
                    "message": "Expression error: summary: Nested expressions are not supported"
                  },
                  {
                    "node": "Schedule Demo Call",
                    "message": "Expression error: description: Nested expressions are not supported"
                  },
                  {
                    "node": "Notify Sales Team",
                    "message": "Expression error: text: Nested expressions are not supported"
                  },
                  {
                    "node": "Customer Signup Webhook",
                    "message": "Outdated typeVersion: 1. Latest is 2",
                    "type": "typeVersion",
                    "severity": "error"
                  },
                  {
                    "node": "Fetch Company Data",
                    "message": "Outdated typeVersion: 4.1. Latest is 4.2",
                    "type": "typeVersion",
                    "severity": "error"
                  },
                  {
                    "node": "Send Personalized Welcome Email",
                    "message": "Outdated typeVersion: 2. Latest is 2.1",
                    "type": "typeVersion",
                    "severity": "error"
                  },
                  {
                    "node": "Schedule Demo Call",
                    "message": "Outdated typeVersion: 1. Latest is 1.3",
                    "type": "typeVersion",
                    "severity": "error"
                  },
                  {
                    "node": "Notify Sales Team",
                    "message": "Outdated typeVersion: 1. Latest is 2.3",
                    "type": "typeVersion",
                    "severity": "error"
                  }
                ],
                "warnings": [
                  {
                    "node": "Fetch Company Data",
                    "message": {
                      "type": "security",
                      "property": "nodeCredentialType",
                      "message": "Hardcoded nodeCredentialType detected",
                      "suggestion": "Use n8n credentials or expressions instead of hardcoding sensitive values"
                    }
                  },
                  {
                    "node": "Notify Sales Team",
                    "message": "Expression warning: text: Possible missing $ prefix for variable (e.g., use $json instead of json)"
                  },
                  {
                    "node": "workflow",
                    "message": "Consider adding error handling to your workflow"
                  },
                  {
                    "node": "Notify Sales Team",
                    "message": "executeOnce is enabled. This node will execute only once regardless of input items."
                  }
                ],
                "valid": false,
                "statistics": {
                  "totalNodes": 9,
                  "enabledNodes": 9,
                  "triggerNodes": 1,
                  "validConnections": 8,
                  "invalidConnections": 0,
                  "expressionsValidated": 6,
                  "errorCount": 6,
                  "warningCount": 9
                }
              },
              "connections": {
                "errors": [],
                "warnings": []
              },
              "expressions": {
                "errors": [],
                "warnings": []
              }
            },
            "fixesApplied": [
              {
                "type": "entity-replacement",
                "attempt": 1,
                "timestamp": "2025-08-11T20:24:16.097Z",
                "description": "Replaced 6 nodes",
                "reasoning": [
                  "Fixed nested expression errors by converting multiple {{ }} expressions to single expressions using template literals with ${} syntax",
                  "Updated all outdated typeVersions to their latest versions: webhook (1→2), httpRequest (4.1→4.2), emailSend (2→2.1), googleCalendar (1→1.3), slack (1→2.3)",
                  "Converted expressions like 'Welcome to [Product] - Let's get {{ $json.company }} started!' to '{{ `Welcome to [Product] - Let's get ${$json.company} started!` }}'",
                  "Fixed all text, html, description, and summary fields that had nested expressions by wrapping them in single template literal expressions",
                  "Maintained all original functionality while ensuring proper n8n expression syntax compliance"
                ],
                "entitiesFixed": {
                  "nodes": [
                    "emailSend_1",
                    "zohoCrm_1",
                    "googleCalendar_1",
                    "slack_1",
                    "webhook_1",
                    "httpRequest_1"
                  ],
                  "connections": false
                }
              },
              {
                "type": "entity-replacement",
                "attempt": 2,
                "timestamp": "2025-08-11T20:24:28.060Z",
                "description": "Replaced 3 nodes",
                "reasoning": [
                  "Fixed template literal syntax in Send Personalized Welcome Email node by converting ${} expressions to string concatenation using + operator",
                  "Fixed template literal syntax in Create CRM Lead node description field by converting ${} expressions to string concatenation",
                  "Fixed template literal syntax in Schedule Demo Call node summary and description fields by converting ${} expressions to string concatenation",
                  "All expressions now use proper n8n syntax with string concatenation instead of template literals"
                ],
                "entitiesFixed": {
                  "nodes": [
                    "emailSend_1",
                    "zohoCrm_1",
                    "googleCalendar_1"
                  ],
                  "connections": false
                }
              }
            ],
            "final": {
              "workflow": {
                "errors": [],
                "warnings": [
                  {
                    "node": "Fetch Company Data",
                    "message": {
                      "type": "security",
                      "property": "nodeCredentialType",
                      "message": "Hardcoded nodeCredentialType detected",
                      "suggestion": "Use n8n credentials or expressions instead of hardcoding sensitive values"
                    }
                  },
                  {
                    "node": "workflow",
                    "message": "Consider adding error handling to your workflow"
                  },
                  {
                    "node": "Notify Sales Team",
                    "message": "executeOnce is enabled. This node will execute only once regardless of input items."
                  }
                ],
                "valid": true,
                "statistics": {
                  "totalNodes": 9,
                  "enabledNodes": 9,
                  "triggerNodes": 1,
                  "validConnections": 8,
                  "invalidConnections": 0,
                  "expressionsValidated": 5,
                  "errorCount": 0,
                  "warningCount": 3
                }
              },
              "connections": {
                "errors": [],
                "warnings": []
              },
              "expressions": {
                "errors": [],
                "warnings": []
              }
            },
            "attempts": 3
          }
        },
        "transformations": [
          "Validation Check",
          "Error Detection",
          "Automatic Fixes"
        ]
      },
      "errors": [
        {
          "type": "ValidationError",
          "message": "Error 1",
          "resolution": "Applied automatic fix",
          "attemptNumber": 1
        },
        {
          "type": "ValidationError",
          "message": "Error 2",
          "resolution": "Applied automatic fix",
          "attemptNumber": 2
        }
      ],
      "stateDelta": {
        "added": {
          "state": {
            "workflow": {
              "valid": true
            }
          }
        },
        "modified": {
          "state": {
            "old": {
              "phase": "validation",
              "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
              "discovered": [
                {
                  "id": "task_node_1",
                  "type": "nodes-base.webhook",
                  "config": {
                    "path": "webhook",
                    "onError": "continueRegularOutput",
                    "httpMethod": "POST",
                    "responseData": "allEntries",
                    "responseMode": "lastNode",
                    "alwaysOutputData": true
                  },
                  "purpose": "Set up a webhook to receive data from external services",
                  "displayName": "receive webhook",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_5",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                    "language": "javaScript"
                  },
                  "purpose": "Transform data structure using JavaScript",
                  "displayName": "transform data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_4",
                  "type": "nodes-base.emailSend",
                  "config": {
                    "text": "",
                    "onError": "continueRegularOutput",
                    "subject": "",
                    "toEmail": "",
                    "maxTries": 3,
                    "fromEmail": "",
                    "retryOnFail": true,
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "purpose": "Send an email notification",
                  "displayName": "send email",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_2",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                    "onError": "continueRegularOutput",
                    "language": "javaScript"
                  },
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "displayName": "process webhook data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_6",
                  "type": "nodes-base.slack",
                  "config": {
                    "text": "",
                    "channel": "",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "resource": "message",
                    "operation": "post",
                    "parameters": {},
                    "retryOnFail": true,
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Send a message to Slack channel",
                  "displayName": "send slack message",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_3",
                  "type": "nodes-base.httpRequest",
                  "config": {
                    "url": "",
                    "method": "GET",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "retryOnFail": true,
                    "sendHeaders": true,
                    "authentication": "genericCredentialType",
                    "genericAuthType": "headerAuth",
                    "alwaysOutputData": true,
                    "headerParameters": {
                      "parameters": [
                        {
                          "name": "",
                          "value": ""
                        }
                      ]
                    },
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Make an authenticated API request",
                  "displayName": "call api with auth",
                  "isPreConfigured": true
                },
                {
                  "id": "search_node_1",
                  "type": "nodes-base.zohoCrm",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                },
                {
                  "id": "search_node_2",
                  "type": "nodes-base.googleCalendar",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                },
                {
                  "id": "search_node_3",
                  "type": "nodes-base.segment",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                }
              ],
              "selected": [
                "task_node_1",
                "task_node_5",
                "task_node_4",
                "task_node_2",
                "task_node_6",
                "task_node_3",
                "search_node_1",
                "search_node_2",
                "search_node_3"
              ],
              "configured": {},
              "validated": {},
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.1
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                      "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                      "options": {},
                      "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 1
                  }
                ],
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "buildPhases": [
                {
                  "type": "trigger",
                  "nodeIds": [
                    "webhook_1"
                  ],
                  "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_1"
                  ],
                  "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                },
                {
                  "type": "data_collection",
                  "nodeIds": [
                    "httpRequest_1"
                  ],
                  "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_2"
                  ],
                  "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                },
                {
                  "type": "notification",
                  "nodeIds": [
                    "emailSend_1",
                    "segment_1"
                  ],
                  "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                },
                {
                  "type": "storage",
                  "nodeIds": [
                    "zohoCrm_1"
                  ],
                  "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                },
                {
                  "type": "integration",
                  "nodeIds": [
                    "googleCalendar_1",
                    "slack_1"
                  ],
                  "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                }
              ],
              "operationHistory": [
                {
                  "node": {
                    "id": "task_node_1",
                    "type": "nodes-base.webhook",
                    "config": {
                      "path": "webhook",
                      "onError": "continueRegularOutput",
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode",
                      "alwaysOutputData": true
                    },
                    "purpose": "Set up a webhook to receive data from external services",
                    "displayName": "receive webhook",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_1",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_5",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    },
                    "purpose": "Transform data structure using JavaScript",
                    "displayName": "transform data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_5",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_4",
                    "type": "nodes-base.emailSend",
                    "config": {
                      "text": "",
                      "onError": "continueRegularOutput",
                      "subject": "",
                      "toEmail": "",
                      "maxTries": 3,
                      "fromEmail": "",
                      "retryOnFail": true,
                      "alwaysOutputData": true,
                      "waitBetweenTries": 3000
                    },
                    "purpose": "Send an email notification",
                    "displayName": "send email",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_4",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_2",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                      "onError": "continueRegularOutput",
                      "language": "javaScript"
                    },
                    "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                    "displayName": "process webhook data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_2",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_6",
                    "type": "nodes-base.slack",
                    "config": {
                      "text": "",
                      "channel": "",
                      "onError": "continueRegularOutput",
                      "maxTries": 2,
                      "resource": "message",
                      "operation": "post",
                      "parameters": {},
                      "retryOnFail": true,
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Send a message to Slack channel",
                    "displayName": "send slack message",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_6",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_3",
                    "type": "nodes-base.httpRequest",
                    "config": {
                      "url": "",
                      "method": "GET",
                      "onError": "continueErrorOutput",
                      "maxTries": 3,
                      "retryOnFail": true,
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "alwaysOutputData": true,
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ]
                      },
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Make an authenticated API request",
                    "displayName": "call api with auth",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_1",
                    "type": "nodes-base.zohoCrm",
                    "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_1",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_2",
                    "type": "nodes-base.googleCalendar",
                    "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_2",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_3",
                    "type": "nodes-base.segment",
                    "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "completePhase",
                  "phase": "discovery",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "setPhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:55.179Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "path": "customer-signup",
                      "options": {
                        "rawBody": false,
                        "noResponseBody": false
                      },
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode"
                    },
                    "typeVersion": "1",
                    "alwaysOutputData": true
                  },
                  "nodeId": "task_node_1",
                  "purpose": "Set up a webhook to receive data from external services",
                  "nodeType": "nodes-base.webhook",
                  "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
                  "timestamp": "2025-08-11T20:22:55.457Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.694Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                    "parameters": {
                      "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    }
                  },
                  "nodeId": "task_node_5",
                  "purpose": "Transform data structure using JavaScript",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
                  "timestamp": "2025-08-11T20:22:55.694Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_5",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.939Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "parameters": {
                      "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                      "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                      "toEmail": "{{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "nodeId": "task_node_4",
                  "purpose": "Send an email notification",
                  "nodeType": "nodes-base.emailSend",
                  "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
                  "timestamp": "2025-08-11T20:22:55.939Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_4",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.169Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                      "language": "javaScript"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "task_node_2",
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
                  "timestamp": "2025-08-11T20:22:56.169Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.384Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "parameters": {
                      "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                      "select": "channel",
                      "resource": "message",
                      "channelId": "#sales-escalations",
                      "operation": "post",
                      "parameters": {}
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_6",
                  "purpose": "Send a message to Slack channel",
                  "nodeType": "nodes-base.slack",
                  "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
                  "timestamp": "2025-08-11T20:22:56.384Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_6",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.635Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                      "method": "GET",
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "Authorization",
                            "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                          }
                        ]
                      }
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_3",
                  "purpose": "Make an authenticated API request",
                  "nodeType": "nodes-base.httpRequest",
                  "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
                  "timestamp": "2025-08-11T20:22:56.635Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.793Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                      "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                      "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                      "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                      "resource": "lead",
                      "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                      "operation": "create",
                      "leadSource": "Website Signup",
                      "leadStatus": "New Lead",
                      "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                      "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_1",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
                  "nodeType": "nodes-base.zohoCrm",
                  "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:56.793Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.034Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                    "parameters": {
                      "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                      "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                      "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                      "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                      "resource": "event",
                      "operation": "create",
                      "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                    },
                    "typeVersion": "1.3"
                  },
                  "nodeId": "search_node_2",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
                  "nodeType": "nodes-base.googleCalendar",
                  "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.034Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.270Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                    "parameters": {
                      "event": "{{ $json.eventName || 'engagement_event' }}",
                      "traits": {
                        "phone": "{{ $json.phone }}",
                        "title": "{{ $json.title }}",
                        "company": "{{ $json.company }}",
                        "industry": "{{ $json.industry }}",
                        "lead_status": "{{ $json.leadStatus }}",
                        "company_size": "{{ $json.companySize }}",
                        "last_engagement": "{{ $now }}"
                      },
                      "userId": "{{ $json.userId || $json.email }}",
                      "resource": "track",
                      "operation": "event",
                      "properties": {
                        "value": "{{ $json.value }}",
                        "action": "{{ $json.action }}",
                        "source": "onboarding_workflow",
                        "channel": "{{ $json.channel }}",
                        "industry": "{{ $json.industry }}",
                        "timestamp": "{{ $now }}",
                        "company_size": "{{ $json.companySize }}",
                        "engagement_level": "{{ $json.engagementLevel }}",
                        "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                      }
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_3",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
                  "nodeType": "nodes-base.segment",
                  "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.270Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "completePhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "setPhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.196Z"
                },
                {
                  "type": "setWorkflow",
                  "workflow": {
                    "name": "Intelligent Customer Onboarding Workflow",
                    "nodes": [
                      {
                        "id": "webhook_1",
                        "name": "Customer Signup Webhook",
                        "type": "n8n-nodes-base.webhook",
                        "onError": "stopWorkflow",
                        "position": [
                          250,
                          300
                        ],
                        "parameters": {
                          "path": "customer-signup",
                          "options": {},
                          "httpMethod": "POST",
                          "responseMode": "responseNode"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "code_1",
                        "name": "Process Signup Data",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          550,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "httpRequest_1",
                        "name": "Fetch Company Data",
                        "type": "n8n-nodes-base.httpRequest",
                        "onError": "continueErrorOutput",
                        "maxTries": 3,
                        "position": [
                          850,
                          300
                        ],
                        "parameters": {
                          "url": "https://api.clearbit.com/v2/companies/find",
                          "options": {
                            "retry": {
                              "enabled": true,
                              "maxTries": 3
                            },
                            "timeout": 10000
                          },
                          "sendQuery": true,
                          "authentication": "predefinedCredentialType",
                          "queryParameters": {
                            "parameters": [
                              {
                                "name": "domain",
                                "value": "={{ $json.enrichmentQuery.domain }}"
                              }
                            ]
                          },
                          "nodeCredentialType": "clearbitApi"
                        },
                        "retryOnFail": true,
                        "typeVersion": 4.1
                      },
                      {
                        "id": "code_2",
                        "name": "Analyze Company Profile",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          1150,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "emailSend_1",
                        "name": "Send Personalized Welcome Email",
                        "type": "n8n-nodes-base.emailSend",
                        "onError": "continueRegularOutput",
                        "maxTries": 3,
                        "position": [
                          1450,
                          200
                        ],
                        "parameters": {
                          "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                          "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                          "options": {},
                          "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                          "toEmail": "={{ $json.email }}",
                          "fromEmail": "onboarding@company.com"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "segment_1",
                        "name": "Track Signup Event",
                        "type": "n8n-nodes-base.segment",
                        "onError": "continueRegularOutput",
                        "position": [
                          1450,
                          400
                        ],
                        "parameters": {
                          "event": "Customer Signed Up",
                          "traits": {
                            "tier": "={{ $json.companyProfile.tier }}",
                            "email": "={{ $json.email }}",
                            "company": "={{ $json.company }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "lastName": "={{ $json.lastName }}",
                            "firstName": "={{ $json.firstName }}",
                            "leadScore": "={{ $json.leadScore }}",
                            "companySize": "={{ $json.companyProfile.size }}"
                          },
                          "userId": "={{ $json.email }}",
                          "properties": {
                            "source": "={{ $json.source }}",
                            "demoType": "={{ $json.companyProfile.demoType }}",
                            "signupDate": "={{ $json.signupDate }}",
                            "isHighValue": "={{ $json.isHighValue }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "zohoCrm_1",
                        "name": "Create CRM Lead",
                        "type": "n8n-nodes-base.zohoCrm",
                        "onError": "continueRegularOutput",
                        "position": [
                          1750,
                          300
                        ],
                        "parameters": {
                          "email": "={{ $json.email }}",
                          "phone": "={{ $json.phone }}",
                          "module": "lead",
                          "company": "={{ $json.company }}",
                          "lastName": "={{ $json.lastName }}",
                          "firstName": "={{ $json.firstName }}",
                          "operation": "create",
                          "additionalFields": {
                            "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "leadSource": "Website Signup",
                            "leadStatus": "New",
                            "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "googleCalendar_1",
                        "name": "Schedule Demo Call",
                        "type": "n8n-nodes-base.googleCalendar",
                        "onError": "continueRegularOutput",
                        "position": [
                          2050,
                          200
                        ],
                        "parameters": {
                          "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                          "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                          "options": {
                            "sendNotifications": true
                          },
                          "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                          "attendees": "={{ $json.email }}",
                          "operation": "create",
                          "calendarId": "primary",
                          "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "slack_1",
                        "name": "Notify Sales Team",
                        "type": "n8n-nodes-base.slack",
                        "onError": "continueRegularOutput",
                        "maxTries": 2,
                        "position": [
                          2050,
                          400
                        ],
                        "parameters": {
                          "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                          "channel": "#sales-alerts",
                          "otherOptions": {
                            "includeLinkToWorkflow": true
                          }
                        },
                        "executeOnce": true,
                        "typeVersion": 1
                      }
                    ],
                    "settings": {
                      "executionOrder": "v1",
                      "saveManualExecutions": true,
                      "saveDataErrorExecution": "all",
                      "saveDataSuccessExecution": "all"
                    },
                    "connections": {
                      "Create CRM Lead": {
                        "main": [
                          [
                            {
                              "node": "Schedule Demo Call",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Notify Sales Team",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Fetch Company Data": {
                        "main": [
                          [
                            {
                              "node": "Analyze Company Profile",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Process Signup Data": {
                        "main": [
                          [
                            {
                              "node": "Fetch Company Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Analyze Company Profile": {
                        "main": [
                          [
                            {
                              "node": "Send Personalized Welcome Email",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Track Signup Event",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Create CRM Lead",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Customer Signup Webhook": {
                        "main": [
                          [
                            {
                              "node": "Process Signup Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      }
                    }
                  },
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "setBuildPhases",
                  "phases": [
                    {
                      "type": "trigger",
                      "nodeIds": [
                        "webhook_1"
                      ],
                      "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_1"
                      ],
                      "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                    },
                    {
                      "type": "data_collection",
                      "nodeIds": [
                        "httpRequest_1"
                      ],
                      "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_2"
                      ],
                      "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                    },
                    {
                      "type": "notification",
                      "nodeIds": [
                        "emailSend_1",
                        "segment_1"
                      ],
                      "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                    },
                    {
                      "type": "storage",
                      "nodeIds": [
                        "zohoCrm_1"
                      ],
                      "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                    },
                    {
                      "type": "integration",
                      "nodeIds": [
                        "googleCalendar_1",
                        "slack_1"
                      ],
                      "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                    }
                  ],
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "completePhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.469Z"
                }
              ],
              "pendingClarifications": [],
              "clarificationHistory": []
            },
            "new": {
              "phase": "documentation",
              "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
              "discovered": [
                {
                  "id": "task_node_1",
                  "type": "nodes-base.webhook",
                  "config": {
                    "path": "webhook",
                    "onError": "continueRegularOutput",
                    "httpMethod": "POST",
                    "responseData": "allEntries",
                    "responseMode": "lastNode",
                    "alwaysOutputData": true
                  },
                  "purpose": "Set up a webhook to receive data from external services",
                  "displayName": "receive webhook",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_5",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                    "language": "javaScript"
                  },
                  "purpose": "Transform data structure using JavaScript",
                  "displayName": "transform data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_4",
                  "type": "nodes-base.emailSend",
                  "config": {
                    "text": "",
                    "onError": "continueRegularOutput",
                    "subject": "",
                    "toEmail": "",
                    "maxTries": 3,
                    "fromEmail": "",
                    "retryOnFail": true,
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "purpose": "Send an email notification",
                  "displayName": "send email",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_2",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                    "onError": "continueRegularOutput",
                    "language": "javaScript"
                  },
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "displayName": "process webhook data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_6",
                  "type": "nodes-base.slack",
                  "config": {
                    "text": "",
                    "channel": "",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "resource": "message",
                    "operation": "post",
                    "parameters": {},
                    "retryOnFail": true,
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Send a message to Slack channel",
                  "displayName": "send slack message",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_3",
                  "type": "nodes-base.httpRequest",
                  "config": {
                    "url": "",
                    "method": "GET",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "retryOnFail": true,
                    "sendHeaders": true,
                    "authentication": "genericCredentialType",
                    "genericAuthType": "headerAuth",
                    "alwaysOutputData": true,
                    "headerParameters": {
                      "parameters": [
                        {
                          "name": "",
                          "value": ""
                        }
                      ]
                    },
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Make an authenticated API request",
                  "displayName": "call api with auth",
                  "isPreConfigured": true
                },
                {
                  "id": "search_node_1",
                  "type": "nodes-base.zohoCrm",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                },
                {
                  "id": "search_node_2",
                  "type": "nodes-base.googleCalendar",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                },
                {
                  "id": "search_node_3",
                  "type": "nodes-base.segment",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                }
              ],
              "selected": [
                "task_node_1",
                "task_node_5",
                "task_node_4",
                "task_node_2",
                "task_node_6",
                "task_node_3",
                "search_node_1",
                "search_node_2",
                "search_node_3"
              ],
              "configured": {},
              "validated": {},
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.2
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                      "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                      "options": {},
                      "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2.1
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                    },
                    "typeVersion": 1.3
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 2.3
                  }
                ],
                "valid": true,
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "buildPhases": [
                {
                  "type": "trigger",
                  "nodeIds": [
                    "webhook_1"
                  ],
                  "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_1"
                  ],
                  "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                },
                {
                  "type": "data_collection",
                  "nodeIds": [
                    "httpRequest_1"
                  ],
                  "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_2"
                  ],
                  "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                },
                {
                  "type": "notification",
                  "nodeIds": [
                    "emailSend_1",
                    "segment_1"
                  ],
                  "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                },
                {
                  "type": "storage",
                  "nodeIds": [
                    "zohoCrm_1"
                  ],
                  "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                },
                {
                  "type": "integration",
                  "nodeIds": [
                    "googleCalendar_1",
                    "slack_1"
                  ],
                  "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                }
              ],
              "operationHistory": [
                {
                  "node": {
                    "id": "task_node_1",
                    "type": "nodes-base.webhook",
                    "config": {
                      "path": "webhook",
                      "onError": "continueRegularOutput",
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode",
                      "alwaysOutputData": true
                    },
                    "purpose": "Set up a webhook to receive data from external services",
                    "displayName": "receive webhook",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_1",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_5",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    },
                    "purpose": "Transform data structure using JavaScript",
                    "displayName": "transform data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_5",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_4",
                    "type": "nodes-base.emailSend",
                    "config": {
                      "text": "",
                      "onError": "continueRegularOutput",
                      "subject": "",
                      "toEmail": "",
                      "maxTries": 3,
                      "fromEmail": "",
                      "retryOnFail": true,
                      "alwaysOutputData": true,
                      "waitBetweenTries": 3000
                    },
                    "purpose": "Send an email notification",
                    "displayName": "send email",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_4",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_2",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                      "onError": "continueRegularOutput",
                      "language": "javaScript"
                    },
                    "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                    "displayName": "process webhook data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_2",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_6",
                    "type": "nodes-base.slack",
                    "config": {
                      "text": "",
                      "channel": "",
                      "onError": "continueRegularOutput",
                      "maxTries": 2,
                      "resource": "message",
                      "operation": "post",
                      "parameters": {},
                      "retryOnFail": true,
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Send a message to Slack channel",
                    "displayName": "send slack message",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_6",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_3",
                    "type": "nodes-base.httpRequest",
                    "config": {
                      "url": "",
                      "method": "GET",
                      "onError": "continueErrorOutput",
                      "maxTries": 3,
                      "retryOnFail": true,
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "alwaysOutputData": true,
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ]
                      },
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Make an authenticated API request",
                    "displayName": "call api with auth",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_1",
                    "type": "nodes-base.zohoCrm",
                    "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_1",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_2",
                    "type": "nodes-base.googleCalendar",
                    "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_2",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_3",
                    "type": "nodes-base.segment",
                    "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "completePhase",
                  "phase": "discovery",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "setPhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:55.179Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "path": "customer-signup",
                      "options": {
                        "rawBody": false,
                        "noResponseBody": false
                      },
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode"
                    },
                    "typeVersion": "1",
                    "alwaysOutputData": true
                  },
                  "nodeId": "task_node_1",
                  "purpose": "Set up a webhook to receive data from external services",
                  "nodeType": "nodes-base.webhook",
                  "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
                  "timestamp": "2025-08-11T20:22:55.457Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.694Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                    "parameters": {
                      "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    }
                  },
                  "nodeId": "task_node_5",
                  "purpose": "Transform data structure using JavaScript",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
                  "timestamp": "2025-08-11T20:22:55.694Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_5",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.939Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "parameters": {
                      "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                      "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                      "toEmail": "{{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "nodeId": "task_node_4",
                  "purpose": "Send an email notification",
                  "nodeType": "nodes-base.emailSend",
                  "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
                  "timestamp": "2025-08-11T20:22:55.939Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_4",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.169Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                      "language": "javaScript"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "task_node_2",
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
                  "timestamp": "2025-08-11T20:22:56.169Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.384Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "parameters": {
                      "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                      "select": "channel",
                      "resource": "message",
                      "channelId": "#sales-escalations",
                      "operation": "post",
                      "parameters": {}
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_6",
                  "purpose": "Send a message to Slack channel",
                  "nodeType": "nodes-base.slack",
                  "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
                  "timestamp": "2025-08-11T20:22:56.384Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_6",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.635Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                      "method": "GET",
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "Authorization",
                            "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                          }
                        ]
                      }
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_3",
                  "purpose": "Make an authenticated API request",
                  "nodeType": "nodes-base.httpRequest",
                  "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
                  "timestamp": "2025-08-11T20:22:56.635Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.793Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                      "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                      "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                      "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                      "resource": "lead",
                      "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                      "operation": "create",
                      "leadSource": "Website Signup",
                      "leadStatus": "New Lead",
                      "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                      "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_1",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
                  "nodeType": "nodes-base.zohoCrm",
                  "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:56.793Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.034Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                    "parameters": {
                      "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                      "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                      "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                      "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                      "resource": "event",
                      "operation": "create",
                      "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                    },
                    "typeVersion": "1.3"
                  },
                  "nodeId": "search_node_2",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
                  "nodeType": "nodes-base.googleCalendar",
                  "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.034Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.270Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                    "parameters": {
                      "event": "{{ $json.eventName || 'engagement_event' }}",
                      "traits": {
                        "phone": "{{ $json.phone }}",
                        "title": "{{ $json.title }}",
                        "company": "{{ $json.company }}",
                        "industry": "{{ $json.industry }}",
                        "lead_status": "{{ $json.leadStatus }}",
                        "company_size": "{{ $json.companySize }}",
                        "last_engagement": "{{ $now }}"
                      },
                      "userId": "{{ $json.userId || $json.email }}",
                      "resource": "track",
                      "operation": "event",
                      "properties": {
                        "value": "{{ $json.value }}",
                        "action": "{{ $json.action }}",
                        "source": "onboarding_workflow",
                        "channel": "{{ $json.channel }}",
                        "industry": "{{ $json.industry }}",
                        "timestamp": "{{ $now }}",
                        "company_size": "{{ $json.companySize }}",
                        "engagement_level": "{{ $json.engagementLevel }}",
                        "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                      }
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_3",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
                  "nodeType": "nodes-base.segment",
                  "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.270Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "completePhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "setPhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.196Z"
                },
                {
                  "type": "setWorkflow",
                  "workflow": {
                    "name": "Intelligent Customer Onboarding Workflow",
                    "nodes": [
                      {
                        "id": "webhook_1",
                        "name": "Customer Signup Webhook",
                        "type": "n8n-nodes-base.webhook",
                        "onError": "stopWorkflow",
                        "position": [
                          250,
                          300
                        ],
                        "parameters": {
                          "path": "customer-signup",
                          "options": {},
                          "httpMethod": "POST",
                          "responseMode": "responseNode"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "code_1",
                        "name": "Process Signup Data",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          550,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "httpRequest_1",
                        "name": "Fetch Company Data",
                        "type": "n8n-nodes-base.httpRequest",
                        "onError": "continueErrorOutput",
                        "maxTries": 3,
                        "position": [
                          850,
                          300
                        ],
                        "parameters": {
                          "url": "https://api.clearbit.com/v2/companies/find",
                          "options": {
                            "retry": {
                              "enabled": true,
                              "maxTries": 3
                            },
                            "timeout": 10000
                          },
                          "sendQuery": true,
                          "authentication": "predefinedCredentialType",
                          "queryParameters": {
                            "parameters": [
                              {
                                "name": "domain",
                                "value": "={{ $json.enrichmentQuery.domain }}"
                              }
                            ]
                          },
                          "nodeCredentialType": "clearbitApi"
                        },
                        "retryOnFail": true,
                        "typeVersion": 4.1
                      },
                      {
                        "id": "code_2",
                        "name": "Analyze Company Profile",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          1150,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "emailSend_1",
                        "name": "Send Personalized Welcome Email",
                        "type": "n8n-nodes-base.emailSend",
                        "onError": "continueRegularOutput",
                        "maxTries": 3,
                        "position": [
                          1450,
                          200
                        ],
                        "parameters": {
                          "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                          "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                          "options": {},
                          "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                          "toEmail": "={{ $json.email }}",
                          "fromEmail": "onboarding@company.com"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "segment_1",
                        "name": "Track Signup Event",
                        "type": "n8n-nodes-base.segment",
                        "onError": "continueRegularOutput",
                        "position": [
                          1450,
                          400
                        ],
                        "parameters": {
                          "event": "Customer Signed Up",
                          "traits": {
                            "tier": "={{ $json.companyProfile.tier }}",
                            "email": "={{ $json.email }}",
                            "company": "={{ $json.company }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "lastName": "={{ $json.lastName }}",
                            "firstName": "={{ $json.firstName }}",
                            "leadScore": "={{ $json.leadScore }}",
                            "companySize": "={{ $json.companyProfile.size }}"
                          },
                          "userId": "={{ $json.email }}",
                          "properties": {
                            "source": "={{ $json.source }}",
                            "demoType": "={{ $json.companyProfile.demoType }}",
                            "signupDate": "={{ $json.signupDate }}",
                            "isHighValue": "={{ $json.isHighValue }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "zohoCrm_1",
                        "name": "Create CRM Lead",
                        "type": "n8n-nodes-base.zohoCrm",
                        "onError": "continueRegularOutput",
                        "position": [
                          1750,
                          300
                        ],
                        "parameters": {
                          "email": "={{ $json.email }}",
                          "phone": "={{ $json.phone }}",
                          "module": "lead",
                          "company": "={{ $json.company }}",
                          "lastName": "={{ $json.lastName }}",
                          "firstName": "={{ $json.firstName }}",
                          "operation": "create",
                          "additionalFields": {
                            "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "leadSource": "Website Signup",
                            "leadStatus": "New",
                            "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "googleCalendar_1",
                        "name": "Schedule Demo Call",
                        "type": "n8n-nodes-base.googleCalendar",
                        "onError": "continueRegularOutput",
                        "position": [
                          2050,
                          200
                        ],
                        "parameters": {
                          "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                          "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                          "options": {
                            "sendNotifications": true
                          },
                          "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                          "attendees": "={{ $json.email }}",
                          "operation": "create",
                          "calendarId": "primary",
                          "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "slack_1",
                        "name": "Notify Sales Team",
                        "type": "n8n-nodes-base.slack",
                        "onError": "continueRegularOutput",
                        "maxTries": 2,
                        "position": [
                          2050,
                          400
                        ],
                        "parameters": {
                          "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                          "channel": "#sales-alerts",
                          "otherOptions": {
                            "includeLinkToWorkflow": true
                          }
                        },
                        "executeOnce": true,
                        "typeVersion": 1
                      }
                    ],
                    "settings": {
                      "executionOrder": "v1",
                      "saveManualExecutions": true,
                      "saveDataErrorExecution": "all",
                      "saveDataSuccessExecution": "all"
                    },
                    "connections": {
                      "Create CRM Lead": {
                        "main": [
                          [
                            {
                              "node": "Schedule Demo Call",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Notify Sales Team",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Fetch Company Data": {
                        "main": [
                          [
                            {
                              "node": "Analyze Company Profile",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Process Signup Data": {
                        "main": [
                          [
                            {
                              "node": "Fetch Company Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Analyze Company Profile": {
                        "main": [
                          [
                            {
                              "node": "Send Personalized Welcome Email",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Track Signup Event",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Create CRM Lead",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Customer Signup Webhook": {
                        "main": [
                          [
                            {
                              "node": "Process Signup Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      }
                    }
                  },
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "setBuildPhases",
                  "phases": [
                    {
                      "type": "trigger",
                      "nodeIds": [
                        "webhook_1"
                      ],
                      "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_1"
                      ],
                      "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                    },
                    {
                      "type": "data_collection",
                      "nodeIds": [
                        "httpRequest_1"
                      ],
                      "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_2"
                      ],
                      "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                    },
                    {
                      "type": "notification",
                      "nodeIds": [
                        "emailSend_1",
                        "segment_1"
                      ],
                      "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                    },
                    {
                      "type": "storage",
                      "nodeIds": [
                        "zohoCrm_1"
                      ],
                      "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                    },
                    {
                      "type": "integration",
                      "nodeIds": [
                        "googleCalendar_1",
                        "slack_1"
                      ],
                      "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                    }
                  ],
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "completePhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "setPhase",
                  "phase": "validation",
                  "timestamp": "2025-08-11T20:24:28.262Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "emailSend_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "zohoCrm_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "googleCalendar_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "slack_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "webhook_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "httpRequest_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "emailSend_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 2,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "zohoCrm_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 2,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "googleCalendar_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 2,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "webhook_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "code_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "httpRequest_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "code_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "emailSend_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "segment_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "zohoCrm_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "googleCalendar_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "slack_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "setWorkflow",
                  "workflow": {
                    "name": "Intelligent Customer Onboarding Workflow",
                    "nodes": [
                      {
                        "id": "webhook_1",
                        "name": "Customer Signup Webhook",
                        "type": "n8n-nodes-base.webhook",
                        "onError": "stopWorkflow",
                        "position": [
                          250,
                          300
                        ],
                        "parameters": {
                          "path": "customer-signup",
                          "options": {},
                          "httpMethod": "POST",
                          "responseMode": "responseNode"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "code_1",
                        "name": "Process Signup Data",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          550,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "httpRequest_1",
                        "name": "Fetch Company Data",
                        "type": "n8n-nodes-base.httpRequest",
                        "onError": "continueErrorOutput",
                        "maxTries": 3,
                        "position": [
                          850,
                          300
                        ],
                        "parameters": {
                          "url": "https://api.clearbit.com/v2/companies/find",
                          "options": {
                            "retry": {
                              "enabled": true,
                              "maxTries": 3
                            },
                            "timeout": 10000
                          },
                          "sendQuery": true,
                          "authentication": "predefinedCredentialType",
                          "queryParameters": {
                            "parameters": [
                              {
                                "name": "domain",
                                "value": "={{ $json.enrichmentQuery.domain }}"
                              }
                            ]
                          },
                          "nodeCredentialType": "clearbitApi"
                        },
                        "retryOnFail": true,
                        "typeVersion": 4.2
                      },
                      {
                        "id": "code_2",
                        "name": "Analyze Company Profile",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          1150,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "emailSend_1",
                        "name": "Send Personalized Welcome Email",
                        "type": "n8n-nodes-base.emailSend",
                        "onError": "continueRegularOutput",
                        "maxTries": 3,
                        "position": [
                          1450,
                          200
                        ],
                        "parameters": {
                          "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                          "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                          "options": {},
                          "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                          "toEmail": "={{ $json.email }}",
                          "fromEmail": "onboarding@company.com"
                        },
                        "typeVersion": 2.1
                      },
                      {
                        "id": "segment_1",
                        "name": "Track Signup Event",
                        "type": "n8n-nodes-base.segment",
                        "onError": "continueRegularOutput",
                        "position": [
                          1450,
                          400
                        ],
                        "parameters": {
                          "event": "Customer Signed Up",
                          "traits": {
                            "tier": "={{ $json.companyProfile.tier }}",
                            "email": "={{ $json.email }}",
                            "company": "={{ $json.company }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "lastName": "={{ $json.lastName }}",
                            "firstName": "={{ $json.firstName }}",
                            "leadScore": "={{ $json.leadScore }}",
                            "companySize": "={{ $json.companyProfile.size }}"
                          },
                          "userId": "={{ $json.email }}",
                          "properties": {
                            "source": "={{ $json.source }}",
                            "demoType": "={{ $json.companyProfile.demoType }}",
                            "signupDate": "={{ $json.signupDate }}",
                            "isHighValue": "={{ $json.isHighValue }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "zohoCrm_1",
                        "name": "Create CRM Lead",
                        "type": "n8n-nodes-base.zohoCrm",
                        "onError": "continueRegularOutput",
                        "position": [
                          1750,
                          300
                        ],
                        "parameters": {
                          "email": "={{ $json.email }}",
                          "phone": "={{ $json.phone }}",
                          "module": "lead",
                          "company": "={{ $json.company }}",
                          "lastName": "={{ $json.lastName }}",
                          "firstName": "={{ $json.firstName }}",
                          "operation": "create",
                          "additionalFields": {
                            "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "leadSource": "Website Signup",
                            "leadStatus": "New",
                            "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "googleCalendar_1",
                        "name": "Schedule Demo Call",
                        "type": "n8n-nodes-base.googleCalendar",
                        "onError": "continueRegularOutput",
                        "position": [
                          2050,
                          200
                        ],
                        "parameters": {
                          "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                          "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                          "options": {
                            "sendNotifications": true
                          },
                          "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                          "attendees": "={{ $json.email }}",
                          "operation": "create",
                          "calendarId": "primary",
                          "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                        },
                        "typeVersion": 1.3
                      },
                      {
                        "id": "slack_1",
                        "name": "Notify Sales Team",
                        "type": "n8n-nodes-base.slack",
                        "onError": "continueRegularOutput",
                        "maxTries": 2,
                        "position": [
                          2050,
                          400
                        ],
                        "parameters": {
                          "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                          "channel": "#sales-alerts",
                          "otherOptions": {
                            "includeLinkToWorkflow": true
                          }
                        },
                        "executeOnce": true,
                        "typeVersion": 2.3
                      }
                    ],
                    "valid": true,
                    "settings": {
                      "executionOrder": "v1",
                      "saveManualExecutions": true,
                      "saveDataErrorExecution": "all",
                      "saveDataSuccessExecution": "all"
                    },
                    "connections": {
                      "Create CRM Lead": {
                        "main": [
                          [
                            {
                              "node": "Schedule Demo Call",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Notify Sales Team",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Fetch Company Data": {
                        "main": [
                          [
                            {
                              "node": "Analyze Company Profile",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Process Signup Data": {
                        "main": [
                          [
                            {
                              "node": "Fetch Company Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Analyze Company Profile": {
                        "main": [
                          [
                            {
                              "node": "Send Personalized Welcome Email",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Track Signup Event",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Create CRM Lead",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Customer Signup Webhook": {
                        "main": [
                          [
                            {
                              "node": "Process Signup Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      }
                    }
                  },
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "completePhase",
                  "phase": "validation",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                }
              ],
              "pendingClarifications": [],
              "clarificationHistory": []
            }
          }
        },
        "removed": [],
        "unchanged": [
          "sessionId",
          "createdAt"
        ]
      }
    },
    "documentation": {
      "name": "Documentation",
      "success": true,
      "metrics": {
        "startTime": 1754943869215,
        "endTime": 1754943869957,
        "duration": 742,
        "memoryUsage": {
          "heapUsed": 1032280,
          "heapTotal": 39895040,
          "external": 8957400
        }
      },
      "logs": [
        {
          "timestamp": "2025-08-11T20:24:29.215Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Starting documentation phase"
        },
        {
          "timestamp": "2025-08-11T20:24:29.216Z",
          "level": "DEBUG",
          "source": "Claude",
          "message": "Sending request for documentation phase"
        },
        {
          "timestamp": "2025-08-11T20:24:29.841Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Added 7 sticky notes for documentation"
        },
        {
          "timestamp": "2025-08-11T20:24:29.956Z",
          "level": "DEBUG",
          "source": "Orchestrator",
          "message": "Session state updated"
        },
        {
          "timestamp": "2025-08-11T20:24:29.957Z",
          "level": "INFO",
          "source": "Orchestrator",
          "message": "Data flow captured: 3 transformations"
        }
      ],
      "nodes": [],
      "sessionState": {
        "sessionId": "complete_e2e_user_test_1754943708795",
        "createdAt": "2025-08-11T20:21:49.129Z",
        "state": {
          "phase": "complete",
          "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
          "discovered": [
            {
              "id": "task_node_1",
              "type": "nodes-base.webhook",
              "config": {
                "path": "webhook",
                "onError": "continueRegularOutput",
                "httpMethod": "POST",
                "responseData": "allEntries",
                "responseMode": "lastNode",
                "alwaysOutputData": true
              },
              "purpose": "Set up a webhook to receive data from external services",
              "displayName": "receive webhook",
              "isPreConfigured": true
            },
            {
              "id": "task_node_5",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                "language": "javaScript"
              },
              "purpose": "Transform data structure using JavaScript",
              "displayName": "transform data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_4",
              "type": "nodes-base.emailSend",
              "config": {
                "text": "",
                "onError": "continueRegularOutput",
                "subject": "",
                "toEmail": "",
                "maxTries": 3,
                "fromEmail": "",
                "retryOnFail": true,
                "alwaysOutputData": true,
                "waitBetweenTries": 3000
              },
              "purpose": "Send an email notification",
              "displayName": "send email",
              "isPreConfigured": true
            },
            {
              "id": "task_node_2",
              "type": "nodes-base.code",
              "config": {
                "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                "onError": "continueRegularOutput",
                "language": "javaScript"
              },
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "displayName": "process webhook data",
              "isPreConfigured": true
            },
            {
              "id": "task_node_6",
              "type": "nodes-base.slack",
              "config": {
                "text": "",
                "channel": "",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "resource": "message",
                "operation": "post",
                "parameters": {},
                "retryOnFail": true,
                "waitBetweenTries": 2000
              },
              "purpose": "Send a message to Slack channel",
              "displayName": "send slack message",
              "isPreConfigured": true
            },
            {
              "id": "task_node_3",
              "type": "nodes-base.httpRequest",
              "config": {
                "url": "",
                "method": "GET",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "retryOnFail": true,
                "sendHeaders": true,
                "authentication": "genericCredentialType",
                "genericAuthType": "headerAuth",
                "alwaysOutputData": true,
                "headerParameters": {
                  "parameters": [
                    {
                      "name": "",
                      "value": ""
                    }
                  ]
                },
                "waitBetweenTries": 2000
              },
              "purpose": "Make an authenticated API request",
              "displayName": "call api with auth",
              "isPreConfigured": true
            },
            {
              "id": "search_node_1",
              "type": "nodes-base.zohoCrm",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
            },
            {
              "id": "search_node_2",
              "type": "nodes-base.googleCalendar",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
            },
            {
              "id": "search_node_3",
              "type": "nodes-base.segment",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
            }
          ],
          "selected": [
            "task_node_1",
            "task_node_5",
            "task_node_4",
            "task_node_2",
            "task_node_6",
            "task_node_3",
            "search_node_1",
            "search_node_2",
            "search_node_3"
          ],
          "configured": {},
          "validated": {},
          "workflow": {
            "name": "Intelligent Customer Onboarding Workflow",
            "nodes": [
              {
                "id": "webhook_1",
                "name": "Customer Signup Webhook",
                "type": "n8n-nodes-base.webhook",
                "onError": "stopWorkflow",
                "position": [
                  250,
                  300
                ],
                "parameters": {
                  "path": "customer-signup",
                  "options": {},
                  "httpMethod": "POST",
                  "responseMode": "responseNode"
                },
                "typeVersion": 2
              },
              {
                "id": "code_1",
                "name": "Process Signup Data",
                "type": "n8n-nodes-base.code",
                "onError": "continueRegularOutput",
                "position": [
                  550,
                  300
                ],
                "parameters": {
                  "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                },
                "typeVersion": 2
              },
              {
                "id": "httpRequest_1",
                "name": "Fetch Company Data",
                "type": "n8n-nodes-base.httpRequest",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "position": [
                  850,
                  300
                ],
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find",
                  "options": {
                    "retry": {
                      "enabled": true,
                      "maxTries": 3
                    },
                    "timeout": 10000
                  },
                  "sendQuery": true,
                  "authentication": "predefinedCredentialType",
                  "queryParameters": {
                    "parameters": [
                      {
                        "name": "domain",
                        "value": "={{ $json.enrichmentQuery.domain }}"
                      }
                    ]
                  },
                  "nodeCredentialType": "clearbitApi"
                },
                "retryOnFail": true,
                "typeVersion": 4.2
              },
              {
                "id": "code_2",
                "name": "Analyze Company Profile",
                "type": "n8n-nodes-base.code",
                "onError": "continueRegularOutput",
                "position": [
                  1150,
                  300
                ],
                "parameters": {
                  "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                },
                "typeVersion": 2
              },
              {
                "id": "emailSend_1",
                "name": "Send Personalized Welcome Email",
                "type": "n8n-nodes-base.emailSend",
                "onError": "continueRegularOutput",
                "maxTries": 3,
                "position": [
                  1450,
                  200
                ],
                "parameters": {
                  "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                  "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                  "options": {},
                  "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                  "toEmail": "={{ $json.email }}",
                  "fromEmail": "onboarding@company.com"
                },
                "typeVersion": 2.1
              },
              {
                "id": "segment_1",
                "name": "Track Signup Event",
                "type": "n8n-nodes-base.segment",
                "onError": "continueRegularOutput",
                "position": [
                  1450,
                  400
                ],
                "parameters": {
                  "event": "Customer Signed Up",
                  "traits": {
                    "tier": "={{ $json.companyProfile.tier }}",
                    "email": "={{ $json.email }}",
                    "company": "={{ $json.company }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "lastName": "={{ $json.lastName }}",
                    "firstName": "={{ $json.firstName }}",
                    "leadScore": "={{ $json.leadScore }}",
                    "companySize": "={{ $json.companyProfile.size }}"
                  },
                  "userId": "={{ $json.email }}",
                  "properties": {
                    "source": "={{ $json.source }}",
                    "demoType": "={{ $json.companyProfile.demoType }}",
                    "signupDate": "={{ $json.signupDate }}",
                    "isHighValue": "={{ $json.isHighValue }}"
                  }
                },
                "typeVersion": 1
              },
              {
                "id": "zohoCrm_1",
                "name": "Create CRM Lead",
                "type": "n8n-nodes-base.zohoCrm",
                "onError": "continueRegularOutput",
                "position": [
                  1750,
                  300
                ],
                "parameters": {
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone }}",
                  "module": "lead",
                  "company": "={{ $json.company }}",
                  "lastName": "={{ $json.lastName }}",
                  "firstName": "={{ $json.firstName }}",
                  "operation": "create",
                  "additionalFields": {
                    "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "leadSource": "Website Signup",
                    "leadStatus": "New",
                    "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                  }
                },
                "typeVersion": 1
              },
              {
                "id": "googleCalendar_1",
                "name": "Schedule Demo Call",
                "type": "n8n-nodes-base.googleCalendar",
                "onError": "continueRegularOutput",
                "position": [
                  2050,
                  200
                ],
                "parameters": {
                  "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                  "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                  "options": {
                    "sendNotifications": true
                  },
                  "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                  "attendees": "={{ $json.email }}",
                  "operation": "create",
                  "calendarId": "primary",
                  "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                },
                "typeVersion": 1.3
              },
              {
                "id": "slack_1",
                "name": "Notify Sales Team",
                "type": "n8n-nodes-base.slack",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "position": [
                  2050,
                  400
                ],
                "parameters": {
                  "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                  "channel": "#sales-alerts",
                  "otherOptions": {
                    "includeLinkToWorkflow": true
                  }
                },
                "executeOnce": true,
                "typeVersion": 2.3
              },
              {
                "id": "sticky_triggers_1754943869352",
                "name": "Triggers Notes",
                "type": "n8n-nodes-base.stickyNote",
                "position": [
                  480,
                  -130
                ],
                "parameters": {
                  "color": 6,
                  "width": 310,
                  "height": 710,
                  "content": "## 📥 Triggers\nWebhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                },
                "typeVersion": 1
              },
              {
                "id": "sticky_transforms_1754943869352",
                "name": "Transform Notes",
                "type": "n8n-nodes-base.stickyNote",
                "position": [
                  890,
                  -130
                ],
                "parameters": {
                  "color": 4,
                  "width": 910,
                  "height": 710,
                  "content": "## ⚙️ Transform\nProcesses and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis.\n\nAnalyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                },
                "typeVersion": 1
              },
              {
                "id": "sticky_inputs_1754943869352",
                "name": "Inputs Notes",
                "type": "n8n-nodes-base.stickyNote",
                "position": [
                  1900,
                  -130
                ],
                "parameters": {
                  "color": 5,
                  "width": 310,
                  "height": 710,
                  "content": "## 📊 Inputs\nFetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                },
                "typeVersion": 1
              },
              {
                "id": "sticky_outputs_1754943869352",
                "name": "Outputs Notes",
                "type": "n8n-nodes-base.stickyNote",
                "position": [
                  2310,
                  -130
                ],
                "parameters": {
                  "color": 7,
                  "width": 310,
                  "height": 710,
                  "content": "## 🚀 Outputs\nSends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                },
                "typeVersion": 1
              },
              {
                "id": "sticky_storage_1754943869352",
                "name": "Storage Notes",
                "type": "n8n-nodes-base.stickyNote",
                "position": [
                  2720,
                  -130
                ],
                "parameters": {
                  "color": 8,
                  "width": 310,
                  "height": 710,
                  "content": "## 💾 Storage\nCreates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                },
                "typeVersion": 1
              },
              {
                "id": "sticky_integration_1754943869352",
                "name": "Integration Notes",
                "type": "n8n-nodes-base.stickyNote",
                "position": [
                  3130,
                  -130
                ],
                "parameters": {
                  "color": 6,
                  "width": 310,
                  "height": 710,
                  "content": "## 🔗 Integration\nSchedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                },
                "typeVersion": 1
              },
              {
                "id": "sticky_promo_1754943869352",
                "name": "Ghost Team Promo",
                "type": "n8n-nodes-base.stickyNote",
                "position": [
                  100,
                  -130
                ],
                "parameters": {
                  "color": 4,
                  "width": 280,
                  "height": 710,
                  "content": "## 🚀 Grow your AI business\n\nNeed help in implementing this workflow for your business? Join the Ghost Team community.\n\nThis workflow is made with 💚 by Ghost Team."
                },
                "typeVersion": 1
              }
            ],
            "valid": true,
            "settings": {
              "executionOrder": "v1",
              "saveManualExecutions": true,
              "saveDataErrorExecution": "all",
              "saveDataSuccessExecution": "all"
            },
            "connections": {
              "Create CRM Lead": {
                "main": [
                  [
                    {
                      "node": "Schedule Demo Call",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Notify Sales Team",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Fetch Company Data": {
                "main": [
                  [
                    {
                      "node": "Analyze Company Profile",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Process Signup Data": {
                "main": [
                  [
                    {
                      "node": "Fetch Company Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Analyze Company Profile": {
                "main": [
                  [
                    {
                      "node": "Send Personalized Welcome Email",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Track Signup Event",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Create CRM Lead",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Customer Signup Webhook": {
                "main": [
                  [
                    {
                      "node": "Process Signup Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              }
            }
          },
          "buildPhases": [
            {
              "type": "trigger",
              "nodeIds": [
                "webhook_1"
              ],
              "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
            },
            {
              "type": "data_processing",
              "nodeIds": [
                "code_1"
              ],
              "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
            },
            {
              "type": "data_collection",
              "nodeIds": [
                "httpRequest_1"
              ],
              "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
            },
            {
              "type": "data_processing",
              "nodeIds": [
                "code_2"
              ],
              "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
            },
            {
              "type": "notification",
              "nodeIds": [
                "emailSend_1",
                "segment_1"
              ],
              "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
            },
            {
              "type": "storage",
              "nodeIds": [
                "zohoCrm_1"
              ],
              "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
            },
            {
              "type": "integration",
              "nodeIds": [
                "googleCalendar_1",
                "slack_1"
              ],
              "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
            }
          ],
          "operationHistory": [
            {
              "node": {
                "id": "task_node_1",
                "type": "nodes-base.webhook",
                "config": {
                  "path": "webhook",
                  "onError": "continueRegularOutput",
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode",
                  "alwaysOutputData": true
                },
                "purpose": "Set up a webhook to receive data from external services",
                "displayName": "receive webhook",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_1",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_5",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                },
                "purpose": "Transform data structure using JavaScript",
                "displayName": "transform data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_5",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_4",
                "type": "nodes-base.emailSend",
                "config": {
                  "text": "",
                  "onError": "continueRegularOutput",
                  "subject": "",
                  "toEmail": "",
                  "maxTries": 3,
                  "fromEmail": "",
                  "retryOnFail": true,
                  "alwaysOutputData": true,
                  "waitBetweenTries": 3000
                },
                "purpose": "Send an email notification",
                "displayName": "send email",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_4",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_2",
                "type": "nodes-base.code",
                "config": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                  "onError": "continueRegularOutput",
                  "language": "javaScript"
                },
                "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                "displayName": "process webhook data",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_2",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_6",
                "type": "nodes-base.slack",
                "config": {
                  "text": "",
                  "channel": "",
                  "onError": "continueRegularOutput",
                  "maxTries": 2,
                  "resource": "message",
                  "operation": "post",
                  "parameters": {},
                  "retryOnFail": true,
                  "waitBetweenTries": 2000
                },
                "purpose": "Send a message to Slack channel",
                "displayName": "send slack message",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_6",
              "timestamp": "2025-08-11T20:22:13.896Z"
            },
            {
              "node": {
                "id": "task_node_3",
                "type": "nodes-base.httpRequest",
                "config": {
                  "url": "",
                  "method": "GET",
                  "onError": "continueErrorOutput",
                  "maxTries": 3,
                  "retryOnFail": true,
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "alwaysOutputData": true,
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "",
                        "value": ""
                      }
                    ]
                  },
                  "waitBetweenTries": 2000
                },
                "purpose": "Make an authenticated API request",
                "displayName": "call api with auth",
                "isPreConfigured": true
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "task_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_1",
                "type": "nodes-base.zohoCrm",
                "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_1",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_2",
                "type": "nodes-base.googleCalendar",
                "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_2",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "node": {
                "id": "search_node_3",
                "type": "nodes-base.segment",
                "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
              },
              "type": "discoverNode",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "selectNode",
              "nodeId": "search_node_3",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "completePhase",
              "phase": "discovery",
              "timestamp": "2025-08-11T20:22:14.164Z"
            },
            {
              "type": "setPhase",
              "phase": "configuration",
              "timestamp": "2025-08-11T20:22:55.179Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                "onError": "continueRegularOutput",
                "parameters": {
                  "path": "customer-signup",
                  "options": {
                    "rawBody": false,
                    "noResponseBody": false
                  },
                  "httpMethod": "POST",
                  "responseData": "allEntries",
                  "responseMode": "lastNode"
                },
                "typeVersion": "1",
                "alwaysOutputData": true
              },
              "nodeId": "task_node_1",
              "purpose": "Set up a webhook to receive data from external services",
              "nodeType": "nodes-base.webhook",
              "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
              "timestamp": "2025-08-11T20:22:55.457Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:55.694Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                "parameters": {
                  "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                  "language": "javaScript"
                }
              },
              "nodeId": "task_node_5",
              "purpose": "Transform data structure using JavaScript",
              "nodeType": "nodes-base.code",
              "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
              "timestamp": "2025-08-11T20:22:55.694Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_5",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:55.939Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                "onError": "continueRegularOutput",
                "maxTries": 3,
                "parameters": {
                  "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                  "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                  "toEmail": "{{ $json.email }}",
                  "fromEmail": "onboarding@company.com"
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "alwaysOutputData": true,
                "waitBetweenTries": 3000
              },
              "nodeId": "task_node_4",
              "purpose": "Send an email notification",
              "nodeType": "nodes-base.emailSend",
              "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
              "timestamp": "2025-08-11T20:22:55.939Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_4",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.169Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                "onError": "continueRegularOutput",
                "parameters": {
                  "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                  "language": "javaScript"
                },
                "typeVersion": "1"
              },
              "nodeId": "task_node_2",
              "purpose": "Process incoming webhook data with Code node (shows correct data access)",
              "nodeType": "nodes-base.code",
              "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
              "timestamp": "2025-08-11T20:22:56.169Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.384Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "parameters": {
                  "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                  "select": "channel",
                  "resource": "message",
                  "channelId": "#sales-escalations",
                  "operation": "post",
                  "parameters": {}
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "waitBetweenTries": 2000
              },
              "nodeId": "task_node_6",
              "purpose": "Send a message to Slack channel",
              "nodeType": "nodes-base.slack",
              "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
              "timestamp": "2025-08-11T20:22:56.384Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_6",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.635Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                "onError": "continueErrorOutput",
                "maxTries": 3,
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                  "method": "GET",
                  "sendHeaders": true,
                  "authentication": "genericCredentialType",
                  "genericAuthType": "headerAuth",
                  "headerParameters": {
                    "parameters": [
                      {
                        "name": "Authorization",
                        "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                      }
                    ]
                  }
                },
                "retryOnFail": true,
                "typeVersion": "1",
                "alwaysOutputData": true,
                "waitBetweenTries": 2000
              },
              "nodeId": "task_node_3",
              "purpose": "Make an authenticated API request",
              "nodeType": "nodes-base.httpRequest",
              "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
              "timestamp": "2025-08-11T20:22:56.635Z",
              "operationIndex": 0,
              "customizedFromTemplate": true
            },
            {
              "type": "validateNode",
              "nodeId": "task_node_3",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:56.793Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                "parameters": {
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                  "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                  "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                  "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                  "resource": "lead",
                  "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                  "operation": "create",
                  "leadSource": "Website Signup",
                  "leadStatus": "New Lead",
                  "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                  "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                },
                "typeVersion": "1"
              },
              "nodeId": "search_node_1",
              "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
              "nodeType": "nodes-base.zohoCrm",
              "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
              "timestamp": "2025-08-11T20:22:56.793Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.034Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                "parameters": {
                  "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                  "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                  "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                  "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                  "resource": "event",
                  "operation": "create",
                  "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                },
                "typeVersion": "1.3"
              },
              "nodeId": "search_node_2",
              "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
              "nodeType": "nodes-base.googleCalendar",
              "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
              "timestamp": "2025-08-11T20:22:57.034Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.270Z"
            },
            {
              "type": "configureNode",
              "config": {
                "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                "parameters": {
                  "event": "{{ $json.eventName || 'engagement_event' }}",
                  "traits": {
                    "phone": "{{ $json.phone }}",
                    "title": "{{ $json.title }}",
                    "company": "{{ $json.company }}",
                    "industry": "{{ $json.industry }}",
                    "lead_status": "{{ $json.leadStatus }}",
                    "company_size": "{{ $json.companySize }}",
                    "last_engagement": "{{ $now }}"
                  },
                  "userId": "{{ $json.userId || $json.email }}",
                  "resource": "track",
                  "operation": "event",
                  "properties": {
                    "value": "{{ $json.value }}",
                    "action": "{{ $json.action }}",
                    "source": "onboarding_workflow",
                    "channel": "{{ $json.channel }}",
                    "industry": "{{ $json.industry }}",
                    "timestamp": "{{ $now }}",
                    "company_size": "{{ $json.companySize }}",
                    "engagement_level": "{{ $json.engagementLevel }}",
                    "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                  }
                },
                "typeVersion": "1"
              },
              "nodeId": "search_node_3",
              "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
              "nodeType": "nodes-base.segment",
              "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
              "timestamp": "2025-08-11T20:22:57.270Z",
              "operationIndex": 0
            },
            {
              "type": "validateNode",
              "nodeId": "search_node_3",
              "result": {
                "valid": true,
                "errors": []
              },
              "timestamp": "2025-08-11T20:22:57.511Z"
            },
            {
              "type": "completePhase",
              "phase": "configuration",
              "timestamp": "2025-08-11T20:22:57.511Z"
            },
            {
              "type": "setPhase",
              "phase": "building",
              "timestamp": "2025-08-11T20:23:53.196Z"
            },
            {
              "type": "setWorkflow",
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.1
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                      "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                      "options": {},
                      "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 1
                  }
                ],
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "timestamp": "2025-08-11T20:23:53.469Z"
            },
            {
              "type": "setBuildPhases",
              "phases": [
                {
                  "type": "trigger",
                  "nodeIds": [
                    "webhook_1"
                  ],
                  "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_1"
                  ],
                  "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                },
                {
                  "type": "data_collection",
                  "nodeIds": [
                    "httpRequest_1"
                  ],
                  "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_2"
                  ],
                  "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                },
                {
                  "type": "notification",
                  "nodeIds": [
                    "emailSend_1",
                    "segment_1"
                  ],
                  "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                },
                {
                  "type": "storage",
                  "nodeIds": [
                    "zohoCrm_1"
                  ],
                  "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                },
                {
                  "type": "integration",
                  "nodeIds": [
                    "googleCalendar_1",
                    "slack_1"
                  ],
                  "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                }
              ],
              "timestamp": "2025-08-11T20:23:53.469Z"
            },
            {
              "type": "completePhase",
              "phase": "building",
              "timestamp": "2025-08-11T20:23:53.469Z"
            },
            {
              "type": "setPhase",
              "phase": "validation",
              "timestamp": "2025-08-11T20:24:28.262Z"
            },
            {
              "type": "validateNode",
              "nodeId": "emailSend_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "zohoCrm_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "googleCalendar_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "slack_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "webhook_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "httpRequest_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 1,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "emailSend_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 2,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "zohoCrm_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 2,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "googleCalendar_1",
              "result": {
                "valid": false,
                "errors": [
                  "Node replaced entirely"
                ]
              },
              "attempt": 2,
              "reasoning": "Node replaced to fix validation errors",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "webhook_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.613Z"
            },
            {
              "type": "validateNode",
              "nodeId": "code_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "httpRequest_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "code_2",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "emailSend_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "segment_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "zohoCrm_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "googleCalendar_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "validateNode",
              "nodeId": "slack_1",
              "result": {
                "valid": true,
                "errors": []
              },
              "attempt": 3,
              "reasoning": "Node passed all validation checks",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "setWorkflow",
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.2
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                      "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                      "options": {},
                      "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2.1
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                    },
                    "typeVersion": 1.3
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 2.3
                  }
                ],
                "valid": true,
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "completePhase",
              "phase": "validation",
              "timestamp": "2025-08-11T20:24:28.888Z"
            },
            {
              "type": "setPhase",
              "phase": "documentation",
              "timestamp": "2025-08-11T20:24:29.352Z"
            },
            {
              "type": "setWorkflow",
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.2
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                      "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                      "options": {},
                      "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2.1
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                    },
                    "typeVersion": 1.3
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 2.3
                  },
                  {
                    "id": "sticky_triggers_1754943869352",
                    "name": "Triggers Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      480,
                      -130
                    ],
                    "parameters": {
                      "color": 6,
                      "width": 310,
                      "height": 710,
                      "content": "## 📥 Triggers\nWebhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_transforms_1754943869352",
                    "name": "Transform Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      890,
                      -130
                    ],
                    "parameters": {
                      "color": 4,
                      "width": 910,
                      "height": 710,
                      "content": "## ⚙️ Transform\nProcesses and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis.\n\nAnalyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_inputs_1754943869352",
                    "name": "Inputs Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      1900,
                      -130
                    ],
                    "parameters": {
                      "color": 5,
                      "width": 310,
                      "height": 710,
                      "content": "## 📊 Inputs\nFetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_outputs_1754943869352",
                    "name": "Outputs Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      2310,
                      -130
                    ],
                    "parameters": {
                      "color": 7,
                      "width": 310,
                      "height": 710,
                      "content": "## 🚀 Outputs\nSends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_storage_1754943869352",
                    "name": "Storage Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      2720,
                      -130
                    ],
                    "parameters": {
                      "color": 8,
                      "width": 310,
                      "height": 710,
                      "content": "## 💾 Storage\nCreates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_integration_1754943869352",
                    "name": "Integration Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      3130,
                      -130
                    ],
                    "parameters": {
                      "color": 6,
                      "width": 310,
                      "height": 710,
                      "content": "## 🔗 Integration\nSchedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_promo_1754943869352",
                    "name": "Ghost Team Promo",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      100,
                      -130
                    ],
                    "parameters": {
                      "color": 4,
                      "width": 280,
                      "height": 710,
                      "content": "## 🚀 Grow your AI business\n\nNeed help in implementing this workflow for your business? Join the Ghost Team community.\n\nThis workflow is made with 💚 by Ghost Team."
                    },
                    "typeVersion": 1
                  }
                ],
                "valid": true,
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "timestamp": "2025-08-11T20:24:29.607Z"
            },
            {
              "type": "completePhase",
              "phase": "documentation",
              "timestamp": "2025-08-11T20:24:29.607Z"
            }
          ],
          "pendingClarifications": [],
          "clarificationHistory": []
        }
      },
      "stateChanges": {},
      "dataFlow": {
        "input": {
          "validatedWorkflow": {
            "name": "Intelligent Customer Onboarding Workflow",
            "nodes": [
              {
                "id": "webhook_1",
                "type": "n8n-nodes-base.webhook",
                "position": [
                  250,
                  300
                ],
                "parameters": {
                  "httpMethod": "POST",
                  "path": "customer-signup",
                  "responseMode": "responseNode",
                  "options": {}
                },
                "name": "Customer Signup Webhook",
                "typeVersion": 2,
                "onError": "stopWorkflow"
              },
              {
                "id": "code_1",
                "type": "n8n-nodes-base.code",
                "position": [
                  550,
                  300
                ],
                "parameters": {
                  "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                },
                "name": "Process Signup Data",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "httpRequest_1",
                "type": "n8n-nodes-base.httpRequest",
                "position": [
                  850,
                  300
                ],
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find",
                  "authentication": "predefinedCredentialType",
                  "nodeCredentialType": "clearbitApi",
                  "sendQuery": true,
                  "queryParameters": {
                    "parameters": [
                      {
                        "name": "domain",
                        "value": "={{ $json.enrichmentQuery.domain }}"
                      }
                    ]
                  },
                  "options": {
                    "timeout": 10000,
                    "retry": {
                      "enabled": true,
                      "maxTries": 3
                    }
                  }
                },
                "name": "Fetch Company Data",
                "typeVersion": 4.2,
                "onError": "continueErrorOutput",
                "retryOnFail": true,
                "maxTries": 3
              },
              {
                "id": "code_2",
                "type": "n8n-nodes-base.code",
                "position": [
                  1150,
                  300
                ],
                "parameters": {
                  "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                },
                "name": "Analyze Company Profile",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "emailSend_1",
                "type": "n8n-nodes-base.emailSend",
                "position": [
                  1450,
                  200
                ],
                "parameters": {
                  "fromEmail": "onboarding@company.com",
                  "toEmail": "={{ $json.email }}",
                  "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                  "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                  "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                  "options": {}
                },
                "name": "Send Personalized Welcome Email",
                "typeVersion": 2.1,
                "onError": "continueRegularOutput",
                "maxTries": 3
              },
              {
                "id": "segment_1",
                "type": "n8n-nodes-base.segment",
                "position": [
                  1450,
                  400
                ],
                "parameters": {
                  "userId": "={{ $json.email }}",
                  "event": "Customer Signed Up",
                  "traits": {
                    "email": "={{ $json.email }}",
                    "firstName": "={{ $json.firstName }}",
                    "lastName": "={{ $json.lastName }}",
                    "company": "={{ $json.company }}",
                    "companySize": "={{ $json.companyProfile.size }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "tier": "={{ $json.companyProfile.tier }}",
                    "leadScore": "={{ $json.leadScore }}"
                  },
                  "properties": {
                    "source": "={{ $json.source }}",
                    "signupDate": "={{ $json.signupDate }}",
                    "isHighValue": "={{ $json.isHighValue }}",
                    "demoType": "={{ $json.companyProfile.demoType }}"
                  }
                },
                "name": "Track Signup Event",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "zohoCrm_1",
                "type": "n8n-nodes-base.zohoCrm",
                "position": [
                  1750,
                  300
                ],
                "parameters": {
                  "operation": "create",
                  "module": "lead",
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone }}",
                  "firstName": "={{ $json.firstName }}",
                  "lastName": "={{ $json.lastName }}",
                  "company": "={{ $json.company }}",
                  "additionalFields": {
                    "leadSource": "Website Signup",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "leadStatus": "New",
                    "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                    "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                  }
                },
                "name": "Create CRM Lead",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "googleCalendar_1",
                "type": "n8n-nodes-base.googleCalendar",
                "position": [
                  2050,
                  200
                ],
                "parameters": {
                  "operation": "create",
                  "calendarId": "primary",
                  "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                  "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                  "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                  "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}",
                  "attendees": "={{ $json.email }}",
                  "options": {
                    "sendNotifications": true
                  }
                },
                "name": "Schedule Demo Call",
                "typeVersion": 1.3,
                "onError": "continueRegularOutput"
              },
              {
                "id": "slack_1",
                "type": "n8n-nodes-base.slack",
                "position": [
                  2050,
                  400
                ],
                "parameters": {
                  "channel": "#sales-alerts",
                  "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                  "otherOptions": {
                    "includeLinkToWorkflow": true
                  }
                },
                "name": "Notify Sales Team",
                "typeVersion": 2.3,
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "executeOnce": true
              }
            ],
            "connections": {
              "Customer Signup Webhook": {
                "main": [
                  [
                    {
                      "node": "Process Signup Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Process Signup Data": {
                "main": [
                  [
                    {
                      "node": "Fetch Company Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Fetch Company Data": {
                "main": [
                  [
                    {
                      "node": "Analyze Company Profile",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Analyze Company Profile": {
                "main": [
                  [
                    {
                      "node": "Send Personalized Welcome Email",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Track Signup Event",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Create CRM Lead",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Create CRM Lead": {
                "main": [
                  [
                    {
                      "node": "Schedule Demo Call",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Notify Sales Team",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              }
            },
            "settings": {
              "executionOrder": "v1",
              "saveDataSuccessExecution": "all",
              "saveDataErrorExecution": "all",
              "saveManualExecutions": true
            },
            "valid": true
          }
        },
        "output": {
          "documentedWorkflow": {
            "name": "Intelligent Customer Onboarding Workflow",
            "nodes": [
              {
                "id": "webhook_1",
                "type": "n8n-nodes-base.webhook",
                "position": [
                  250,
                  300
                ],
                "parameters": {
                  "httpMethod": "POST",
                  "path": "customer-signup",
                  "responseMode": "responseNode",
                  "options": {}
                },
                "name": "Customer Signup Webhook",
                "typeVersion": 2,
                "onError": "stopWorkflow"
              },
              {
                "id": "code_1",
                "type": "n8n-nodes-base.code",
                "position": [
                  550,
                  300
                ],
                "parameters": {
                  "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                },
                "name": "Process Signup Data",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "httpRequest_1",
                "type": "n8n-nodes-base.httpRequest",
                "position": [
                  850,
                  300
                ],
                "parameters": {
                  "url": "https://api.clearbit.com/v2/companies/find",
                  "authentication": "predefinedCredentialType",
                  "nodeCredentialType": "clearbitApi",
                  "sendQuery": true,
                  "queryParameters": {
                    "parameters": [
                      {
                        "name": "domain",
                        "value": "={{ $json.enrichmentQuery.domain }}"
                      }
                    ]
                  },
                  "options": {
                    "timeout": 10000,
                    "retry": {
                      "enabled": true,
                      "maxTries": 3
                    }
                  }
                },
                "name": "Fetch Company Data",
                "typeVersion": 4.2,
                "onError": "continueErrorOutput",
                "retryOnFail": true,
                "maxTries": 3
              },
              {
                "id": "code_2",
                "type": "n8n-nodes-base.code",
                "position": [
                  1150,
                  300
                ],
                "parameters": {
                  "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                },
                "name": "Analyze Company Profile",
                "typeVersion": 2,
                "onError": "continueRegularOutput"
              },
              {
                "id": "emailSend_1",
                "type": "n8n-nodes-base.emailSend",
                "position": [
                  1450,
                  200
                ],
                "parameters": {
                  "fromEmail": "onboarding@company.com",
                  "toEmail": "={{ $json.email }}",
                  "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                  "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                  "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                  "options": {}
                },
                "name": "Send Personalized Welcome Email",
                "typeVersion": 2.1,
                "onError": "continueRegularOutput",
                "maxTries": 3
              },
              {
                "id": "segment_1",
                "type": "n8n-nodes-base.segment",
                "position": [
                  1450,
                  400
                ],
                "parameters": {
                  "userId": "={{ $json.email }}",
                  "event": "Customer Signed Up",
                  "traits": {
                    "email": "={{ $json.email }}",
                    "firstName": "={{ $json.firstName }}",
                    "lastName": "={{ $json.lastName }}",
                    "company": "={{ $json.company }}",
                    "companySize": "={{ $json.companyProfile.size }}",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "tier": "={{ $json.companyProfile.tier }}",
                    "leadScore": "={{ $json.leadScore }}"
                  },
                  "properties": {
                    "source": "={{ $json.source }}",
                    "signupDate": "={{ $json.signupDate }}",
                    "isHighValue": "={{ $json.isHighValue }}",
                    "demoType": "={{ $json.companyProfile.demoType }}"
                  }
                },
                "name": "Track Signup Event",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "zohoCrm_1",
                "type": "n8n-nodes-base.zohoCrm",
                "position": [
                  1750,
                  300
                ],
                "parameters": {
                  "operation": "create",
                  "module": "lead",
                  "email": "={{ $json.email }}",
                  "phone": "={{ $json.phone }}",
                  "firstName": "={{ $json.firstName }}",
                  "lastName": "={{ $json.lastName }}",
                  "company": "={{ $json.company }}",
                  "additionalFields": {
                    "leadSource": "Website Signup",
                    "industry": "={{ $json.companyProfile.industry }}",
                    "leadStatus": "New",
                    "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                    "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                  }
                },
                "name": "Create CRM Lead",
                "typeVersion": 1,
                "onError": "continueRegularOutput"
              },
              {
                "id": "googleCalendar_1",
                "type": "n8n-nodes-base.googleCalendar",
                "position": [
                  2050,
                  200
                ],
                "parameters": {
                  "operation": "create",
                  "calendarId": "primary",
                  "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                  "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                  "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                  "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}",
                  "attendees": "={{ $json.email }}",
                  "options": {
                    "sendNotifications": true
                  }
                },
                "name": "Schedule Demo Call",
                "typeVersion": 1.3,
                "onError": "continueRegularOutput"
              },
              {
                "id": "slack_1",
                "type": "n8n-nodes-base.slack",
                "position": [
                  2050,
                  400
                ],
                "parameters": {
                  "channel": "#sales-alerts",
                  "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                  "otherOptions": {
                    "includeLinkToWorkflow": true
                  }
                },
                "name": "Notify Sales Team",
                "typeVersion": 2.3,
                "onError": "continueRegularOutput",
                "maxTries": 2,
                "executeOnce": true
              },
              {
                "id": "sticky_triggers_1754943869352",
                "name": "Triggers Notes",
                "type": "n8n-nodes-base.stickyNote",
                "typeVersion": 1,
                "position": [
                  480,
                  -130
                ],
                "parameters": {
                  "content": "## 📥 Triggers\nWebhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations.",
                  "height": 710,
                  "width": 310,
                  "color": 6
                }
              },
              {
                "id": "sticky_transforms_1754943869352",
                "name": "Transform Notes",
                "type": "n8n-nodes-base.stickyNote",
                "typeVersion": 1,
                "position": [
                  890,
                  -130
                ],
                "parameters": {
                  "content": "## ⚙️ Transform\nProcesses and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis.\n\nAnalyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation.",
                  "height": 710,
                  "width": 910,
                  "color": 4
                }
              },
              {
                "id": "sticky_inputs_1754943869352",
                "name": "Inputs Notes",
                "type": "n8n-nodes-base.stickyNote",
                "typeVersion": 1,
                "position": [
                  1900,
                  -130
                ],
                "parameters": {
                  "content": "## 📊 Inputs\nFetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization.",
                  "height": 710,
                  "width": 310,
                  "color": 5
                }
              },
              {
                "id": "sticky_outputs_1754943869352",
                "name": "Outputs Notes",
                "type": "n8n-nodes-base.stickyNote",
                "typeVersion": 1,
                "position": [
                  2310,
                  -130
                ],
                "parameters": {
                  "content": "## 🚀 Outputs\nSends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building.",
                  "height": 710,
                  "width": 310,
                  "color": 7
                }
              },
              {
                "id": "sticky_storage_1754943869352",
                "name": "Storage Notes",
                "type": "n8n-nodes-base.stickyNote",
                "typeVersion": 1,
                "position": [
                  2720,
                  -130
                ],
                "parameters": {
                  "content": "## 💾 Storage\nCreates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up.",
                  "height": 710,
                  "width": 310,
                  "color": 8
                }
              },
              {
                "id": "sticky_integration_1754943869352",
                "name": "Integration Notes",
                "type": "n8n-nodes-base.stickyNote",
                "typeVersion": 1,
                "position": [
                  3130,
                  -130
                ],
                "parameters": {
                  "content": "## 🔗 Integration\nSchedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention.",
                  "height": 710,
                  "width": 310,
                  "color": 6
                }
              },
              {
                "id": "sticky_promo_1754943869352",
                "name": "Ghost Team Promo",
                "type": "n8n-nodes-base.stickyNote",
                "typeVersion": 1,
                "position": [
                  100,
                  -130
                ],
                "parameters": {
                  "content": "## 🚀 Grow your AI business\n\nNeed help in implementing this workflow for your business? Join the Ghost Team community.\n\nThis workflow is made with 💚 by Ghost Team.",
                  "height": 710,
                  "width": 280,
                  "color": 4
                }
              }
            ],
            "connections": {
              "Customer Signup Webhook": {
                "main": [
                  [
                    {
                      "node": "Process Signup Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Process Signup Data": {
                "main": [
                  [
                    {
                      "node": "Fetch Company Data",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Fetch Company Data": {
                "main": [
                  [
                    {
                      "node": "Analyze Company Profile",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Analyze Company Profile": {
                "main": [
                  [
                    {
                      "node": "Send Personalized Welcome Email",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Track Signup Event",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Create CRM Lead",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              },
              "Create CRM Lead": {
                "main": [
                  [
                    {
                      "node": "Schedule Demo Call",
                      "type": "main",
                      "index": 0
                    },
                    {
                      "node": "Notify Sales Team",
                      "type": "main",
                      "index": 0
                    }
                  ]
                ]
              }
            },
            "settings": {
              "executionOrder": "v1",
              "saveDataSuccessExecution": "all",
              "saveDataErrorExecution": "all",
              "saveManualExecutions": true
            },
            "valid": true
          },
          "stickyNotesAdded": 7
        },
        "transformations": [
          "Documentation Generation",
          "Sticky Note Placement",
          "Workflow Finalization"
        ]
      },
      "stateDelta": {
        "added": {},
        "modified": {
          "state": {
            "old": {
              "phase": "documentation",
              "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
              "discovered": [
                {
                  "id": "task_node_1",
                  "type": "nodes-base.webhook",
                  "config": {
                    "path": "webhook",
                    "onError": "continueRegularOutput",
                    "httpMethod": "POST",
                    "responseData": "allEntries",
                    "responseMode": "lastNode",
                    "alwaysOutputData": true
                  },
                  "purpose": "Set up a webhook to receive data from external services",
                  "displayName": "receive webhook",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_5",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                    "language": "javaScript"
                  },
                  "purpose": "Transform data structure using JavaScript",
                  "displayName": "transform data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_4",
                  "type": "nodes-base.emailSend",
                  "config": {
                    "text": "",
                    "onError": "continueRegularOutput",
                    "subject": "",
                    "toEmail": "",
                    "maxTries": 3,
                    "fromEmail": "",
                    "retryOnFail": true,
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "purpose": "Send an email notification",
                  "displayName": "send email",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_2",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                    "onError": "continueRegularOutput",
                    "language": "javaScript"
                  },
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "displayName": "process webhook data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_6",
                  "type": "nodes-base.slack",
                  "config": {
                    "text": "",
                    "channel": "",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "resource": "message",
                    "operation": "post",
                    "parameters": {},
                    "retryOnFail": true,
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Send a message to Slack channel",
                  "displayName": "send slack message",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_3",
                  "type": "nodes-base.httpRequest",
                  "config": {
                    "url": "",
                    "method": "GET",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "retryOnFail": true,
                    "sendHeaders": true,
                    "authentication": "genericCredentialType",
                    "genericAuthType": "headerAuth",
                    "alwaysOutputData": true,
                    "headerParameters": {
                      "parameters": [
                        {
                          "name": "",
                          "value": ""
                        }
                      ]
                    },
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Make an authenticated API request",
                  "displayName": "call api with auth",
                  "isPreConfigured": true
                },
                {
                  "id": "search_node_1",
                  "type": "nodes-base.zohoCrm",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                },
                {
                  "id": "search_node_2",
                  "type": "nodes-base.googleCalendar",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                },
                {
                  "id": "search_node_3",
                  "type": "nodes-base.segment",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                }
              ],
              "selected": [
                "task_node_1",
                "task_node_5",
                "task_node_4",
                "task_node_2",
                "task_node_6",
                "task_node_3",
                "search_node_1",
                "search_node_2",
                "search_node_3"
              ],
              "configured": {},
              "validated": {},
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.2
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                      "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                      "options": {},
                      "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2.1
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                    },
                    "typeVersion": 1.3
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 2.3
                  }
                ],
                "valid": true,
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "buildPhases": [
                {
                  "type": "trigger",
                  "nodeIds": [
                    "webhook_1"
                  ],
                  "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_1"
                  ],
                  "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                },
                {
                  "type": "data_collection",
                  "nodeIds": [
                    "httpRequest_1"
                  ],
                  "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_2"
                  ],
                  "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                },
                {
                  "type": "notification",
                  "nodeIds": [
                    "emailSend_1",
                    "segment_1"
                  ],
                  "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                },
                {
                  "type": "storage",
                  "nodeIds": [
                    "zohoCrm_1"
                  ],
                  "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                },
                {
                  "type": "integration",
                  "nodeIds": [
                    "googleCalendar_1",
                    "slack_1"
                  ],
                  "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                }
              ],
              "operationHistory": [
                {
                  "node": {
                    "id": "task_node_1",
                    "type": "nodes-base.webhook",
                    "config": {
                      "path": "webhook",
                      "onError": "continueRegularOutput",
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode",
                      "alwaysOutputData": true
                    },
                    "purpose": "Set up a webhook to receive data from external services",
                    "displayName": "receive webhook",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_1",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_5",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    },
                    "purpose": "Transform data structure using JavaScript",
                    "displayName": "transform data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_5",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_4",
                    "type": "nodes-base.emailSend",
                    "config": {
                      "text": "",
                      "onError": "continueRegularOutput",
                      "subject": "",
                      "toEmail": "",
                      "maxTries": 3,
                      "fromEmail": "",
                      "retryOnFail": true,
                      "alwaysOutputData": true,
                      "waitBetweenTries": 3000
                    },
                    "purpose": "Send an email notification",
                    "displayName": "send email",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_4",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_2",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                      "onError": "continueRegularOutput",
                      "language": "javaScript"
                    },
                    "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                    "displayName": "process webhook data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_2",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_6",
                    "type": "nodes-base.slack",
                    "config": {
                      "text": "",
                      "channel": "",
                      "onError": "continueRegularOutput",
                      "maxTries": 2,
                      "resource": "message",
                      "operation": "post",
                      "parameters": {},
                      "retryOnFail": true,
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Send a message to Slack channel",
                    "displayName": "send slack message",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_6",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_3",
                    "type": "nodes-base.httpRequest",
                    "config": {
                      "url": "",
                      "method": "GET",
                      "onError": "continueErrorOutput",
                      "maxTries": 3,
                      "retryOnFail": true,
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "alwaysOutputData": true,
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ]
                      },
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Make an authenticated API request",
                    "displayName": "call api with auth",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_1",
                    "type": "nodes-base.zohoCrm",
                    "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_1",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_2",
                    "type": "nodes-base.googleCalendar",
                    "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_2",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_3",
                    "type": "nodes-base.segment",
                    "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "completePhase",
                  "phase": "discovery",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "setPhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:55.179Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "path": "customer-signup",
                      "options": {
                        "rawBody": false,
                        "noResponseBody": false
                      },
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode"
                    },
                    "typeVersion": "1",
                    "alwaysOutputData": true
                  },
                  "nodeId": "task_node_1",
                  "purpose": "Set up a webhook to receive data from external services",
                  "nodeType": "nodes-base.webhook",
                  "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
                  "timestamp": "2025-08-11T20:22:55.457Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.694Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                    "parameters": {
                      "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    }
                  },
                  "nodeId": "task_node_5",
                  "purpose": "Transform data structure using JavaScript",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
                  "timestamp": "2025-08-11T20:22:55.694Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_5",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.939Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "parameters": {
                      "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                      "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                      "toEmail": "{{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "nodeId": "task_node_4",
                  "purpose": "Send an email notification",
                  "nodeType": "nodes-base.emailSend",
                  "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
                  "timestamp": "2025-08-11T20:22:55.939Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_4",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.169Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                      "language": "javaScript"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "task_node_2",
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
                  "timestamp": "2025-08-11T20:22:56.169Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.384Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "parameters": {
                      "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                      "select": "channel",
                      "resource": "message",
                      "channelId": "#sales-escalations",
                      "operation": "post",
                      "parameters": {}
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_6",
                  "purpose": "Send a message to Slack channel",
                  "nodeType": "nodes-base.slack",
                  "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
                  "timestamp": "2025-08-11T20:22:56.384Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_6",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.635Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                      "method": "GET",
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "Authorization",
                            "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                          }
                        ]
                      }
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_3",
                  "purpose": "Make an authenticated API request",
                  "nodeType": "nodes-base.httpRequest",
                  "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
                  "timestamp": "2025-08-11T20:22:56.635Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.793Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                      "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                      "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                      "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                      "resource": "lead",
                      "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                      "operation": "create",
                      "leadSource": "Website Signup",
                      "leadStatus": "New Lead",
                      "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                      "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_1",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
                  "nodeType": "nodes-base.zohoCrm",
                  "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:56.793Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.034Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                    "parameters": {
                      "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                      "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                      "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                      "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                      "resource": "event",
                      "operation": "create",
                      "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                    },
                    "typeVersion": "1.3"
                  },
                  "nodeId": "search_node_2",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
                  "nodeType": "nodes-base.googleCalendar",
                  "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.034Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.270Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                    "parameters": {
                      "event": "{{ $json.eventName || 'engagement_event' }}",
                      "traits": {
                        "phone": "{{ $json.phone }}",
                        "title": "{{ $json.title }}",
                        "company": "{{ $json.company }}",
                        "industry": "{{ $json.industry }}",
                        "lead_status": "{{ $json.leadStatus }}",
                        "company_size": "{{ $json.companySize }}",
                        "last_engagement": "{{ $now }}"
                      },
                      "userId": "{{ $json.userId || $json.email }}",
                      "resource": "track",
                      "operation": "event",
                      "properties": {
                        "value": "{{ $json.value }}",
                        "action": "{{ $json.action }}",
                        "source": "onboarding_workflow",
                        "channel": "{{ $json.channel }}",
                        "industry": "{{ $json.industry }}",
                        "timestamp": "{{ $now }}",
                        "company_size": "{{ $json.companySize }}",
                        "engagement_level": "{{ $json.engagementLevel }}",
                        "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                      }
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_3",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
                  "nodeType": "nodes-base.segment",
                  "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.270Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "completePhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "setPhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.196Z"
                },
                {
                  "type": "setWorkflow",
                  "workflow": {
                    "name": "Intelligent Customer Onboarding Workflow",
                    "nodes": [
                      {
                        "id": "webhook_1",
                        "name": "Customer Signup Webhook",
                        "type": "n8n-nodes-base.webhook",
                        "onError": "stopWorkflow",
                        "position": [
                          250,
                          300
                        ],
                        "parameters": {
                          "path": "customer-signup",
                          "options": {},
                          "httpMethod": "POST",
                          "responseMode": "responseNode"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "code_1",
                        "name": "Process Signup Data",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          550,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "httpRequest_1",
                        "name": "Fetch Company Data",
                        "type": "n8n-nodes-base.httpRequest",
                        "onError": "continueErrorOutput",
                        "maxTries": 3,
                        "position": [
                          850,
                          300
                        ],
                        "parameters": {
                          "url": "https://api.clearbit.com/v2/companies/find",
                          "options": {
                            "retry": {
                              "enabled": true,
                              "maxTries": 3
                            },
                            "timeout": 10000
                          },
                          "sendQuery": true,
                          "authentication": "predefinedCredentialType",
                          "queryParameters": {
                            "parameters": [
                              {
                                "name": "domain",
                                "value": "={{ $json.enrichmentQuery.domain }}"
                              }
                            ]
                          },
                          "nodeCredentialType": "clearbitApi"
                        },
                        "retryOnFail": true,
                        "typeVersion": 4.1
                      },
                      {
                        "id": "code_2",
                        "name": "Analyze Company Profile",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          1150,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "emailSend_1",
                        "name": "Send Personalized Welcome Email",
                        "type": "n8n-nodes-base.emailSend",
                        "onError": "continueRegularOutput",
                        "maxTries": 3,
                        "position": [
                          1450,
                          200
                        ],
                        "parameters": {
                          "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                          "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                          "options": {},
                          "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                          "toEmail": "={{ $json.email }}",
                          "fromEmail": "onboarding@company.com"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "segment_1",
                        "name": "Track Signup Event",
                        "type": "n8n-nodes-base.segment",
                        "onError": "continueRegularOutput",
                        "position": [
                          1450,
                          400
                        ],
                        "parameters": {
                          "event": "Customer Signed Up",
                          "traits": {
                            "tier": "={{ $json.companyProfile.tier }}",
                            "email": "={{ $json.email }}",
                            "company": "={{ $json.company }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "lastName": "={{ $json.lastName }}",
                            "firstName": "={{ $json.firstName }}",
                            "leadScore": "={{ $json.leadScore }}",
                            "companySize": "={{ $json.companyProfile.size }}"
                          },
                          "userId": "={{ $json.email }}",
                          "properties": {
                            "source": "={{ $json.source }}",
                            "demoType": "={{ $json.companyProfile.demoType }}",
                            "signupDate": "={{ $json.signupDate }}",
                            "isHighValue": "={{ $json.isHighValue }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "zohoCrm_1",
                        "name": "Create CRM Lead",
                        "type": "n8n-nodes-base.zohoCrm",
                        "onError": "continueRegularOutput",
                        "position": [
                          1750,
                          300
                        ],
                        "parameters": {
                          "email": "={{ $json.email }}",
                          "phone": "={{ $json.phone }}",
                          "module": "lead",
                          "company": "={{ $json.company }}",
                          "lastName": "={{ $json.lastName }}",
                          "firstName": "={{ $json.firstName }}",
                          "operation": "create",
                          "additionalFields": {
                            "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "leadSource": "Website Signup",
                            "leadStatus": "New",
                            "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "googleCalendar_1",
                        "name": "Schedule Demo Call",
                        "type": "n8n-nodes-base.googleCalendar",
                        "onError": "continueRegularOutput",
                        "position": [
                          2050,
                          200
                        ],
                        "parameters": {
                          "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                          "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                          "options": {
                            "sendNotifications": true
                          },
                          "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                          "attendees": "={{ $json.email }}",
                          "operation": "create",
                          "calendarId": "primary",
                          "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "slack_1",
                        "name": "Notify Sales Team",
                        "type": "n8n-nodes-base.slack",
                        "onError": "continueRegularOutput",
                        "maxTries": 2,
                        "position": [
                          2050,
                          400
                        ],
                        "parameters": {
                          "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                          "channel": "#sales-alerts",
                          "otherOptions": {
                            "includeLinkToWorkflow": true
                          }
                        },
                        "executeOnce": true,
                        "typeVersion": 1
                      }
                    ],
                    "settings": {
                      "executionOrder": "v1",
                      "saveManualExecutions": true,
                      "saveDataErrorExecution": "all",
                      "saveDataSuccessExecution": "all"
                    },
                    "connections": {
                      "Create CRM Lead": {
                        "main": [
                          [
                            {
                              "node": "Schedule Demo Call",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Notify Sales Team",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Fetch Company Data": {
                        "main": [
                          [
                            {
                              "node": "Analyze Company Profile",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Process Signup Data": {
                        "main": [
                          [
                            {
                              "node": "Fetch Company Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Analyze Company Profile": {
                        "main": [
                          [
                            {
                              "node": "Send Personalized Welcome Email",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Track Signup Event",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Create CRM Lead",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Customer Signup Webhook": {
                        "main": [
                          [
                            {
                              "node": "Process Signup Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      }
                    }
                  },
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "setBuildPhases",
                  "phases": [
                    {
                      "type": "trigger",
                      "nodeIds": [
                        "webhook_1"
                      ],
                      "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_1"
                      ],
                      "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                    },
                    {
                      "type": "data_collection",
                      "nodeIds": [
                        "httpRequest_1"
                      ],
                      "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_2"
                      ],
                      "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                    },
                    {
                      "type": "notification",
                      "nodeIds": [
                        "emailSend_1",
                        "segment_1"
                      ],
                      "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                    },
                    {
                      "type": "storage",
                      "nodeIds": [
                        "zohoCrm_1"
                      ],
                      "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                    },
                    {
                      "type": "integration",
                      "nodeIds": [
                        "googleCalendar_1",
                        "slack_1"
                      ],
                      "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                    }
                  ],
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "completePhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "setPhase",
                  "phase": "validation",
                  "timestamp": "2025-08-11T20:24:28.262Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "emailSend_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "zohoCrm_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "googleCalendar_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "slack_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "webhook_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "httpRequest_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "emailSend_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 2,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "zohoCrm_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 2,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "googleCalendar_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 2,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "webhook_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "code_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "httpRequest_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "code_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "emailSend_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "segment_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "zohoCrm_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "googleCalendar_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "slack_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "setWorkflow",
                  "workflow": {
                    "name": "Intelligent Customer Onboarding Workflow",
                    "nodes": [
                      {
                        "id": "webhook_1",
                        "name": "Customer Signup Webhook",
                        "type": "n8n-nodes-base.webhook",
                        "onError": "stopWorkflow",
                        "position": [
                          250,
                          300
                        ],
                        "parameters": {
                          "path": "customer-signup",
                          "options": {},
                          "httpMethod": "POST",
                          "responseMode": "responseNode"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "code_1",
                        "name": "Process Signup Data",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          550,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "httpRequest_1",
                        "name": "Fetch Company Data",
                        "type": "n8n-nodes-base.httpRequest",
                        "onError": "continueErrorOutput",
                        "maxTries": 3,
                        "position": [
                          850,
                          300
                        ],
                        "parameters": {
                          "url": "https://api.clearbit.com/v2/companies/find",
                          "options": {
                            "retry": {
                              "enabled": true,
                              "maxTries": 3
                            },
                            "timeout": 10000
                          },
                          "sendQuery": true,
                          "authentication": "predefinedCredentialType",
                          "queryParameters": {
                            "parameters": [
                              {
                                "name": "domain",
                                "value": "={{ $json.enrichmentQuery.domain }}"
                              }
                            ]
                          },
                          "nodeCredentialType": "clearbitApi"
                        },
                        "retryOnFail": true,
                        "typeVersion": 4.2
                      },
                      {
                        "id": "code_2",
                        "name": "Analyze Company Profile",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          1150,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "emailSend_1",
                        "name": "Send Personalized Welcome Email",
                        "type": "n8n-nodes-base.emailSend",
                        "onError": "continueRegularOutput",
                        "maxTries": 3,
                        "position": [
                          1450,
                          200
                        ],
                        "parameters": {
                          "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                          "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                          "options": {},
                          "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                          "toEmail": "={{ $json.email }}",
                          "fromEmail": "onboarding@company.com"
                        },
                        "typeVersion": 2.1
                      },
                      {
                        "id": "segment_1",
                        "name": "Track Signup Event",
                        "type": "n8n-nodes-base.segment",
                        "onError": "continueRegularOutput",
                        "position": [
                          1450,
                          400
                        ],
                        "parameters": {
                          "event": "Customer Signed Up",
                          "traits": {
                            "tier": "={{ $json.companyProfile.tier }}",
                            "email": "={{ $json.email }}",
                            "company": "={{ $json.company }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "lastName": "={{ $json.lastName }}",
                            "firstName": "={{ $json.firstName }}",
                            "leadScore": "={{ $json.leadScore }}",
                            "companySize": "={{ $json.companyProfile.size }}"
                          },
                          "userId": "={{ $json.email }}",
                          "properties": {
                            "source": "={{ $json.source }}",
                            "demoType": "={{ $json.companyProfile.demoType }}",
                            "signupDate": "={{ $json.signupDate }}",
                            "isHighValue": "={{ $json.isHighValue }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "zohoCrm_1",
                        "name": "Create CRM Lead",
                        "type": "n8n-nodes-base.zohoCrm",
                        "onError": "continueRegularOutput",
                        "position": [
                          1750,
                          300
                        ],
                        "parameters": {
                          "email": "={{ $json.email }}",
                          "phone": "={{ $json.phone }}",
                          "module": "lead",
                          "company": "={{ $json.company }}",
                          "lastName": "={{ $json.lastName }}",
                          "firstName": "={{ $json.firstName }}",
                          "operation": "create",
                          "additionalFields": {
                            "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "leadSource": "Website Signup",
                            "leadStatus": "New",
                            "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "googleCalendar_1",
                        "name": "Schedule Demo Call",
                        "type": "n8n-nodes-base.googleCalendar",
                        "onError": "continueRegularOutput",
                        "position": [
                          2050,
                          200
                        ],
                        "parameters": {
                          "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                          "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                          "options": {
                            "sendNotifications": true
                          },
                          "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                          "attendees": "={{ $json.email }}",
                          "operation": "create",
                          "calendarId": "primary",
                          "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                        },
                        "typeVersion": 1.3
                      },
                      {
                        "id": "slack_1",
                        "name": "Notify Sales Team",
                        "type": "n8n-nodes-base.slack",
                        "onError": "continueRegularOutput",
                        "maxTries": 2,
                        "position": [
                          2050,
                          400
                        ],
                        "parameters": {
                          "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                          "channel": "#sales-alerts",
                          "otherOptions": {
                            "includeLinkToWorkflow": true
                          }
                        },
                        "executeOnce": true,
                        "typeVersion": 2.3
                      }
                    ],
                    "valid": true,
                    "settings": {
                      "executionOrder": "v1",
                      "saveManualExecutions": true,
                      "saveDataErrorExecution": "all",
                      "saveDataSuccessExecution": "all"
                    },
                    "connections": {
                      "Create CRM Lead": {
                        "main": [
                          [
                            {
                              "node": "Schedule Demo Call",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Notify Sales Team",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Fetch Company Data": {
                        "main": [
                          [
                            {
                              "node": "Analyze Company Profile",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Process Signup Data": {
                        "main": [
                          [
                            {
                              "node": "Fetch Company Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Analyze Company Profile": {
                        "main": [
                          [
                            {
                              "node": "Send Personalized Welcome Email",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Track Signup Event",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Create CRM Lead",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Customer Signup Webhook": {
                        "main": [
                          [
                            {
                              "node": "Process Signup Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      }
                    }
                  },
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "completePhase",
                  "phase": "validation",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                }
              ],
              "pendingClarifications": [],
              "clarificationHistory": []
            },
            "new": {
              "phase": "complete",
              "userPrompt": "Create an intelligent customer onboarding workflow that triggers when someone signs up, analyzes their company data via APIs, personalizes email sequences based on industry/size, schedules appropriate demo calls, tracks engagement across multiple channels, automatically escalates high-value prospects, and hands off qualified leads to sales with complete context.",
              "discovered": [
                {
                  "id": "task_node_1",
                  "type": "nodes-base.webhook",
                  "config": {
                    "path": "webhook",
                    "onError": "continueRegularOutput",
                    "httpMethod": "POST",
                    "responseData": "allEntries",
                    "responseMode": "lastNode",
                    "alwaysOutputData": true
                  },
                  "purpose": "Set up a webhook to receive data from external services",
                  "displayName": "receive webhook",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_5",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                    "language": "javaScript"
                  },
                  "purpose": "Transform data structure using JavaScript",
                  "displayName": "transform data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_4",
                  "type": "nodes-base.emailSend",
                  "config": {
                    "text": "",
                    "onError": "continueRegularOutput",
                    "subject": "",
                    "toEmail": "",
                    "maxTries": 3,
                    "fromEmail": "",
                    "retryOnFail": true,
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "purpose": "Send an email notification",
                  "displayName": "send email",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_2",
                  "type": "nodes-base.code",
                  "config": {
                    "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                    "onError": "continueRegularOutput",
                    "language": "javaScript"
                  },
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "displayName": "process webhook data",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_6",
                  "type": "nodes-base.slack",
                  "config": {
                    "text": "",
                    "channel": "",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "resource": "message",
                    "operation": "post",
                    "parameters": {},
                    "retryOnFail": true,
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Send a message to Slack channel",
                  "displayName": "send slack message",
                  "isPreConfigured": true
                },
                {
                  "id": "task_node_3",
                  "type": "nodes-base.httpRequest",
                  "config": {
                    "url": "",
                    "method": "GET",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "retryOnFail": true,
                    "sendHeaders": true,
                    "authentication": "genericCredentialType",
                    "genericAuthType": "headerAuth",
                    "alwaysOutputData": true,
                    "headerParameters": {
                      "parameters": [
                        {
                          "name": "",
                          "value": ""
                        }
                      ]
                    },
                    "waitBetweenTries": 2000
                  },
                  "purpose": "Make an authenticated API request",
                  "displayName": "call api with auth",
                  "isPreConfigured": true
                },
                {
                  "id": "search_node_1",
                  "type": "nodes-base.zohoCrm",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                },
                {
                  "id": "search_node_2",
                  "type": "nodes-base.googleCalendar",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                },
                {
                  "id": "search_node_3",
                  "type": "nodes-base.segment",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                }
              ],
              "selected": [
                "task_node_1",
                "task_node_5",
                "task_node_4",
                "task_node_2",
                "task_node_6",
                "task_node_3",
                "search_node_1",
                "search_node_2",
                "search_node_3"
              ],
              "configured": {},
              "validated": {},
              "workflow": {
                "name": "Intelligent Customer Onboarding Workflow",
                "nodes": [
                  {
                    "id": "webhook_1",
                    "name": "Customer Signup Webhook",
                    "type": "n8n-nodes-base.webhook",
                    "onError": "stopWorkflow",
                    "position": [
                      250,
                      300
                    ],
                    "parameters": {
                      "path": "customer-signup",
                      "options": {},
                      "httpMethod": "POST",
                      "responseMode": "responseNode"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "code_1",
                    "name": "Process Signup Data",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      550,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "httpRequest_1",
                    "name": "Fetch Company Data",
                    "type": "n8n-nodes-base.httpRequest",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "position": [
                      850,
                      300
                    ],
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find",
                      "options": {
                        "retry": {
                          "enabled": true,
                          "maxTries": 3
                        },
                        "timeout": 10000
                      },
                      "sendQuery": true,
                      "authentication": "predefinedCredentialType",
                      "queryParameters": {
                        "parameters": [
                          {
                            "name": "domain",
                            "value": "={{ $json.enrichmentQuery.domain }}"
                          }
                        ]
                      },
                      "nodeCredentialType": "clearbitApi"
                    },
                    "retryOnFail": true,
                    "typeVersion": 4.2
                  },
                  {
                    "id": "code_2",
                    "name": "Analyze Company Profile",
                    "type": "n8n-nodes-base.code",
                    "onError": "continueRegularOutput",
                    "position": [
                      1150,
                      300
                    ],
                    "parameters": {
                      "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                    },
                    "typeVersion": 2
                  },
                  {
                    "id": "emailSend_1",
                    "name": "Send Personalized Welcome Email",
                    "type": "n8n-nodes-base.emailSend",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "position": [
                      1450,
                      200
                    ],
                    "parameters": {
                      "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                      "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                      "options": {},
                      "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                      "toEmail": "={{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "typeVersion": 2.1
                  },
                  {
                    "id": "segment_1",
                    "name": "Track Signup Event",
                    "type": "n8n-nodes-base.segment",
                    "onError": "continueRegularOutput",
                    "position": [
                      1450,
                      400
                    ],
                    "parameters": {
                      "event": "Customer Signed Up",
                      "traits": {
                        "tier": "={{ $json.companyProfile.tier }}",
                        "email": "={{ $json.email }}",
                        "company": "={{ $json.company }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "lastName": "={{ $json.lastName }}",
                        "firstName": "={{ $json.firstName }}",
                        "leadScore": "={{ $json.leadScore }}",
                        "companySize": "={{ $json.companyProfile.size }}"
                      },
                      "userId": "={{ $json.email }}",
                      "properties": {
                        "source": "={{ $json.source }}",
                        "demoType": "={{ $json.companyProfile.demoType }}",
                        "signupDate": "={{ $json.signupDate }}",
                        "isHighValue": "={{ $json.isHighValue }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "zohoCrm_1",
                    "name": "Create CRM Lead",
                    "type": "n8n-nodes-base.zohoCrm",
                    "onError": "continueRegularOutput",
                    "position": [
                      1750,
                      300
                    ],
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone }}",
                      "module": "lead",
                      "company": "={{ $json.company }}",
                      "lastName": "={{ $json.lastName }}",
                      "firstName": "={{ $json.firstName }}",
                      "operation": "create",
                      "additionalFields": {
                        "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                        "industry": "={{ $json.companyProfile.industry }}",
                        "leadSource": "Website Signup",
                        "leadStatus": "New",
                        "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                      }
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "googleCalendar_1",
                    "name": "Schedule Demo Call",
                    "type": "n8n-nodes-base.googleCalendar",
                    "onError": "continueRegularOutput",
                    "position": [
                      2050,
                      200
                    ],
                    "parameters": {
                      "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                      "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                      "options": {
                        "sendNotifications": true
                      },
                      "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                      "attendees": "={{ $json.email }}",
                      "operation": "create",
                      "calendarId": "primary",
                      "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                    },
                    "typeVersion": 1.3
                  },
                  {
                    "id": "slack_1",
                    "name": "Notify Sales Team",
                    "type": "n8n-nodes-base.slack",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "position": [
                      2050,
                      400
                    ],
                    "parameters": {
                      "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                      "channel": "#sales-alerts",
                      "otherOptions": {
                        "includeLinkToWorkflow": true
                      }
                    },
                    "executeOnce": true,
                    "typeVersion": 2.3
                  },
                  {
                    "id": "sticky_triggers_1754943869352",
                    "name": "Triggers Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      480,
                      -130
                    ],
                    "parameters": {
                      "color": 6,
                      "width": 310,
                      "height": 710,
                      "content": "## 📥 Triggers\nWebhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_transforms_1754943869352",
                    "name": "Transform Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      890,
                      -130
                    ],
                    "parameters": {
                      "color": 4,
                      "width": 910,
                      "height": 710,
                      "content": "## ⚙️ Transform\nProcesses and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis.\n\nAnalyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_inputs_1754943869352",
                    "name": "Inputs Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      1900,
                      -130
                    ],
                    "parameters": {
                      "color": 5,
                      "width": 310,
                      "height": 710,
                      "content": "## 📊 Inputs\nFetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_outputs_1754943869352",
                    "name": "Outputs Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      2310,
                      -130
                    ],
                    "parameters": {
                      "color": 7,
                      "width": 310,
                      "height": 710,
                      "content": "## 🚀 Outputs\nSends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_storage_1754943869352",
                    "name": "Storage Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      2720,
                      -130
                    ],
                    "parameters": {
                      "color": 8,
                      "width": 310,
                      "height": 710,
                      "content": "## 💾 Storage\nCreates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_integration_1754943869352",
                    "name": "Integration Notes",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      3130,
                      -130
                    ],
                    "parameters": {
                      "color": 6,
                      "width": 310,
                      "height": 710,
                      "content": "## 🔗 Integration\nSchedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                    },
                    "typeVersion": 1
                  },
                  {
                    "id": "sticky_promo_1754943869352",
                    "name": "Ghost Team Promo",
                    "type": "n8n-nodes-base.stickyNote",
                    "position": [
                      100,
                      -130
                    ],
                    "parameters": {
                      "color": 4,
                      "width": 280,
                      "height": 710,
                      "content": "## 🚀 Grow your AI business\n\nNeed help in implementing this workflow for your business? Join the Ghost Team community.\n\nThis workflow is made with 💚 by Ghost Team."
                    },
                    "typeVersion": 1
                  }
                ],
                "valid": true,
                "settings": {
                  "executionOrder": "v1",
                  "saveManualExecutions": true,
                  "saveDataErrorExecution": "all",
                  "saveDataSuccessExecution": "all"
                },
                "connections": {
                  "Create CRM Lead": {
                    "main": [
                      [
                        {
                          "node": "Schedule Demo Call",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Notify Sales Team",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Fetch Company Data": {
                    "main": [
                      [
                        {
                          "node": "Analyze Company Profile",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Process Signup Data": {
                    "main": [
                      [
                        {
                          "node": "Fetch Company Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Analyze Company Profile": {
                    "main": [
                      [
                        {
                          "node": "Send Personalized Welcome Email",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Track Signup Event",
                          "type": "main",
                          "index": 0
                        },
                        {
                          "node": "Create CRM Lead",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  },
                  "Customer Signup Webhook": {
                    "main": [
                      [
                        {
                          "node": "Process Signup Data",
                          "type": "main",
                          "index": 0
                        }
                      ]
                    ]
                  }
                }
              },
              "buildPhases": [
                {
                  "type": "trigger",
                  "nodeIds": [
                    "webhook_1"
                  ],
                  "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_1"
                  ],
                  "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                },
                {
                  "type": "data_collection",
                  "nodeIds": [
                    "httpRequest_1"
                  ],
                  "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                },
                {
                  "type": "data_processing",
                  "nodeIds": [
                    "code_2"
                  ],
                  "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                },
                {
                  "type": "notification",
                  "nodeIds": [
                    "emailSend_1",
                    "segment_1"
                  ],
                  "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                },
                {
                  "type": "storage",
                  "nodeIds": [
                    "zohoCrm_1"
                  ],
                  "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                },
                {
                  "type": "integration",
                  "nodeIds": [
                    "googleCalendar_1",
                    "slack_1"
                  ],
                  "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                }
              ],
              "operationHistory": [
                {
                  "node": {
                    "id": "task_node_1",
                    "type": "nodes-base.webhook",
                    "config": {
                      "path": "webhook",
                      "onError": "continueRegularOutput",
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode",
                      "alwaysOutputData": true
                    },
                    "purpose": "Set up a webhook to receive data from external services",
                    "displayName": "receive webhook",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_1",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_5",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// Transform each item\nconst results = [];\n\nfor (const item of items) {\n  results.push({\n    json: {\n      // Transform your data here\n      id: item.json.id,\n      processedAt: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    },
                    "purpose": "Transform data structure using JavaScript",
                    "displayName": "transform data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_5",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_4",
                    "type": "nodes-base.emailSend",
                    "config": {
                      "text": "",
                      "onError": "continueRegularOutput",
                      "subject": "",
                      "toEmail": "",
                      "maxTries": 3,
                      "fromEmail": "",
                      "retryOnFail": true,
                      "alwaysOutputData": true,
                      "waitBetweenTries": 3000
                    },
                    "purpose": "Send an email notification",
                    "displayName": "send email",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_4",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_2",
                    "type": "nodes-base.code",
                    "config": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Common mistake to avoid:\n// const command = items[0].json.testCommand;  // ❌ WRONG - will be undefined!\n// const command = items[0].json.body.testCommand;  // ✅ CORRECT\n\n// Process the webhook data\ntry {\n  // Validate required fields\n  if (!webhookData.command) {\n    throw new Error('Missing required field: command');\n  }\n  \n  // Process based on command\n  let result = {};\n  switch (webhookData.command) {\n    case 'process':\n      result = {\n        status: 'processed',\n        data: webhookData.data,\n        processedAt: DateTime.now().toISO()\n      };\n      break;\n      \n    case 'validate':\n      result = {\n        status: 'validated',\n        isValid: true,\n        validatedFields: Object.keys(webhookData.data || {})\n      };\n      break;\n      \n    default:\n      result = {\n        status: 'unknown_command',\n        command: webhookData.command\n      };\n  }\n  \n  // Return processed data\n  return [{\n    json: {\n      ...result,\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      source: query.source || 'webhook',\n      originalCommand: webhookData.command,\n      metadata: {\n        httpMethod: items[0].json.httpMethod,\n        webhookPath: items[0].json.webhookPath,\n        timestamp: DateTime.now().toISO()\n      }\n    }\n  }];\n  \n} catch (error) {\n  // Return error response\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      timestamp: DateTime.now().toISO()\n    }\n  }];\n}",
                      "onError": "continueRegularOutput",
                      "language": "javaScript"
                    },
                    "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                    "displayName": "process webhook data",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_2",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_6",
                    "type": "nodes-base.slack",
                    "config": {
                      "text": "",
                      "channel": "",
                      "onError": "continueRegularOutput",
                      "maxTries": 2,
                      "resource": "message",
                      "operation": "post",
                      "parameters": {},
                      "retryOnFail": true,
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Send a message to Slack channel",
                    "displayName": "send slack message",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_6",
                  "timestamp": "2025-08-11T20:22:13.896Z"
                },
                {
                  "node": {
                    "id": "task_node_3",
                    "type": "nodes-base.httpRequest",
                    "config": {
                      "url": "",
                      "method": "GET",
                      "onError": "continueErrorOutput",
                      "maxTries": 3,
                      "retryOnFail": true,
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "alwaysOutputData": true,
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ]
                      },
                      "waitBetweenTries": 2000
                    },
                    "purpose": "Make an authenticated API request",
                    "displayName": "call api with auth",
                    "isPreConfigured": true
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "task_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_1",
                    "type": "nodes-base.zohoCrm",
                    "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_1",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_2",
                    "type": "nodes-base.googleCalendar",
                    "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_2",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "node": {
                    "id": "search_node_3",
                    "type": "nodes-base.segment",
                    "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring"
                  },
                  "type": "discoverNode",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "selectNode",
                  "nodeId": "search_node_3",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "completePhase",
                  "phase": "discovery",
                  "timestamp": "2025-08-11T20:22:14.164Z"
                },
                {
                  "type": "setPhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:55.179Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Webhook endpoint to receive customer signup data and trigger intelligent onboarding workflow with company analysis, personalized email sequences, and lead qualification",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "path": "customer-signup",
                      "options": {
                        "rawBody": false,
                        "noResponseBody": false
                      },
                      "httpMethod": "POST",
                      "responseData": "allEntries",
                      "responseMode": "lastNode"
                    },
                    "typeVersion": "1",
                    "alwaysOutputData": true
                  },
                  "nodeId": "task_node_1",
                  "purpose": "Set up a webhook to receive data from external services",
                  "nodeType": "nodes-base.webhook",
                  "reasoning": "Customized webhook path from generic 'webhook' to 'customer-signup' to specifically handle customer onboarding triggers",
                  "timestamp": "2025-08-11T20:22:55.457Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.694Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow",
                    "parameters": {
                      "jsCode": "// Analyze customer signup data and enrich with company profile\nconst results = [];\n\nfor (const item of items) {\n  const customerData = item.json;\n  \n  // Extract company information\n  const companyName = customerData.company || customerData.companyName || '';\n  const email = customerData.email || '';\n  const domain = email.split('@')[1] || '';\n  \n  // Determine company size based on available data\n  let companySize = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount < 10) companySize = 'startup';\n    else if (empCount < 50) companySize = 'small';\n    else if (empCount < 500) companySize = 'medium';\n    else companySize = 'enterprise';\n  }\n  \n  // Industry classification based on domain or provided data\n  let industry = customerData.industry || 'general';\n  if (!customerData.industry && domain) {\n    // Basic industry detection from common domain patterns\n    if (domain.includes('tech') || domain.includes('software')) industry = 'technology';\n    else if (domain.includes('health') || domain.includes('medical')) industry = 'healthcare';\n    else if (domain.includes('finance') || domain.includes('bank')) industry = 'finance';\n    else if (domain.includes('edu')) industry = 'education';\n  }\n  \n  // Determine lead score and priority\n  let leadScore = 50; // Base score\n  let priority = 'medium';\n  \n  // Scoring logic\n  if (companySize === 'enterprise') leadScore += 30;\n  else if (companySize === 'medium') leadScore += 20;\n  else if (companySize === 'small') leadScore += 10;\n  \n  if (['technology', 'finance', 'healthcare'].includes(industry)) leadScore += 15;\n  \n  if (customerData.revenue && parseInt(customerData.revenue.replace(/[^0-9]/g, '')) > 1000000) {\n    leadScore += 25;\n  }\n  \n  // Set priority based on score\n  if (leadScore >= 80) priority = 'high';\n  else if (leadScore >= 60) priority = 'medium';\n  else priority = 'low';\n  \n  // Determine appropriate demo type and timeline\n  let demoType = 'standard';\n  let demoTimeline = '7-days';\n  \n  if (companySize === 'enterprise' || priority === 'high') {\n    demoType = 'executive';\n    demoTimeline = '2-days';\n  } else if (companySize === 'medium') {\n    demoType = 'business';\n    demoTimeline = '3-days';\n  }\n  \n  // Email sequence selection\n  const emailSequence = `${industry}_${companySize}`;\n  \n  results.push({\n    json: {\n      // Original customer data\n      ...customerData,\n      \n      // Enriched profile data\n      companyProfile: {\n        name: companyName,\n        domain: domain,\n        size: companySize,\n        industry: industry,\n        estimatedEmployees: customerData.employees || 'unknown'\n      },\n      \n      // Lead qualification\n      leadScore: leadScore,\n      priority: priority,\n      \n      // Personalization parameters\n      personalization: {\n        emailSequence: emailSequence,\n        demoType: demoType,\n        demoTimeline: demoTimeline,\n        industryFocus: industry,\n        sizeSegment: companySize\n      },\n      \n      // Workflow routing flags\n      routing: {\n        requiresHighTouchSales: priority === 'high',\n        autoScheduleDemo: companySize !== 'startup',\n        enableAdvancedTracking: ['medium', 'enterprise'].includes(companySize),\n        escalateToSales: leadScore >= 75\n      },\n      \n      // Processing metadata\n      processedAt: new Date().toISOString(),\n      workflowStage: 'profile_analysis_complete'\n    }\n  });\n}\n\nreturn results;",
                      "language": "javaScript"
                    }
                  },
                  "nodeId": "task_node_5",
                  "purpose": "Transform data structure using JavaScript",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the template's generic data transformation to specifically analyze customer signup data for the onboarding workflow",
                  "timestamp": "2025-08-11T20:22:55.694Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_5",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:55.939Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send personalized onboarding email based on customer's industry and company size analysis",
                    "onError": "continueRegularOutput",
                    "maxTries": 3,
                    "parameters": {
                      "text": "Hi {{ $json.firstName || $json.name }},\n\nWelcome to our platform! Based on our analysis, we see you're in the {{ $json.industry || 'technology' }} industry with a {{ $json.companySize || 'growing' }} company.\n\n{{ $json.companySize === 'enterprise' ? 'As an enterprise customer, you'll have access to our premium features and dedicated support team.' : $json.companySize === 'mid-market' ? 'Perfect timing - our platform is designed to scale with mid-market companies like yours.' : 'We're excited to help your growing business succeed with our platform.' }}\n\nNext steps:\n- Complete your profile setup\n- {{ $json.industry === 'healthcare' ? 'Review our HIPAA compliance features' : $json.industry === 'finance' ? 'Explore our security and compliance tools' : 'Check out features tailored for your industry' }}\n- Schedule a personalized demo\n\nBest regards,\nThe Onboarding Team",
                      "subject": "Welcome {{ $json.firstName || $json.name }}! Your {{ $json.industry || 'business' }} onboarding guide is ready",
                      "toEmail": "{{ $json.email }}",
                      "fromEmail": "onboarding@company.com"
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 3000
                  },
                  "nodeId": "task_node_4",
                  "purpose": "Send an email notification",
                  "nodeType": "nodes-base.emailSend",
                  "reasoning": "Customized the email template for intelligent customer onboarding by incorporating dynamic personalization based on industry and company size data",
                  "timestamp": "2025-08-11T20:22:55.939Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_4",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.169Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Process customer signup webhook data and extract key information for intelligent onboarding workflow - analyzes company data, determines industry/size, and prepares data for personalized email sequences and demo scheduling",
                    "onError": "continueRegularOutput",
                    "parameters": {
                      "jsCode": "// ⚠️ CRITICAL: Webhook data is nested under 'body' property!\n// Connect this Code node after a Webhook node for customer signup processing\n\n// Access webhook payload data - it's under .body, not directly under .json\nconst webhookData = items[0].json.body;  // ✅ CORRECT\nconst headers = items[0].json.headers;   // HTTP headers\nconst query = items[0].json.query;       // Query parameters\n\n// Process customer signup data for intelligent onboarding\ntry {\n  // Validate required signup fields\n  if (!webhookData.email) {\n    throw new Error('Missing required field: email');\n  }\n  if (!webhookData.company) {\n    throw new Error('Missing required field: company');\n  }\n  \n  // Extract and normalize customer data\n  const customerData = {\n    email: webhookData.email.toLowerCase().trim(),\n    firstName: webhookData.firstName || webhookData.first_name || '',\n    lastName: webhookData.lastName || webhookData.last_name || '',\n    company: webhookData.company.trim(),\n    jobTitle: webhookData.jobTitle || webhookData.job_title || '',\n    phone: webhookData.phone || '',\n    website: webhookData.website || webhookData.company_website || '',\n    employees: webhookData.employees || webhookData.company_size || null,\n    industry: webhookData.industry || '',\n    source: webhookData.source || query.source || 'direct_signup'\n  };\n  \n  // Determine company size category for personalization\n  let companySizeCategory = 'unknown';\n  if (customerData.employees) {\n    const empCount = parseInt(customerData.employees);\n    if (empCount <= 10) companySizeCategory = 'startup';\n    else if (empCount <= 50) companySizeCategory = 'small';\n    else if (empCount <= 500) companySizeCategory = 'medium';\n    else companySizeCategory = 'enterprise';\n  }\n  \n  // Extract domain for company analysis\n  const emailDomain = customerData.email.split('@')[1];\n  const websiteDomain = customerData.website ? \n    customerData.website.replace(/^https?:\\/\\/(www\\.)?/, '').split('/')[0] : \n    emailDomain;\n  \n  // Determine lead priority based on company size and industry\n  let leadPriority = 'medium';\n  if (companySizeCategory === 'enterprise' || \n      ['technology', 'finance', 'healthcare', 'saas'].includes(customerData.industry.toLowerCase())) {\n    leadPriority = 'high';\n  } else if (companySizeCategory === 'startup') {\n    leadPriority = 'low';\n  }\n  \n  // Prepare data for next workflow steps\n  const processedData = {\n    customer: customerData,\n    analysis: {\n      companySizeCategory,\n      emailDomain,\n      websiteDomain,\n      leadPriority,\n      requiresApiEnrichment: !customerData.industry || !customerData.employees,\n      personalizedEmailSequence: `${companySizeCategory}_${customerData.industry || 'general'}`,\n      suggestedDemoType: companySizeCategory === 'enterprise' ? 'custom' : 'standard'\n    },\n    workflow: {\n      signupId: crypto.randomUUID(),\n      processedAt: DateTime.now().toISO(),\n      nextSteps: [\n        'enrich_company_data',\n        'send_welcome_email',\n        'schedule_demo_followup'\n      ],\n      escalateToSales: leadPriority === 'high'\n    },\n    metadata: {\n      requestId: headers['x-request-id'] || crypto.randomUUID(),\n      httpMethod: items[0].json.httpMethod,\n      webhookPath: items[0].json.webhookPath,\n      userAgent: headers['user-agent'] || '',\n      ipAddress: headers['x-forwarded-for'] || headers['x-real-ip'] || '',\n      timestamp: DateTime.now().toISO()\n    }\n  };\n  \n  // Return processed signup data for onboarding workflow\n  return [{\n    json: processedData\n  }];\n  \n} catch (error) {\n  // Return error response for failed signup processing\n  return [{\n    json: {\n      status: 'error',\n      error: error.message,\n      originalData: webhookData,\n      timestamp: DateTime.now().toISO(),\n      requiresManualReview: true\n    }\n  }];\n}",
                      "language": "javaScript"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "task_node_2",
                  "purpose": "Process incoming webhook data with Code node (shows correct data access)",
                  "nodeType": "nodes-base.code",
                  "reasoning": "Customized the webhook processing template specifically for customer signup data extraction and analysis",
                  "timestamp": "2025-08-11T20:22:56.169Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.384Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Send notification to sales team Slack channel when a high-value prospect is escalated during customer onboarding workflow",
                    "onError": "continueRegularOutput",
                    "maxTries": 2,
                    "parameters": {
                      "text": "🚨 *High-Value Prospect Escalation* 🚨\n\n*Company:* {{ $json.company_name || 'Unknown' }}\n*Industry:* {{ $json.industry || 'Not specified' }}\n*Company Size:* {{ $json.company_size || 'Unknown' }}\n*Revenue Potential:* {{ $json.revenue_potential || 'TBD' }}\n*Lead Score:* {{ $json.lead_score || 'N/A' }}\n\n*Contact Details:*\n• Name: {{ $json.contact_name || 'Unknown' }}\n• Email: {{ $json.email || 'Not provided' }}\n• Phone: {{ $json.phone || 'Not provided' }}\n• Title: {{ $json.job_title || 'Unknown' }}\n\n*Engagement Summary:*\n• Email Opens: {{ $json.email_opens || 0 }}\n• Link Clicks: {{ $json.link_clicks || 0 }}\n• Demo Interest: {{ $json.demo_interest ? 'Yes' : 'No' }}\n• Last Activity: {{ $json.last_activity || 'Unknown' }}\n\n*Next Steps:* Immediate sales follow-up recommended\n*CRM Link:* {{ $json.crm_link || 'To be created' }}",
                      "select": "channel",
                      "resource": "message",
                      "channelId": "#sales-escalations",
                      "operation": "post",
                      "parameters": {}
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_6",
                  "purpose": "Send a message to Slack channel",
                  "nodeType": "nodes-base.slack",
                  "reasoning": "Customized the Slack message template to serve the customer onboarding workflow's escalation needs",
                  "timestamp": "2025-08-11T20:22:56.384Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_6",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.635Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Fetch company data from external API to analyze industry, size, and other attributes for personalized onboarding",
                    "onError": "continueErrorOutput",
                    "maxTries": 3,
                    "parameters": {
                      "url": "https://api.clearbit.com/v2/companies/find?domain={{ $json.email.split('@')[1] }}",
                      "method": "GET",
                      "sendHeaders": true,
                      "authentication": "genericCredentialType",
                      "genericAuthType": "headerAuth",
                      "headerParameters": {
                        "parameters": [
                          {
                            "name": "Authorization",
                            "value": "Bearer {{ $credentials.clearbit.apiKey }}"
                          }
                        ]
                      }
                    },
                    "retryOnFail": true,
                    "typeVersion": "1",
                    "alwaysOutputData": true,
                    "waitBetweenTries": 2000
                  },
                  "nodeId": "task_node_3",
                  "purpose": "Make an authenticated API request",
                  "nodeType": "nodes-base.httpRequest",
                  "reasoning": "Customized the template for company data enrichment by setting the URL to Clearbit API endpoint that looks up company information by domain",
                  "timestamp": "2025-08-11T20:22:56.635Z",
                  "operationIndex": 0,
                  "customizedFromTemplate": true
                },
                {
                  "type": "validateNode",
                  "nodeId": "task_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:56.793Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates leads in Zoho CRM for new signups and tracks them through the sales pipeline with complete context",
                    "parameters": {
                      "email": "={{ $json.email }}",
                      "phone": "={{ $json.phone || $json.phoneNumber || '' }}",
                      "Company": "={{ $json.company || $json.companyName || $json.organization || 'Unknown Company' }}",
                      "industry": "={{ $json.industry || $json.companyIndustry || '' }}",
                      "lastName": "={{ $json.lastName || $json.last_name || $json.name?.split(' ').pop() || 'Unknown' }}",
                      "resource": "lead",
                      "firstName": "={{ $json.firstName || $json.first_name || $json.name?.split(' ')[0] || '' }}",
                      "operation": "create",
                      "leadSource": "Website Signup",
                      "leadStatus": "New Lead",
                      "description": "Lead from intelligent onboarding workflow - {{ $json.signupDate || $now.format('yyyy-MM-dd') }}",
                      "annualRevenue": "={{ $json.companySize || $json.revenue || '' }}"
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_1",
                  "purpose": "Integrate with CRM system to store customer data, track lead status, and manage sales pipeline for qualified prospects",
                  "nodeType": "nodes-base.zohoCrm",
                  "reasoning": "Configured as a lead creation node since this is the entry point for new signups in the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:56.793Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.034Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Creates calendar events for demo calls with prospects based on their profile and engagement level",
                    "parameters": {
                      "end": "={{ $('previous_node').item.json.demoScheduledTime ? DateTime.fromISO($('previous_node').item.json.demoScheduledTime).plus(30, 'minutes') : $now.plus(2, 'days').set({ hour: 14, minute: 30, second: 0, millisecond: 0 }) }}",
                      "start": "={{ $('previous_node').item.json.demoScheduledTime || $now.plus(2, 'days').set({ hour: 14, minute: 0, second: 0, millisecond: 0 }) }}",
                      "summary": "Demo Call - {{ $('previous_node').item.json.companyName || $('previous_node').item.json.firstName + ' ' + $('previous_node').item.json.lastName }}",
                      "calendar": "={{ $('previous_node').item.json.salesCalendarId || 'primary' }}",
                      "resource": "event",
                      "operation": "create",
                      "description": "Demo call with {{ $('previous_node').item.json.firstName }} {{ $('previous_node').item.json.lastName }} from {{ $('previous_node').item.json.companyName }}\n\nCompany Size: {{ $('previous_node').item.json.companySize }}\nIndustry: {{ $('previous_node').item.json.industry }}\nEngagement Score: {{ $('previous_node').item.json.engagementScore }}\nLead Source: {{ $('previous_node').item.json.leadSource }}\n\nContact: {{ $('previous_node').item.json.email }}\nPhone: {{ $('previous_node').item.json.phone }}"
                    },
                    "typeVersion": "1.3"
                  },
                  "nodeId": "search_node_2",
                  "purpose": "Schedule demo calls and meetings with prospects based on their profile and engagement level",
                  "nodeType": "nodes-base.googleCalendar",
                  "reasoning": "Configured Google Calendar to create demo events as part of the intelligent onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.034Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.270Z"
                },
                {
                  "type": "configureNode",
                  "config": {
                    "notes": "Tracks customer engagement events across multiple channels for lead scoring and behavioral analysis",
                    "parameters": {
                      "event": "{{ $json.eventName || 'engagement_event' }}",
                      "traits": {
                        "phone": "{{ $json.phone }}",
                        "title": "{{ $json.title }}",
                        "company": "{{ $json.company }}",
                        "industry": "{{ $json.industry }}",
                        "lead_status": "{{ $json.leadStatus }}",
                        "company_size": "{{ $json.companySize }}",
                        "last_engagement": "{{ $now }}"
                      },
                      "userId": "{{ $json.userId || $json.email }}",
                      "resource": "track",
                      "operation": "event",
                      "properties": {
                        "value": "{{ $json.value }}",
                        "action": "{{ $json.action }}",
                        "source": "onboarding_workflow",
                        "channel": "{{ $json.channel }}",
                        "industry": "{{ $json.industry }}",
                        "timestamp": "{{ $now }}",
                        "company_size": "{{ $json.companySize }}",
                        "engagement_level": "{{ $json.engagementLevel }}",
                        "lead_score_impact": "{{ $json.scoreImpact || 1 }}"
                      }
                    },
                    "typeVersion": "1"
                  },
                  "nodeId": "search_node_3",
                  "purpose": "Track customer engagement across multiple channels and collect behavioral data for lead scoring",
                  "nodeType": "nodes-base.segment",
                  "reasoning": "Configured Segment to track engagement events across multiple channels as required for the customer onboarding workflow",
                  "timestamp": "2025-08-11T20:22:57.270Z",
                  "operationIndex": 0
                },
                {
                  "type": "validateNode",
                  "nodeId": "search_node_3",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "completePhase",
                  "phase": "configuration",
                  "timestamp": "2025-08-11T20:22:57.511Z"
                },
                {
                  "type": "setPhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.196Z"
                },
                {
                  "type": "setWorkflow",
                  "workflow": {
                    "name": "Intelligent Customer Onboarding Workflow",
                    "nodes": [
                      {
                        "id": "webhook_1",
                        "name": "Customer Signup Webhook",
                        "type": "n8n-nodes-base.webhook",
                        "onError": "stopWorkflow",
                        "position": [
                          250,
                          300
                        ],
                        "parameters": {
                          "path": "customer-signup",
                          "options": {},
                          "httpMethod": "POST",
                          "responseMode": "responseNode"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "code_1",
                        "name": "Process Signup Data",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          550,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "httpRequest_1",
                        "name": "Fetch Company Data",
                        "type": "n8n-nodes-base.httpRequest",
                        "onError": "continueErrorOutput",
                        "maxTries": 3,
                        "position": [
                          850,
                          300
                        ],
                        "parameters": {
                          "url": "https://api.clearbit.com/v2/companies/find",
                          "options": {
                            "retry": {
                              "enabled": true,
                              "maxTries": 3
                            },
                            "timeout": 10000
                          },
                          "sendQuery": true,
                          "authentication": "predefinedCredentialType",
                          "queryParameters": {
                            "parameters": [
                              {
                                "name": "domain",
                                "value": "={{ $json.enrichmentQuery.domain }}"
                              }
                            ]
                          },
                          "nodeCredentialType": "clearbitApi"
                        },
                        "retryOnFail": true,
                        "typeVersion": 4.1
                      },
                      {
                        "id": "code_2",
                        "name": "Analyze Company Profile",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          1150,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "emailSend_1",
                        "name": "Send Personalized Welcome Email",
                        "type": "n8n-nodes-base.emailSend",
                        "onError": "continueRegularOutput",
                        "maxTries": 3,
                        "position": [
                          1450,
                          200
                        ],
                        "parameters": {
                          "html": "<h2>Welcome to [Product]!</h2><p>Hi {{ $json.firstName }},</p><p>We're excited to help <strong>{{ $json.company }}</strong> achieve its goals.</p><p>Based on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience.</p><h3>What's next:</h3><ol><li>{{ $json.personalizedContent.demoLength }}-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>",
                          "text": "Hi {{ $json.firstName }},\n\nWelcome to [Product]! We're excited to help {{ $json.company }} achieve its goals.\n\nBased on your company profile ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company), we've prepared a personalized onboarding experience for you.\n\nWhat's next:\n1. We'll schedule a {{ $json.personalizedContent.demoLength }}-minute demo tailored to your needs\n2. You'll receive industry-specific resources\n3. Our team will provide dedicated support\n\nBest regards,\nThe Onboarding Team",
                          "options": {},
                          "subject": "Welcome to [Product] - Let's get {{ $json.company }} started!",
                          "toEmail": "={{ $json.email }}",
                          "fromEmail": "onboarding@company.com"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "segment_1",
                        "name": "Track Signup Event",
                        "type": "n8n-nodes-base.segment",
                        "onError": "continueRegularOutput",
                        "position": [
                          1450,
                          400
                        ],
                        "parameters": {
                          "event": "Customer Signed Up",
                          "traits": {
                            "tier": "={{ $json.companyProfile.tier }}",
                            "email": "={{ $json.email }}",
                            "company": "={{ $json.company }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "lastName": "={{ $json.lastName }}",
                            "firstName": "={{ $json.firstName }}",
                            "leadScore": "={{ $json.leadScore }}",
                            "companySize": "={{ $json.companyProfile.size }}"
                          },
                          "userId": "={{ $json.email }}",
                          "properties": {
                            "source": "={{ $json.source }}",
                            "demoType": "={{ $json.companyProfile.demoType }}",
                            "signupDate": "={{ $json.signupDate }}",
                            "isHighValue": "={{ $json.isHighValue }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "zohoCrm_1",
                        "name": "Create CRM Lead",
                        "type": "n8n-nodes-base.zohoCrm",
                        "onError": "continueRegularOutput",
                        "position": [
                          1750,
                          300
                        ],
                        "parameters": {
                          "email": "={{ $json.email }}",
                          "phone": "={{ $json.phone }}",
                          "module": "lead",
                          "company": "={{ $json.company }}",
                          "lastName": "={{ $json.lastName }}",
                          "firstName": "={{ $json.firstName }}",
                          "operation": "create",
                          "additionalFields": {
                            "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "leadSource": "Website Signup",
                            "leadStatus": "New",
                            "description": "Lead Score: {{ $json.leadScore }}, Company Size: {{ $json.companyProfile.size }}, Tier: {{ $json.companyProfile.tier }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "googleCalendar_1",
                        "name": "Schedule Demo Call",
                        "type": "n8n-nodes-base.googleCalendar",
                        "onError": "continueRegularOutput",
                        "position": [
                          2050,
                          200
                        ],
                        "parameters": {
                          "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                          "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                          "options": {
                            "sendNotifications": true
                          },
                          "summary": "Demo Call - {{ $json.company }} ({{ $json.companyProfile.size }} {{ $json.companyProfile.industry }})",
                          "attendees": "={{ $json.email }}",
                          "operation": "create",
                          "calendarId": "primary",
                          "description": "Demo call with {{ $json.firstName }} {{ $json.lastName }} from {{ $json.company }}.\n\nCompany Profile:\n- Size: {{ $json.companyProfile.size }}\n- Industry: {{ $json.companyProfile.industry }}\n- Lead Score: {{ $json.leadScore }}\n- Demo Type: {{ $json.companyProfile.demoType }}\n\nContact: {{ $json.email }}"
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "slack_1",
                        "name": "Notify Sales Team",
                        "type": "n8n-nodes-base.slack",
                        "onError": "continueRegularOutput",
                        "maxTries": 2,
                        "position": [
                          2050,
                          400
                        ],
                        "parameters": {
                          "text": "🚨 High-Value Prospect Alert!\n\n*{{ $json.company }}* just signed up!\n\n👤 Contact: {{ $json.firstName }} {{ $json.lastName }} ({{ $json.email }})\n🏢 Company: {{ $json.companyProfile.size }} {{ $json.companyProfile.industry }} company\n📊 Lead Score: {{ $json.leadScore }}/100\n🎯 Tier: {{ $json.companyProfile.tier }}\n📅 Demo scheduled for {{ DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a') }}\n\n*Action Required:* Review lead in CRM and prepare for demo call.",
                          "channel": "#sales-alerts",
                          "otherOptions": {
                            "includeLinkToWorkflow": true
                          }
                        },
                        "executeOnce": true,
                        "typeVersion": 1
                      }
                    ],
                    "settings": {
                      "executionOrder": "v1",
                      "saveManualExecutions": true,
                      "saveDataErrorExecution": "all",
                      "saveDataSuccessExecution": "all"
                    },
                    "connections": {
                      "Create CRM Lead": {
                        "main": [
                          [
                            {
                              "node": "Schedule Demo Call",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Notify Sales Team",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Fetch Company Data": {
                        "main": [
                          [
                            {
                              "node": "Analyze Company Profile",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Process Signup Data": {
                        "main": [
                          [
                            {
                              "node": "Fetch Company Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Analyze Company Profile": {
                        "main": [
                          [
                            {
                              "node": "Send Personalized Welcome Email",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Track Signup Event",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Create CRM Lead",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Customer Signup Webhook": {
                        "main": [
                          [
                            {
                              "node": "Process Signup Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      }
                    }
                  },
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "setBuildPhases",
                  "phases": [
                    {
                      "type": "trigger",
                      "nodeIds": [
                        "webhook_1"
                      ],
                      "description": "Webhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_1"
                      ],
                      "description": "Processes and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis."
                    },
                    {
                      "type": "data_collection",
                      "nodeIds": [
                        "httpRequest_1"
                      ],
                      "description": "Fetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                    },
                    {
                      "type": "data_processing",
                      "nodeIds": [
                        "code_2"
                      ],
                      "description": "Analyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                    },
                    {
                      "type": "notification",
                      "nodeIds": [
                        "emailSend_1",
                        "segment_1"
                      ],
                      "description": "Sends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                    },
                    {
                      "type": "storage",
                      "nodeIds": [
                        "zohoCrm_1"
                      ],
                      "description": "Creates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                    },
                    {
                      "type": "integration",
                      "nodeIds": [
                        "googleCalendar_1",
                        "slack_1"
                      ],
                      "description": "Schedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                    }
                  ],
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "completePhase",
                  "phase": "building",
                  "timestamp": "2025-08-11T20:23:53.469Z"
                },
                {
                  "type": "setPhase",
                  "phase": "validation",
                  "timestamp": "2025-08-11T20:24:28.262Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "emailSend_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "zohoCrm_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "googleCalendar_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "slack_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "webhook_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "httpRequest_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 1,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "emailSend_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 2,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "zohoCrm_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 2,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "googleCalendar_1",
                  "result": {
                    "valid": false,
                    "errors": [
                      "Node replaced entirely"
                    ]
                  },
                  "attempt": 2,
                  "reasoning": "Node replaced to fix validation errors",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "webhook_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.613Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "code_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "httpRequest_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "code_2",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "emailSend_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "segment_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "zohoCrm_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "googleCalendar_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "validateNode",
                  "nodeId": "slack_1",
                  "result": {
                    "valid": true,
                    "errors": []
                  },
                  "attempt": 3,
                  "reasoning": "Node passed all validation checks",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "setWorkflow",
                  "workflow": {
                    "name": "Intelligent Customer Onboarding Workflow",
                    "nodes": [
                      {
                        "id": "webhook_1",
                        "name": "Customer Signup Webhook",
                        "type": "n8n-nodes-base.webhook",
                        "onError": "stopWorkflow",
                        "position": [
                          250,
                          300
                        ],
                        "parameters": {
                          "path": "customer-signup",
                          "options": {},
                          "httpMethod": "POST",
                          "responseMode": "responseNode"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "code_1",
                        "name": "Process Signup Data",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          550,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "httpRequest_1",
                        "name": "Fetch Company Data",
                        "type": "n8n-nodes-base.httpRequest",
                        "onError": "continueErrorOutput",
                        "maxTries": 3,
                        "position": [
                          850,
                          300
                        ],
                        "parameters": {
                          "url": "https://api.clearbit.com/v2/companies/find",
                          "options": {
                            "retry": {
                              "enabled": true,
                              "maxTries": 3
                            },
                            "timeout": 10000
                          },
                          "sendQuery": true,
                          "authentication": "predefinedCredentialType",
                          "queryParameters": {
                            "parameters": [
                              {
                                "name": "domain",
                                "value": "={{ $json.enrichmentQuery.domain }}"
                              }
                            ]
                          },
                          "nodeCredentialType": "clearbitApi"
                        },
                        "retryOnFail": true,
                        "typeVersion": 4.2
                      },
                      {
                        "id": "code_2",
                        "name": "Analyze Company Profile",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          1150,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "emailSend_1",
                        "name": "Send Personalized Welcome Email",
                        "type": "n8n-nodes-base.emailSend",
                        "onError": "continueRegularOutput",
                        "maxTries": 3,
                        "position": [
                          1450,
                          200
                        ],
                        "parameters": {
                          "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                          "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                          "options": {},
                          "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                          "toEmail": "={{ $json.email }}",
                          "fromEmail": "onboarding@company.com"
                        },
                        "typeVersion": 2.1
                      },
                      {
                        "id": "segment_1",
                        "name": "Track Signup Event",
                        "type": "n8n-nodes-base.segment",
                        "onError": "continueRegularOutput",
                        "position": [
                          1450,
                          400
                        ],
                        "parameters": {
                          "event": "Customer Signed Up",
                          "traits": {
                            "tier": "={{ $json.companyProfile.tier }}",
                            "email": "={{ $json.email }}",
                            "company": "={{ $json.company }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "lastName": "={{ $json.lastName }}",
                            "firstName": "={{ $json.firstName }}",
                            "leadScore": "={{ $json.leadScore }}",
                            "companySize": "={{ $json.companyProfile.size }}"
                          },
                          "userId": "={{ $json.email }}",
                          "properties": {
                            "source": "={{ $json.source }}",
                            "demoType": "={{ $json.companyProfile.demoType }}",
                            "signupDate": "={{ $json.signupDate }}",
                            "isHighValue": "={{ $json.isHighValue }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "zohoCrm_1",
                        "name": "Create CRM Lead",
                        "type": "n8n-nodes-base.zohoCrm",
                        "onError": "continueRegularOutput",
                        "position": [
                          1750,
                          300
                        ],
                        "parameters": {
                          "email": "={{ $json.email }}",
                          "phone": "={{ $json.phone }}",
                          "module": "lead",
                          "company": "={{ $json.company }}",
                          "lastName": "={{ $json.lastName }}",
                          "firstName": "={{ $json.firstName }}",
                          "operation": "create",
                          "additionalFields": {
                            "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "leadSource": "Website Signup",
                            "leadStatus": "New",
                            "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "googleCalendar_1",
                        "name": "Schedule Demo Call",
                        "type": "n8n-nodes-base.googleCalendar",
                        "onError": "continueRegularOutput",
                        "position": [
                          2050,
                          200
                        ],
                        "parameters": {
                          "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                          "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                          "options": {
                            "sendNotifications": true
                          },
                          "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                          "attendees": "={{ $json.email }}",
                          "operation": "create",
                          "calendarId": "primary",
                          "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                        },
                        "typeVersion": 1.3
                      },
                      {
                        "id": "slack_1",
                        "name": "Notify Sales Team",
                        "type": "n8n-nodes-base.slack",
                        "onError": "continueRegularOutput",
                        "maxTries": 2,
                        "position": [
                          2050,
                          400
                        ],
                        "parameters": {
                          "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                          "channel": "#sales-alerts",
                          "otherOptions": {
                            "includeLinkToWorkflow": true
                          }
                        },
                        "executeOnce": true,
                        "typeVersion": 2.3
                      }
                    ],
                    "valid": true,
                    "settings": {
                      "executionOrder": "v1",
                      "saveManualExecutions": true,
                      "saveDataErrorExecution": "all",
                      "saveDataSuccessExecution": "all"
                    },
                    "connections": {
                      "Create CRM Lead": {
                        "main": [
                          [
                            {
                              "node": "Schedule Demo Call",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Notify Sales Team",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Fetch Company Data": {
                        "main": [
                          [
                            {
                              "node": "Analyze Company Profile",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Process Signup Data": {
                        "main": [
                          [
                            {
                              "node": "Fetch Company Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Analyze Company Profile": {
                        "main": [
                          [
                            {
                              "node": "Send Personalized Welcome Email",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Track Signup Event",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Create CRM Lead",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Customer Signup Webhook": {
                        "main": [
                          [
                            {
                              "node": "Process Signup Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      }
                    }
                  },
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "completePhase",
                  "phase": "validation",
                  "timestamp": "2025-08-11T20:24:28.888Z"
                },
                {
                  "type": "setPhase",
                  "phase": "documentation",
                  "timestamp": "2025-08-11T20:24:29.352Z"
                },
                {
                  "type": "setWorkflow",
                  "workflow": {
                    "name": "Intelligent Customer Onboarding Workflow",
                    "nodes": [
                      {
                        "id": "webhook_1",
                        "name": "Customer Signup Webhook",
                        "type": "n8n-nodes-base.webhook",
                        "onError": "stopWorkflow",
                        "position": [
                          250,
                          300
                        ],
                        "parameters": {
                          "path": "customer-signup",
                          "options": {},
                          "httpMethod": "POST",
                          "responseMode": "responseNode"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "code_1",
                        "name": "Process Signup Data",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          550,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Process customer signup webhook data and extract key information for intelligent onboarding workflow\n// Analyzes company data, determines industry/size, and prepares data for personalized sequences\n\nconst signupData = $input.all()[0].json;\n\n// Extract and validate customer information\nconst customer = {\n  email: signupData.email,\n  firstName: signupData.firstName || signupData.first_name,\n  lastName: signupData.lastName || signupData.last_name,\n  company: signupData.company || signupData.companyName,\n  phone: signupData.phone,\n  website: signupData.website,\n  signupDate: new Date().toISOString(),\n  source: signupData.source || 'website'\n};\n\n// Prepare data for company enrichment API\nconst enrichmentQuery = {\n  domain: customer.website || (customer.email ? customer.email.split('@')[1] : null),\n  company: customer.company,\n  email: customer.email\n};\n\nreturn [{\n  json: {\n    ...customer,\n    enrichmentQuery,\n    workflowId: $workflow.id,\n    executionId: $execution.id\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "httpRequest_1",
                        "name": "Fetch Company Data",
                        "type": "n8n-nodes-base.httpRequest",
                        "onError": "continueErrorOutput",
                        "maxTries": 3,
                        "position": [
                          850,
                          300
                        ],
                        "parameters": {
                          "url": "https://api.clearbit.com/v2/companies/find",
                          "options": {
                            "retry": {
                              "enabled": true,
                              "maxTries": 3
                            },
                            "timeout": 10000
                          },
                          "sendQuery": true,
                          "authentication": "predefinedCredentialType",
                          "queryParameters": {
                            "parameters": [
                              {
                                "name": "domain",
                                "value": "={{ $json.enrichmentQuery.domain }}"
                              }
                            ]
                          },
                          "nodeCredentialType": "clearbitApi"
                        },
                        "retryOnFail": true,
                        "typeVersion": 4.2
                      },
                      {
                        "id": "code_2",
                        "name": "Analyze Company Profile",
                        "type": "n8n-nodes-base.code",
                        "onError": "continueRegularOutput",
                        "position": [
                          1150,
                          300
                        ],
                        "parameters": {
                          "jsCode": "// Analyzes customer signup data to determine company profile, industry classification, and personalization parameters for the onboarding workflow\n\nconst customerData = $('Process Signup Data').first().json;\nconst companyData = $input.first().json;\n\n// Analyze company size and industry\nlet companyProfile = {\n  size: 'unknown',\n  industry: 'unknown',\n  tier: 'standard',\n  priority: 'medium',\n  demoType: 'standard'\n};\n\nif (companyData && !companyData.error) {\n  // Determine company size\n  const employees = companyData.metrics?.employees || 0;\n  if (employees > 1000) {\n    companyProfile.size = 'enterprise';\n    companyProfile.tier = 'enterprise';\n    companyProfile.priority = 'high';\n    companyProfile.demoType = 'executive';\n  } else if (employees > 100) {\n    companyProfile.size = 'medium';\n    companyProfile.tier = 'business';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'business';\n  } else if (employees > 10) {\n    companyProfile.size = 'small';\n    companyProfile.tier = 'professional';\n    companyProfile.priority = 'medium';\n    companyProfile.demoType = 'standard';\n  } else {\n    companyProfile.size = 'startup';\n    companyProfile.tier = 'starter';\n    companyProfile.priority = 'low';\n    companyProfile.demoType = 'self-service';\n  }\n\n  // Extract industry\n  companyProfile.industry = companyData.category?.industry || companyData.tags?.[0] || 'technology';\n}\n\n// Determine if high-value prospect\nconst isHighValue = companyProfile.size === 'enterprise' || companyProfile.size === 'medium';\n\n// Calculate lead score\nlet leadScore = 50; // Base score\nif (companyProfile.size === 'enterprise') leadScore += 40;\nelse if (companyProfile.size === 'medium') leadScore += 25;\nelse if (companyProfile.size === 'small') leadScore += 10;\n\nif (['technology', 'software', 'saas'].includes(companyProfile.industry.toLowerCase())) leadScore += 15;\n\nreturn [{\n  json: {\n    ...customerData,\n    companyProfile,\n    companyData: companyData || {},\n    isHighValue,\n    leadScore,\n    personalizedContent: {\n      emailTemplate: `${companyProfile.size}_${companyProfile.industry}`,\n      demoLength: companyProfile.size === 'enterprise' ? 60 : 30,\n      followUpSequence: companyProfile.tier\n    }\n  }\n}];"
                        },
                        "typeVersion": 2
                      },
                      {
                        "id": "emailSend_1",
                        "name": "Send Personalized Welcome Email",
                        "type": "n8n-nodes-base.emailSend",
                        "onError": "continueRegularOutput",
                        "maxTries": 3,
                        "position": [
                          1450,
                          200
                        ],
                        "parameters": {
                          "html": "={{ '<h2>Welcome to [Product]!</h2><p>Hi ' + $json.firstName + ',</p><p>We\\'re excited to help <strong>' + $json.company + '</strong> achieve its goals.</p><p>Based on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience.</p><h3>What\\'s next:</h3><ol><li>' + $json.personalizedContent.demoLength + '-minute personalized demo</li><li>Industry-specific resources</li><li>Dedicated support</li></ol>' }}",
                          "text": "={{ 'Hi ' + $json.firstName + ',\\n\\nWelcome to [Product]! We\\'re excited to help ' + $json.company + ' achieve its goals.\\n\\nBased on your company profile (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ' company), we\\'ve prepared a personalized onboarding experience for you.\\n\\nWhat\\'s next:\\n1. We\\'ll schedule a ' + $json.personalizedContent.demoLength + '-minute demo tailored to your needs\\n2. You\\'ll receive industry-specific resources\\n3. Our team will provide dedicated support\\n\\nBest regards,\\nThe Onboarding Team' }}",
                          "options": {},
                          "subject": "={{ 'Welcome to [Product] - Let\\'s get ' + $json.company + ' started!' }}",
                          "toEmail": "={{ $json.email }}",
                          "fromEmail": "onboarding@company.com"
                        },
                        "typeVersion": 2.1
                      },
                      {
                        "id": "segment_1",
                        "name": "Track Signup Event",
                        "type": "n8n-nodes-base.segment",
                        "onError": "continueRegularOutput",
                        "position": [
                          1450,
                          400
                        ],
                        "parameters": {
                          "event": "Customer Signed Up",
                          "traits": {
                            "tier": "={{ $json.companyProfile.tier }}",
                            "email": "={{ $json.email }}",
                            "company": "={{ $json.company }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "lastName": "={{ $json.lastName }}",
                            "firstName": "={{ $json.firstName }}",
                            "leadScore": "={{ $json.leadScore }}",
                            "companySize": "={{ $json.companyProfile.size }}"
                          },
                          "userId": "={{ $json.email }}",
                          "properties": {
                            "source": "={{ $json.source }}",
                            "demoType": "={{ $json.companyProfile.demoType }}",
                            "signupDate": "={{ $json.signupDate }}",
                            "isHighValue": "={{ $json.isHighValue }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "zohoCrm_1",
                        "name": "Create CRM Lead",
                        "type": "n8n-nodes-base.zohoCrm",
                        "onError": "continueRegularOutput",
                        "position": [
                          1750,
                          300
                        ],
                        "parameters": {
                          "email": "={{ $json.email }}",
                          "phone": "={{ $json.phone }}",
                          "module": "lead",
                          "company": "={{ $json.company }}",
                          "lastName": "={{ $json.lastName }}",
                          "firstName": "={{ $json.firstName }}",
                          "operation": "create",
                          "additionalFields": {
                            "rating": "={{ $json.isHighValue ? 'Hot' : 'Warm' }}",
                            "industry": "={{ $json.companyProfile.industry }}",
                            "leadSource": "Website Signup",
                            "leadStatus": "New",
                            "description": "={{ 'Lead Score: ' + $json.leadScore + ', Company Size: ' + $json.companyProfile.size + ', Tier: ' + $json.companyProfile.tier }}"
                          }
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "googleCalendar_1",
                        "name": "Schedule Demo Call",
                        "type": "n8n-nodes-base.googleCalendar",
                        "onError": "continueRegularOutput",
                        "position": [
                          2050,
                          200
                        ],
                        "parameters": {
                          "end": "={{ DateTime.now().plus({ days: 2, minutes: $json.personalizedContent.demoLength }).toISO() }}",
                          "start": "={{ DateTime.now().plus({ days: 2 }).toISO() }}",
                          "options": {
                            "sendNotifications": true
                          },
                          "summary": "={{ 'Demo Call - ' + $json.company + ' (' + $json.companyProfile.size + ' ' + $json.companyProfile.industry + ')' }}",
                          "attendees": "={{ $json.email }}",
                          "operation": "create",
                          "calendarId": "primary",
                          "description": "={{ 'Demo call with ' + $json.firstName + ' ' + $json.lastName + ' from ' + $json.company + '.\\n\\nCompany Profile:\\n- Size: ' + $json.companyProfile.size + '\\n- Industry: ' + $json.companyProfile.industry + '\\n- Lead Score: ' + $json.leadScore + '\\n- Demo Type: ' + $json.companyProfile.demoType + '\\n\\nContact: ' + $json.email }}"
                        },
                        "typeVersion": 1.3
                      },
                      {
                        "id": "slack_1",
                        "name": "Notify Sales Team",
                        "type": "n8n-nodes-base.slack",
                        "onError": "continueRegularOutput",
                        "maxTries": 2,
                        "position": [
                          2050,
                          400
                        ],
                        "parameters": {
                          "text": "{{ `🚨 High-Value Prospect Alert!\n\n*${$json.company}* just signed up!\n\n👤 Contact: ${$json.firstName} ${$json.lastName} (${$json.email})\n🏢 Company: ${$json.companyProfile.size} ${$json.companyProfile.industry} company\n📊 Lead Score: ${$json.leadScore}/100\n🎯 Tier: ${$json.companyProfile.tier}\n📅 Demo scheduled for ${DateTime.fromISO($('Schedule Demo Call').first().json.start).toFormat('MMM dd, yyyy at h:mm a')}\n\n*Action Required:* Review lead in CRM and prepare for demo call.` }}",
                          "channel": "#sales-alerts",
                          "otherOptions": {
                            "includeLinkToWorkflow": true
                          }
                        },
                        "executeOnce": true,
                        "typeVersion": 2.3
                      },
                      {
                        "id": "sticky_triggers_1754943869352",
                        "name": "Triggers Notes",
                        "type": "n8n-nodes-base.stickyNote",
                        "position": [
                          480,
                          -130
                        ],
                        "parameters": {
                          "color": 6,
                          "width": 310,
                          "height": 710,
                          "content": "## 📥 Triggers\nWebhook receives customer signup data and initiates the intelligent onboarding workflow. This serves as the entry point for new customer registrations."
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "sticky_transforms_1754943869352",
                        "name": "Transform Notes",
                        "type": "n8n-nodes-base.stickyNote",
                        "position": [
                          890,
                          -130
                        ],
                        "parameters": {
                          "color": 4,
                          "width": 910,
                          "height": 710,
                          "content": "## ⚙️ Transform\nProcesses and validates incoming signup data, extracting key customer information and preparing it for company enrichment. Structures data for downstream analysis.\n\nAnalyzes company data to determine business profile, industry classification, lead scoring, and personalization parameters. Identifies high-value prospects for escalation."
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "sticky_inputs_1754943869352",
                        "name": "Inputs Notes",
                        "type": "n8n-nodes-base.stickyNote",
                        "position": [
                          1900,
                          -130
                        ],
                        "parameters": {
                          "color": 5,
                          "width": 310,
                          "height": 710,
                          "content": "## 📊 Inputs\nFetches comprehensive company data from external APIs to enrich customer profiles with industry, size, and other business attributes for personalization."
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "sticky_outputs_1754943869352",
                        "name": "Outputs Notes",
                        "type": "n8n-nodes-base.stickyNote",
                        "position": [
                          2310,
                          -130
                        ],
                        "parameters": {
                          "color": 7,
                          "width": 310,
                          "height": 710,
                          "content": "## 🚀 Outputs\nSends personalized welcome emails and tracks customer engagement events across multiple channels. Provides immediate value and begins relationship building."
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "sticky_storage_1754943869352",
                        "name": "Storage Notes",
                        "type": "n8n-nodes-base.stickyNote",
                        "position": [
                          2720,
                          -130
                        ],
                        "parameters": {
                          "color": 8,
                          "width": 310,
                          "height": 710,
                          "content": "## 💾 Storage\nCreates comprehensive lead records in CRM system with complete customer context, company analysis, and lead scoring for sales team follow-up."
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "sticky_integration_1754943869352",
                        "name": "Integration Notes",
                        "type": "n8n-nodes-base.stickyNote",
                        "position": [
                          3130,
                          -130
                        ],
                        "parameters": {
                          "color": 6,
                          "width": 310,
                          "height": 710,
                          "content": "## 🔗 Integration\nSchedules appropriate demo calls based on customer profile and sends targeted notifications to sales team for high-value prospects requiring immediate attention."
                        },
                        "typeVersion": 1
                      },
                      {
                        "id": "sticky_promo_1754943869352",
                        "name": "Ghost Team Promo",
                        "type": "n8n-nodes-base.stickyNote",
                        "position": [
                          100,
                          -130
                        ],
                        "parameters": {
                          "color": 4,
                          "width": 280,
                          "height": 710,
                          "content": "## 🚀 Grow your AI business\n\nNeed help in implementing this workflow for your business? Join the Ghost Team community.\n\nThis workflow is made with 💚 by Ghost Team."
                        },
                        "typeVersion": 1
                      }
                    ],
                    "valid": true,
                    "settings": {
                      "executionOrder": "v1",
                      "saveManualExecutions": true,
                      "saveDataErrorExecution": "all",
                      "saveDataSuccessExecution": "all"
                    },
                    "connections": {
                      "Create CRM Lead": {
                        "main": [
                          [
                            {
                              "node": "Schedule Demo Call",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Notify Sales Team",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Fetch Company Data": {
                        "main": [
                          [
                            {
                              "node": "Analyze Company Profile",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Process Signup Data": {
                        "main": [
                          [
                            {
                              "node": "Fetch Company Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Analyze Company Profile": {
                        "main": [
                          [
                            {
                              "node": "Send Personalized Welcome Email",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Track Signup Event",
                              "type": "main",
                              "index": 0
                            },
                            {
                              "node": "Create CRM Lead",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      },
                      "Customer Signup Webhook": {
                        "main": [
                          [
                            {
                              "node": "Process Signup Data",
                              "type": "main",
                              "index": 0
                            }
                          ]
                        ]
                      }
                    }
                  },
                  "timestamp": "2025-08-11T20:24:29.607Z"
                },
                {
                  "type": "completePhase",
                  "phase": "documentation",
                  "timestamp": "2025-08-11T20:24:29.607Z"
                }
              ],
              "pendingClarifications": [],
              "clarificationHistory": []
            }
          }
        },
        "removed": [],
        "unchanged": [
          "sessionId",
          "createdAt"
        ]
      }
    }
  },
  "summary": {
    "totalNodes": 16,
    "totalConnections": 5,
    "validationAttempts": 3,
    "errorsFixed": 2,
    "stickyNotesAdded": 7,
    "performanceScore": 20,
    "qualityScore": 95,
    "completenessScore": 100
  },
  "optimizationSuggestions": [
    "Consider optimizing discovery phase (took 25623ms)",
    "Consider optimizing configuration phase (took 42989ms)",
    "Consider optimizing building phase (took 56112ms)",
    "Consider optimizing validation phase (took 35309ms)",
    "High validation attempts detected. Consider improving initial node configuration."
  ],
  "errorPatterns": [
    {
      "pattern": "ValidationError",
      "frequency": 2,
      "suggestedFix": "Review node configuration requirements and ensure all required fields are set"
    }
  ]
}